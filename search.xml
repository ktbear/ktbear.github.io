<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>520福利</title>
    <url>/movie/19/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><!-- build time:Sat May 22 2021 19:59:12 GMT+0800 (GMT+08:00) --><html><head></head><body><img class="st" src="https://i.loli.net/2020/08/05/RLO8WhztyrlZdBJ.jpg"><a id="more"></a> 520即将到来，在这里给大家推荐几款值得看电影，不约会的朋友们可以在家看看，绝对不迷路，祝你们度过一个愉快的520😂<ol><li><p>疯狂的麦克斯4：狂暴之路</p><p><img src="https://i.loli.net/2020/05/19/bDV8vLnAfjWRZi9.png" alt="QQ图片20200519105841sss.png"></p></li></ol><p>这款电影满满的科技感，场面十分爆棚。</p><ol start="2"><li><p>南山的部长们</p><p><img src="https://i.loli.net/2020/05/19/GY4ALEgHjSavxrB.png" alt="QQ图片20200519110007sssaa.png"></p></li></ol><p>这部电影主要将的是韩国中央情报部部长们的政治阴谋，你静静的看就会觉得很有意思😋</p><ol start="3"><li><p>巴霍巴利王：开端</p><p><img src="https://i.loli.net/2020/05/19/SnMldkctZAOTr27.png" alt="QQ图片20200519110630.png"></p></li></ol><p>印度神作，场面也是十分撼动，据说为了拍这部电影都动员了印度全人民，这部电影还有第二部，两部都不错的。</p><p>暂时只推荐这三部吧，最后再送给大家一个看电影的福利网站：<a href="http://www.mp4ju.com/" target="_blank" rel="noopener">http://www.mp4ju.com/</a></p><!-- rebuild by neat --></body></html>]]></content>
      <categories>
        <category>资源</category>
      </categories>
      <tags>
        <tag>电影</tag>
      </tags>
  </entry>
  <entry>
    <title>APlayer音乐插件</title>
    <url>/Details/12/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><!-- build time:Sat May 22 2021 19:59:12 GMT+0800 (GMT+08:00) --><html><head></head><body><img class="st" src="https://i.loli.net/2020/04/25/yRjL7mZUGAhdE9K.png"><a id="more"></a><h3 id="1-APlayer"><a href="#1-APlayer" class="headerlink" title="1. APlayer"></a>1. APlayer</h3><p>APlayer是大佬们开发出来的一款HTML5漂亮的音乐插件，<a href="https://github.com/MoePlayer/APlayer" target="_blank" rel="noopener">GitHub下载地址</a>。</p><h3 id="2-使用"><a href="#2-使用" class="headerlink" title="2. 使用"></a>2. 使用</h3><p>下载好插件放到自己的工程，</p><ul><li>在需要加入的html页面导入插件css、js</li></ul><figure class="highlight html"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag"><<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"APlayer.min.css"</span>></span></span><br><span class="line"><span class="tag"><<span class="name">script</span> <span class="attr">src</span>=<span class="string">"APlayer.min.js"</span>></span><span class="tag"></<span class="name">script</span>></span></span><br></pre></td></tr></tbody></table></figure><ul><li>在需要放置插件的位置处的html元素赋予id属性，比如</li></ul><figure class="highlight html"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag"><<span class="name">div</span> <span class="attr">id</span>=<span class="string">"aplayer"</span>></span><span class="tag"></<span class="name">div</span>></span></span><br></pre></td></tr></tbody></table></figure><ul><li>在body后加入以下</li></ul><figure class="highlight html"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag"><<span class="name">script</span>></span></span><br><span class="line"><span class="actionscript"><span class="keyword">const</span> ap = <span class="keyword">new</span> APlayer({</span></span><br><span class="line"><span class="javascript">    container: <span class="built_in">document</span>.getElementById(<span class="string">'aplayer'</span>),</span></span><br><span class="line">    audio: [{</span><br><span class="line"><span class="actionscript">        name: <span class="string">'name1'</span>,</span></span><br><span class="line"><span class="actionscript">        artist: <span class="string">'artist1'</span>,</span></span><br><span class="line"><span class="actionscript">        url: <span class="string">'url1.mp3'</span>,</span></span><br><span class="line"><span class="actionscript">        cover: <span class="string">'cover1.jpg'</span></span></span><br><span class="line">    },</span><br><span class="line">     {</span><br><span class="line"><span class="actionscript">        name: <span class="string">'name2'</span>,</span></span><br><span class="line"><span class="actionscript">        artist: <span class="string">'artist2'</span>,</span></span><br><span class="line"><span class="actionscript">        url: <span class="string">'url2.mp3'</span>,</span></span><br><span class="line"><span class="actionscript">        cover: <span class="string">'cover2.jpg'</span></span></span><br><span class="line">    }</span><br><span class="line">           ]</span><br><span class="line">});</span><br><span class="line"><span class="tag"></<span class="name">script</span>></span></span><br></pre></td></tr></tbody></table></figure><p>或者自定义js然后引入即可</p><ul><li>name: 歌曲名</li><li>artist: 歌曲作者</li><li>cover: 歌曲图片</li><li>url: 音乐地址</li></ul><p>这里我介绍个好用的音乐外链获取网站:<a href="http://music.xf1433.com/" target="_blank" rel="noopener">http://music.xf1433.com/</a></p><h3 id="3-可选参数"><a href="#3-可选参数" class="headerlink" title="3. 可选参数"></a>3. 可选参数</h3><style>table th:nth-of-type(1){width:70px}</style><table><thead><tr><th>名称</th><th>默认值</th><th>描述</th></tr></thead><tbody><tr><td>mini</td><td>false</td><td>开启迷你模式</td></tr><tr><td>fixed</td><td>false</td><td>开启吸底模式</td></tr><tr><td>autoplay</td><td>false</td><td>音频自动播放</td></tr><tr><td>theme</td><td>‘#b7daff’</td><td>主题色</td></tr><tr><td>loop</td><td>‘all’</td><td>音频循环播放, 可选值: ‘all’, ‘one’, ‘none’</td></tr><tr><td>preload</td><td>‘auto’</td><td>预加载，可选值: ‘none’, ‘metadata’, ‘auto’</td></tr><tr><td>volume</td><td>0.7</td><td>默认音量，请注意播放器会记忆用户设置，用户手动设置音量后默认音量即失效</td></tr><tr><td>container</td><td>document.querySelector(‘.aplayer’)</td><td>播放器容器元素</td></tr></tbody></table><h3 id="4-API"><a href="#4-API" class="headerlink" title="4. API"></a>4. API</h3><ul><li><code>ap.play()</code>: 播放音频</li><li><code>ap.pause()</code>: 暂停音频</li><li><code>ap.audio.currentTime</code>: 返回音频当前播放时间</li><li><code>ap.audio.duration</code>: 返回音频总时间</li><li><code>ap.audio.paused</code>: 返回音频是否暂停</li></ul><p>这里列举的都是常用的，详细请到官网<a href="https://aplayer.js.org" target="_blank" rel="noopener">https://aplayer.js.org</a></p><p>完成以上工作你就可以看到界面中有音乐了，但是还有个问题出现了，就是不能刷新页面继续上次的记录播放，看到许多人说用frame标签和ajax、<a href="http://bsify.admui.com/jquery-pjax/" target="_blank" rel="noopener">pjax</a>:</p><ul><li><p>frame例子</p><figure class="highlight html"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag"><<span class="name">html</span>></span></span><br><span class="line"></span><br><span class="line"><span class="tag"><<span class="name">frameset</span> <span class="attr">cols</span>=<span class="string">"0%,100%"</span>></span></span><br><span class="line">  <span class="comment"><!--音乐插件另外放在music页面--></span></span><br><span class="line"><span class="tag"><<span class="name">frame</span> <span class="attr">src</span>=<span class="string">"music.html"</span>></span></span><br><span class="line"> <span class="comment"><!--首页页面--></span></span><br><span class="line"><span class="tag"><<span class="name">frame</span> <span class="attr">src</span>=<span class="string">"index.html"</span>></span></span><br><span class="line"></span><br><span class="line"><span class="tag"></<span class="name">frameset</span>></span></span><br><span class="line"></span><br><span class="line"><span class="tag"></<span class="name">html</span>></span></span><br></pre></td></tr></tbody></table></figure><p>缺点: 这样音乐可以连续播放，但没办法在index.html页面中控制音频播放</p></li><li><p>pjax (和ajax相似，相当于ajax的加强版)</p><p>首先下载<a href="https://github.com/defunkt/jquery-pjax" target="_blank" rel="noopener">jquery-pjax插件</a></p><p>引入jquery和jquery-pjax</p><figure class="highlight html"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag"><<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://cdn.bootcss.com/jquery/3.4.1/jquery.min.js"</span>></span><span class="tag"></<span class="name">script</span>></span></span><br><span class="line"><span class="tag"><<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://cdn.bootcss.com/jquery.pjax/2.0.1/jquery.pjax.min.js"</span>></span><span class="tag"></<span class="name">script</span>></span></span><br></pre></td></tr></tbody></table></figure><p>将要局部更新的内容用div包裹，指定属性id</p><figure class="highlight html"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag"><<span class="name">div</span> <span class="attr">id</span>=<span class="string">"container"</span>></span></span><br><span class="line">    <span class="comment"><!-- 要替换的内容 --></span>	</span><br><span class="line">  <span class="tag"></<span class="name">div</span>></span></span><br></pre></td></tr></tbody></table></figure><p>在body后定义js,下面将会使id为container下的所有a标签跳转，没有后台需添加fragment容器</p><figure class="highlight html"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag"><<span class="name">script</span>></span></span><br><span class="line"><span class="javascript">$(<span class="built_in">document</span>).pjax(<span class="string">'a[target!="_blank"]'</span>, <span class="string">'#container'</span>, {</span></span><br><span class="line"><span class="actionscript">    fragment: <span class="string">"#container"</span>,</span></span><br><span class="line">    timeout: 5000</span><br><span class="line">});</span><br><span class="line"><span class="tag"></<span class="name">script</span>></span></span><br></pre></td></tr></tbody></table></figure></li></ul><p>最后感谢各位大佬们的贡献！</p><!-- rebuild by neat --></body></html>]]></content>
      <categories>
        <category>插件</category>
      </categories>
      <tags>
        <tag>音乐</tag>
        <tag>pjax</tag>
      </tags>
  </entry>
  <entry>
    <title>GitHub高效查询开源项目</title>
    <url>/github/20/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><!-- build time:Sat May 22 2021 19:59:12 GMT+0800 (GMT+08:00) --><html><head></head><body><img class="st" src="https://i.loli.net/2020/04/28/PrhQIK3kY1JbzTa.png"><a id="more"></a><h5 id="如何在github上寻找最适合自己的项目呢？"><a href="#如何在github上寻找最适合自己的项目呢？" class="headerlink" title="如何在github上寻找最适合自己的项目呢？"></a>如何在github上寻找最适合自己的项目呢？</h5><ol><li><p>首先你可以根据名字搜索你想要的项目<br>in:name 项目名</p></li><li><p>当你用名字搜索出来时出现几万个项目，这时你不知道如何选择可以再限制星星数量来缩小范围<br>stars:>数量</p></li><li><p>此时出现的项目还是很多，并且右多种编程语言，这时你可以再次限制语言范围<br>language:语言</p></li><li><p>你需要找怎样的项目呢，此时可以根据项目描述搜索<br>in:description 描述</p></li><li><p>你又感觉有些项目太旧了，于是想找一份新的<br>pushed:>年份</p></li><li><p>还可以根据readme进行搜索<br>in:readme 描述</p></li><li><p>实例如下：<br>组合搜索<br><img src="https://i.loli.net/2020/04/28/f3joacR6hzYinFN.png" alt><br>搜索结果如下<br><img src="https://i.loli.net/2020/04/28/9qnw6h4QXTafIrV.png" alt><br>我们看出根据限制条件项目数量明显减少，这样一来可以减少我们浪费大量的时间去搜索一些无用而又不适合自己的项目�搜索一些无用而又不适合自己的项目</p></li></ol><!-- rebuild by neat --></body></html>]]></content>
      <categories>
        <category>github</category>
      </categories>
      <tags>
        <tag>github</tag>
      </tags>
  </entry>
  <entry>
    <title>Git命令速查表</title>
    <url>/git/21/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><!-- build time:Sat May 22 2021 19:59:12 GMT+0800 (GMT+08:00) --><html><head></head><body><p>平时常用Git命令大全……</p><a id="more"></a><p><img src="https://i.loli.net/2020/05/21/3wVeNk4a16tbmdi.png" alt="Git常用命令.png"></p><!-- rebuild by neat --></body></html>]]></content>
      <categories>
        <category>Git</category>
      </categories>
      <tags>
        <tag>Git</tag>
      </tags>
  </entry>
  <entry>
    <title>Hexo快速搭建个人博客</title>
    <url>/Details/03/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><!-- build time:Sat May 22 2021 19:59:12 GMT+0800 (GMT+08:00) --><html><head></head><body><p>Hexo<a href="https://hexo.io/zh-cn/" target="_blank" rel="noopener">中文官方网站</a>是一个快速, 简洁且高效的博客框架. 让上百个页面在几秒内瞬间完成渲染. Hexo支持Github Flavored Markdown的所有功能, 甚至可以整合Octopress的大多数插件. 并自己也拥有强大的插件系统.</p><a id="more"></a><h2 id="快速入门"><a href="#快速入门" class="headerlink" title="快速入门"></a>快速入门</h2><p>利用Hexo框架diy你的博客，下面我们快速开始吧！</p><h6 id="bulb-安装Hexo"><a href="#bulb-安装Hexo" class="headerlink" title=":bulb:安装Hexo"></a>:bulb:安装Hexo</h6><ol><li><p>首先需要安装<a href="https://nodejs.org/zh-cn/" target="_blank" rel="noopener">node.js</a>环境,接下来在磁盘任意位置新建博客系统项目文件</p></li><li><p>可下载淘宝镜像【cnpm】提升下载速度（可选），没有则可以将下面的cnpm替换成npm安装</p></li><li><p>cnpm install -g hexo-cli （安装Hexo）</p></li><li><p>hexo -v（查看hexo版本）</p></li><li><p>在任意盘符自己创建一个工程文件用于稍后构建工程用</p></li><li><p>命令进入刚建立的工程文件输入 hexo init(初始化工程)</p></li><li><p>hexo n “我的第一篇博客文章”（添加文章）</p></li><li><p>可以进入工程目录下的source/_posts/xxx.md进行编辑文章</p></li><li><p>hexo clean (清除缓存)</p></li><li><p>hexo g(重新生成)</p></li><li><p>启动博客 hexo s</p></li></ol><ul><li>以下是部署到github pages（可选）</li></ul><ol><li><p>cnpm install –save hexo-deployer-git (安装插件)</p></li><li><p>设置_config.yml，将deployment中type的值改为git，仓库repo的值改为github上的地址，添加brach: master</p></li><li><p>hexo d(自动部署)，后面输入github密码</p></li></ol><h5 id="bulb-更换主题"><a href="#bulb-更换主题" class="headerlink" title=":bulb:更换主题"></a>:bulb:更换主题</h5><ol><li><p><a href="https://hexo.io/themes/" target="_blank" rel="noopener">下载主题</a>，下载后放入themes文件下</p></li><li><p>将主题加载进工程，修改_config.yml,将theme的值设置成下载后的主题文件夹名</p></li><li><p>hexo clean</p></li><li><p>hexo g(重新生成)</p></li><li><p>hexo s</p></li><li><p>退出，推到远程github仓库,后面可以通过免费域名访问了,输入登录用户名.github.io即可访问</p></li></ol><!-- rebuild by neat --></body></html>]]></content>
      <categories>
        <category>前端</category>
      </categories>
      <tags>
        <tag>博客</tag>
        <tag>node</tag>
      </tags>
  </entry>
  <entry>
    <title>java基础</title>
    <url>/java/03/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><!-- build time:Sat May 22 2021 19:59:12 GMT+0800 (GMT+08:00) --><html><head></head><body><img class="st" src="https://i.loli.net/2020/08/05/iH3BMz4KA6jLrPs.jpg"><a id="more"></a><h4 id="一、数据类型"><a href="#一、数据类型" class="headerlink" title="一、数据类型"></a>一、数据类型</h4><h6 id="基本类型"><a href="#基本类型" class="headerlink" title="基本类型"></a>基本类型</h6><p>byte/8<br>char/16<br>short/16<br>int/32<br>float/32<br>long/64<br>double/64<br>boolean/~<br>boolean 只有两个值：true、false，可以使用 1 bit 来存储，但是具体大小没有明确规定。JVM 会在编译时期将 boolean 类型的数据转换为 int，使用 1 来表示 true，0 表示 false。JVM 支持 boolean 数组，但是是通过读写 byte 数组来实现的</p><p>Primitive Data Types<br>The Java® Virtual Machine Specification</p><h6 id="包装类型"><a href="#包装类型" class="headerlink" title="包装类型"></a>包装类型</h6><p>基本类型都有对应的包装类型，基本类型与其对应的包装类型之间的赋值使用自动装箱与拆箱完成。</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line">Integer x = <span class="number">2</span>;     <span class="comment">// 装箱 调用了 Integer.valueOf(2)</span></span><br><span class="line"><span class="keyword">int</span> y = x;         <span class="comment">// 拆箱 调用了 X.intValue()</span></span><br><span class="line">Autoboxing and Unboxing</span><br></pre></td></tr></tbody></table></figure><h6 id="缓存池"><a href="#缓存池" class="headerlink" title="缓存池"></a>缓存池</h6><p>new Integer(123) 与 Integer.valueOf(123) 的区别在于：</p><p>new Integer(123) 每次都会新建一个对象；<br>Integer.valueOf(123) 会使用缓存池中的对象，多次调用会取得同一个对象的引用。</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line">Integer x = <span class="keyword">new</span> Integer(<span class="number">123</span>);</span><br><span class="line">Integer y = <span class="keyword">new</span> Integer(<span class="number">123</span>);</span><br><span class="line">System.out.println(x == y);    <span class="comment">// false</span></span><br><span class="line">Integer z = Integer.valueOf(<span class="number">123</span>);</span><br><span class="line">Integer k = Integer.valueOf(<span class="number">123</span>);</span><br><span class="line">System.out.println(z == k);   <span class="comment">// truevalueOf() 方法的实现比较简单，就是先判断值是否在缓存池中，如果在的话就直接返回缓存池的内容。</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Integer <span class="title">valueOf</span><span class="params">(<span class="keyword">int</span> i)</span> </span>{</span><br><span class="line">    <span class="keyword">if</span> (i >= IntegerCache.low && i <= IntegerCache.high)</span><br><span class="line">        <span class="keyword">return</span> IntegerCache.cache[i + (-IntegerCache.low)];</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Integer(i);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>在 Java 8 中，Integer 缓存池的大小默认为 -128~127。</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> low = -<span class="number">128</span>;</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> high;</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> Integer cache[];</span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> {</span><br><span class="line">    <span class="comment">// high value may be configured by property</span></span><br><span class="line">    <span class="keyword">int</span> h = <span class="number">127</span>;</span><br><span class="line">    String integerCacheHighPropValue =</span><br><span class="line">        sun.misc.VM.getSavedProperty(<span class="string">"java.lang.Integer.IntegerCache.high"</span>);</span><br><span class="line">    <span class="keyword">if</span> (integerCacheHighPropValue != <span class="keyword">null</span>) {</span><br><span class="line">        <span class="keyword">try</span> {</span><br><span class="line">            <span class="keyword">int</span> i = parseInt(integerCacheHighPropValue);</span><br><span class="line">            i = Math.max(i, <span class="number">127</span>);</span><br><span class="line">            <span class="comment">// Maximum array size is Integer.MAX_VALUE</span></span><br><span class="line">            h = Math.min(i, Integer.MAX_VALUE - (-low) -<span class="number">1</span>);</span><br><span class="line">        } <span class="keyword">catch</span>( NumberFormatException nfe) {</span><br><span class="line">            <span class="comment">// If the property cannot be parsed into an int, ignore it.</span></span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">    high = h;</span><br><span class="line">    cache = <span class="keyword">new</span> Integer[(high - low) + <span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> j = low;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">0</span>; k < cache.length; k++)</span><br><span class="line">    cache[k] = <span class="keyword">new</span> Integer(j++);</span><br><span class="line"></span><br><span class="line"><span class="comment">// range [-128, 127] must be interned (JLS7 5.1.7)</span></span><br><span class="line"><span class="keyword">assert</span> IntegerCache.high >= <span class="number">127</span>;</span><br><span class="line">    }</span><br></pre></td></tr></tbody></table></figure><p>编译器会在自动装箱过程调用 valueOf() 方法，因此多个值相同且值在缓存池范围内的 Integer 实例使用自动装箱来创建，那么就会引用相同的对象。</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line">Integer m = <span class="number">123</span>;</span><br><span class="line">Integer n = <span class="number">123</span>;</span><br><span class="line">System.out.println(m == n); <span class="comment">// true基本类型对应的缓冲池如下：boolean values true and false</span></span><br><span class="line">all <span class="keyword">byte</span> values</span><br><span class="line"><span class="keyword">short</span> values between -<span class="number">128</span> and <span class="number">127</span></span><br><span class="line"><span class="keyword">int</span> values between -<span class="number">128</span> and <span class="number">127</span></span><br><span class="line"><span class="keyword">char</span> in the range \u0000 to \u007F</span><br></pre></td></tr></tbody></table></figure><p>在使用这些基本类型对应的包装类型时，如果该数值范围在缓冲池范围内，就可以直接使用缓冲池中的对象。</p><p>在 jdk 1.8 所有的数值类缓冲池中，Integer 的缓冲池 IntegerCache 很特殊，这个缓冲池的下界是 - 128，上界默认是 127，但是这个上界是可调的，在启动 jvm 的时候，通过 -XX:AutoBoxCacheMax=<size>来指定这个缓冲池的大小，该选项在 JVM 初始化的时候会设定一个名为 java.lang.IntegerCache.high 系统属性，然后 IntegerCache 初始化的时候就会读取该系统属性来决定上界。</size></p><p>StackOverflow : Differences between new Integer(123), Integer.valueOf(123) and just 123</p><h4 id="二、String"><a href="#二、String" class="headerlink" title="二、String"></a>二、String</h4><h6 id="概览"><a href="#概览" class="headerlink" title="概览"></a>概览</h6><p>String 被声明为 final，因此它不可被继承。(Integer 等包装类也不能被继承）</p><p>在 Java 8 中，String 内部使用 char 数组存储数据。</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">String</span></span></span><br><span class="line"><span class="class">    <span class="keyword">implements</span> <span class="title">java</span>.<span class="title">io</span>.<span class="title">Serializable</span>, <span class="title">Comparable</span><<span class="title">String</span>>, <span class="title">CharSequence</span> </span>{</span><br><span class="line">    <span class="comment">/** The value is used for character storage. */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">char</span> value[];</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>在 Java 9 之后，String 类的实现改用 byte 数组存储字符串，同时使用 coder 来标识使用了哪种编码。</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">String</span></span></span><br><span class="line"><span class="class">    <span class="keyword">implements</span> <span class="title">java</span>.<span class="title">io</span>.<span class="title">Serializable</span>, <span class="title">Comparable</span><<span class="title">String</span>>, <span class="title">CharSequence</span> </span>{</span><br><span class="line">    <span class="comment">/** The value is used for character storage. */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">byte</span>[] value;</span><br><span class="line">    <span class="comment">/** The identifier of the encoding used to encode the bytes in {<span class="doctag">@code</span> value}. */</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">byte</span> coder;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>value 数组被声明为 final，这意味着 value 数组初始化之后就不能再引用其它数组。并且 String 内部没有改变 value 数组的方法，因此可以保证 String 不可变。</p><h6 id="不可变的好处"><a href="#不可变的好处" class="headerlink" title="不可变的好处"></a>不可变的好处</h6><ol><li>可以缓存 hash 值</li></ol><p>因为 String 的 hash 值经常被使用，例如 String 用做 HashMap 的 key。不可变的特性可以使得 hash 值也不可变，因此只需要进行一次计算。</p><ol start="2"><li>String Pool 的需要</li></ol><p>如果一个 String 对象已经被创建过了，那么就会从 String Pool 中取得引用。只有 String 是不可变的，才可能使用 String Pool。</p><img src="https://camo.githubusercontent.com/152a310f7698bb23ae201081c5c497b5c1d396d9/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f696d6167652d32303139313231303030343133323839342e706e67" data-canonical-src="https://cs-notes-1256109796.cos.ap-guangzhou.myqcloud.com/image-20191210004132894.png" style="max-width:100%"><ol start="3"><li>安全性</li></ol><p>String 经常作为参数，String 不可变性可以保证参数不可变。例如在作为网络连接参数的情况下如果 String 是可变的，那么在网络连接过程中，String 被改变，改变 String 的那一方以为现在连接的是其它主机，而实际情况却不一定是。</p><ol start="4"><li>线程安全</li></ol><p>String 不可变性天生具备线程安全，可以在多个线程中安全地使用。</p><p>Program Creek : Why String is immutable in Java?</p><h6 id="String-StringBuffer-and-StringBuilder"><a href="#String-StringBuffer-and-StringBuilder" class="headerlink" title="String, StringBuffer and StringBuilder"></a>String, StringBuffer and StringBuilder</h6><ol><li>可变性</li></ol><p>String 不可变<br>StringBuffer 和 StringBuilder 可变</p><ol start="2"><li>线程安全</li></ol><p>String 不可变，因此是线程安全的<br>StringBuilder 不是线程安全的<br>StringBuffer 是线程安全的，内部使用 synchronized 进行同步<br>StackOverflow : String, StringBuffer, and StringBuilder</p><h6 id="String-Pool"><a href="#String-Pool" class="headerlink" title="String Pool"></a>String Pool</h6><p>字符串常量池（String Pool）保存着所有字符串字面量（literal strings），这些字面量在编译时期就确定。不仅如此，还可以使用 String 的 intern() 方法在运行过程将字符串添加到 String Pool 中。</p><p>当一个字符串调用 intern() 方法时，如果 String Pool 中已经存在一个字符串和该字符串值相等（使用 equals() 方法进行确定），那么就会返回 String Pool 中字符串的引用；否则，就会在 String Pool 中添加一个新的字符串，并返回这个新字符串的引用。</p><p>下面示例中，s1 和 s2 采用 new String() 的方式新建了两个不同字符串，而 s3 和 s4 是通过 s1.intern() 方法取得同一个字符串引用。intern() 首先把 s1 引用的字符串放到 String Pool 中，然后返回这个字符串引用。因此 s3 和 s4 引用的是同一个字符串。</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line">String s1 = <span class="keyword">new</span> String(<span class="string">"aaa"</span>);</span><br><span class="line">String s2 = <span class="keyword">new</span> String(<span class="string">"aaa"</span>);</span><br><span class="line">System.out.println(s1 == s2);           <span class="comment">// false</span></span><br><span class="line">String s3 = s1.intern();</span><br><span class="line">String s4 = s1.intern();</span><br><span class="line">System.out.println(s3 == s4);           <span class="comment">// true</span></span><br></pre></td></tr></tbody></table></figure><p>如果是采用 “bbb” 这种字面量的形式创建字符串，会自动地将字符串放入 String Pool 中。</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line">String s5 = <span class="string">"bbb"</span>;</span><br><span class="line">String s6 = <span class="string">"bbb"</span>;</span><br><span class="line">System.out.println(s5 == s6);  <span class="comment">// true</span></span><br></pre></td></tr></tbody></table></figure><p>在 Java 7 之前，String Pool 被放在运行时常量池中，它属于永久代。而在 Java 7，String Pool 被移到堆中。这是因为永久代的空间有限，在大量使用字符串的场景下会导致 OutOfMemoryError 错误。</p><p>StackOverflow : What is String interning?<br>深入解析 String#intern</p><h6 id="new-String-“abc”"><a href="#new-String-“abc”" class="headerlink" title="new String(“abc”)"></a>new String(“abc”)</h6><p>使用这种方式一共会创建两个字符串对象（前提是 String Pool 中还没有 “abc” 字符串对象）。</p><p>“abc” 属于字符串字面量，因此编译时期会在 String Pool 中创建一个字符串对象，指向这个 “abc” 字符串字面量；<br>而使用 new 的方式会在堆中创建一个字符串对象。<br>创建一个测试类，其 main 方法中使用这种方式来创建字符串对象。</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">NewStringTest</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>{</span><br><span class="line">        String s = <span class="keyword">new</span> String(<span class="string">"abc"</span>);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>使用 javap -verbose 进行反编译，得到以下内容：</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">// ...</span></span><br><span class="line">Constant pool:</span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line">   #2 = Class              #18            // java/lang/String</span><br><span class="line">   #3 = String             #19            // abc</span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line">  #18 = Utf8               java/lang/String</span><br><span class="line">  #19 = Utf8               abc</span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(java.lang.String[])</span></span>;</span><br><span class="line">    descriptor: ([Ljava/lang/String;)V</span><br><span class="line">    flags: ACC_PUBLIC, ACC_STATIC</span><br><span class="line">    Code:</span><br><span class="line">      stack=<span class="number">3</span>, locals=<span class="number">2</span>, args_size=<span class="number">1</span></span><br><span class="line">         0: new           #2                  // class java/lang/String</span><br><span class="line">         <span class="number">3</span>: dup</span><br><span class="line">         4: ldc           #3                  // String abc</span><br><span class="line">         6: invokespecial #4                  // Method java/lang/String."<init>":(Ljava/lang/String;)V</span><br><span class="line">         <span class="number">9</span>: astore_1</span><br><span class="line"><span class="comment">// ...</span></span><br></pre></td></tr></tbody></table></figure><p>在 Constant Pool 中，#19 存储这字符串字面量 “abc”，#3 是 String Pool 的字符串对象，它指向 #19 这个字符串字面量。在 main 方法中，0: 行使用 new #2 在堆中创建一个字符串对象，并且使用 ldc #3 将 String Pool 中的字符串对象作为 String 构造函数的参数。</p><p>以下是 String 构造函数的源码，可以看到，在将一个字符串对象作为另一个字符串对象的构造函数参数时，并不会完全复制 value 数组内容，而是都会指向同一个 value 数组。</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">String</span><span class="params">(String original)</span> </span>{</span><br><span class="line">    <span class="keyword">this</span>.value = original.value;</span><br><span class="line">    <span class="keyword">this</span>.hash = original.hash;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><h4 id="三、运算"><a href="#三、运算" class="headerlink" title="三、运算"></a>三、运算</h4><h6 id="参数传递"><a href="#参数传递" class="headerlink" title="参数传递"></a>参数传递</h6><p>Java 的参数是以值传递的形式传入方法中，而不是引用传递。</p><p>以下代码中 Dog dog 的 dog 是一个指针，存储的是对象的地址。在将一个参数传入一个方法时，本质上是将对象的地址以值的方式传递到形参中。</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Dog</span> </span>{</span><br><span class="line">    String name;</span><br><span class="line"></span><br><span class="line">Dog(String name) {</span><br><span class="line">    <span class="keyword">this</span>.name = name;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function">String <span class="title">getName</span><span class="params">()</span> </span>{</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.name;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>{</span><br><span class="line">    <span class="keyword">this</span>.name = name;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function">String <span class="title">getObjectAddress</span><span class="params">()</span> </span>{</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">super</span>.toString();</span><br><span class="line">}</span><br><span class="line">    }</span><br></pre></td></tr></tbody></table></figure><p>在方法中改变对象的字段值会改变原对象该字段值，因为引用的是同一个对象。</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PassByValueExample</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>{</span><br><span class="line">        Dog dog = <span class="keyword">new</span> Dog(<span class="string">"A"</span>);</span><br><span class="line">        func(dog);</span><br><span class="line">        System.out.println(dog.getName());          <span class="comment">// B</span></span><br><span class="line">    }</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">func</span><span class="params">(Dog dog)</span> </span>{</span><br><span class="line">    dog.setName(<span class="string">"B"</span>);</span><br><span class="line">}</span><br><span class="line">    }</span><br></pre></td></tr></tbody></table></figure><p>但是在方法中将指针引用了其它对象，那么此时方法里和方法外的两个指针指向了不同的对象，在一个指针改变其所指向对象的内容对另一个指针所指向的对象没有影响。</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PassByValueExample</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>{</span><br><span class="line">        Dog dog = <span class="keyword">new</span> Dog(<span class="string">"A"</span>);</span><br><span class="line">        System.out.println(dog.getObjectAddress()); <span class="comment">// Dog@4554617c</span></span><br><span class="line">        func(dog);</span><br><span class="line">        System.out.println(dog.getObjectAddress()); <span class="comment">// Dog@4554617c</span></span><br><span class="line">        System.out.println(dog.getName());          <span class="comment">// A</span></span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">  <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">func</span><span class="params">(Dog dog)</span> </span>{</span><br><span class="line">    System.out.println(dog.getObjectAddress()); <span class="comment">// Dog@4554617c</span></span><br><span class="line">    dog = <span class="keyword">new</span> Dog(<span class="string">"B"</span>);</span><br><span class="line">    System.out.println(dog.getObjectAddress()); <span class="comment">// Dog@74a14482</span></span><br><span class="line">    System.out.println(dog.getName());          <span class="comment">// B</span></span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>StackOverflow: Is Java “pass-by-reference” or “pass-by-value”?</p><h6 id="float-与-double"><a href="#float-与-double" class="headerlink" title="float 与 double"></a>float 与 double</h6><p>Java 不能隐式执行向下转型，因为这会使得精度降低。</p><p>1.1 字面量属于 double 类型，不能直接将 1.1 直接赋值给 float 变量，因为这是向下转型。</p><p>// float f = 1.1;<br>1.1f 字面量才是 float 类型。</p><p>float f = 1.1f;</p><h6 id="隐式类型转换"><a href="#隐式类型转换" class="headerlink" title="隐式类型转换"></a>隐式类型转换</h6><p>因为字面量 1 是 int 类型，它比 short 类型精度要高，因此不能隐式地将 int 类型向下转型为 short 类型。</p><p>short s1 = 1;<br>// s1 = s1 + 1;<br>但是使用 += 或者 ++ 运算符会执行隐式类型转换。</p><p>s1 += 1;<br>s1++;<br>上面的语句相当于将 s1 + 1 的计算结果进行了向下转型：</p><p>s1 = (short) (s1 + 1);<br>StackOverflow : Why don’t Java’s +=, -=, *=, /= compound assignment operators require casting?</p><h6 id="switch"><a href="#switch" class="headerlink" title="switch"></a>switch</h6><p>从 Java 7 开始，可以在 switch 条件判断语句中使用 String 对象。</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line">String s = <span class="string">"a"</span>;</span><br><span class="line"><span class="keyword">switch</span> (s) {</span><br><span class="line">    <span class="keyword">case</span> <span class="string">"a"</span>:</span><br><span class="line">        System.out.println(<span class="string">"aaa"</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">"b"</span>:</span><br><span class="line">        System.out.println(<span class="string">"bbb"</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>switch 不支持 long，是因为 switch 的设计初衷是对那些只有少数几个值的类型进行等值判断，如果值过于复杂，那么还是用 if 比较合适。</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">// long x = 111;</span></span><br><span class="line"><span class="comment">// switch (x) { // Incompatible types. Found: 'long', required: 'char, byte, short, int, Character, Byte, Short, Integer, String, or an enum'</span></span><br><span class="line"><span class="comment">//     case 111:</span></span><br><span class="line"><span class="comment">//         System.out.println(111);</span></span><br><span class="line"><span class="comment">//         break;</span></span><br><span class="line"><span class="comment">//     case 222:</span></span><br><span class="line"><span class="comment">//         System.out.println(222);</span></span><br><span class="line"><span class="comment">//         break;</span></span><br><span class="line"><span class="comment">// }</span></span><br></pre></td></tr></tbody></table></figure><p>StackOverflow : Why can’t your switch statement data type be long, Java?</p><h4 id="四、关键字"><a href="#四、关键字" class="headerlink" title="四、关键字"></a>四、关键字</h4><h6 id="final"><a href="#final" class="headerlink" title="final"></a>final</h6><ol><li>数据</li></ol><p>声明数据为常量，可以是编译时常量，也可以是在运行时被初始化后不能被改变的常量。</p><p>对于基本类型，final 使数值不变；<br>对于引用类型，final 使引用不变，也就不能引用其它对象，但是被引用的对象本身是可以修改的。</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">final</span> <span class="keyword">int</span> x = <span class="number">1</span>;</span><br><span class="line"><span class="comment">// x = 2;  // cannot assign value to final variable 'x'</span></span><br><span class="line"><span class="keyword">final</span> A y = <span class="keyword">new</span> A();</span><br><span class="line">y.a = <span class="number">1</span>;</span><br></pre></td></tr></tbody></table></figure><ol start="2"><li>方法</li></ol><p>声明方法不能被子类重写。</p><p>private 方法隐式地被指定为 final，如果在子类中定义的方法和基类中的一个 private 方法签名相同，此时子类的方法不是重写基类方法，而是在子类中定义了一个新的方法。</p><ol start="3"><li>类</li></ol><p>声明类不允许被继承。</p><h6 id="static"><a href="#static" class="headerlink" title="static"></a>static</h6><ol><li>静态变量</li></ol><p>静态变量：又称为类变量，也就是说这个变量属于类的，类所有的实例都共享静态变量，可以直接通过类名来访问它。静态变量在内存中只存在一份。<br>实例变量：每创建一个实例就会产生一个实例变量，它与该实例同生共死。</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">A</span> </span>{</span><br><span class="line">   <span class="keyword">private</span> <span class="keyword">int</span> x;         <span class="comment">// 实例变量</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> y;  <span class="comment">// 静态变量</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>{</span><br><span class="line">    <span class="comment">// int x = A.x;  // Non-static field 'x' cannot be referenced from a static context</span></span><br><span class="line">    A a = <span class="keyword">new</span> A();</span><br><span class="line">    <span class="keyword">int</span> x = a.x;</span><br><span class="line">    <span class="keyword">int</span> y = A.y;</span><br><span class="line">} </span><br><span class="line"> }</span><br></pre></td></tr></tbody></table></figure><ol start="2"><li>静态方法</li></ol><p>静态方法在类加载的时候就存在了，它不依赖于任何实例。所以静态方法必须有实现，也就是说它不能是抽象方法。</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">A</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">func1</span><span class="params">()</span></span>{</span><br><span class="line">    }</span><br><span class="line">    <span class="comment">// public abstract static void func2();  // Illegal combination of modifiers: 'abstract' and 'static'</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>只能访问所属类的静态字段和静态方法，方法中不能有 this 和 super 关键字，因此这两个关键字与具体对象关联。</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">A</span> </span>{</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> x;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">int</span> y;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">func1</span><span class="params">()</span></span>{</span><br><span class="line">    <span class="keyword">int</span> a = x;</span><br><span class="line">    <span class="comment">// int b = y;  // Non-static field 'y' cannot be referenced from a static context</span></span><br><span class="line">    <span class="comment">// int b = this.y;     // 'A.this' cannot be referenced from a static context</span></span><br><span class="line">}</span><br><span class="line">    }</span><br></pre></td></tr></tbody></table></figure><ol start="3"><li>静态语句块</li></ol><p>静态语句块在类初始化时运行一次。</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">A</span> </span>{</span><br><span class="line">    <span class="keyword">static</span> {</span><br><span class="line">        System.out.println(<span class="string">"123"</span>);</span><br><span class="line">    }</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>{</span><br><span class="line">    A a1 = <span class="keyword">new</span> A();</span><br><span class="line">    A a2 = <span class="keyword">new</span> A();</span><br><span class="line">}</span><br><span class="line">    }</span><br><span class="line"><span class="comment">//123</span></span><br></pre></td></tr></tbody></table></figure><ol start="4"><li>静态内部类</li></ol><p>非静态内部类依赖于外部类的实例，也就是说需要先创建外部类实例，才能用这个实例去创建非静态内部类。而静态内部类不需要。</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">OuterClass</span> </span>{</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">InnerClass</span> </span>{</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">StaticInnerClass</span> </span>{</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>{</span><br><span class="line">    <span class="comment">// InnerClass innerClass = new InnerClass(); // 'OuterClass.this' cannot be referenced from a static context</span></span><br><span class="line">    OuterClass outerClass = <span class="keyword">new</span> OuterClass();</span><br><span class="line">    InnerClass innerClass = outerClass.<span class="keyword">new</span> InnerClass();</span><br><span class="line">    StaticInnerClass staticInnerClass = <span class="keyword">new</span> StaticInnerClass();</span><br><span class="line">}</span><br><span class="line">    }</span><br></pre></td></tr></tbody></table></figure><p>静态内部类不能访问外部类的非静态的变量和方法。</p><ol start="5"><li>静态导包</li></ol><p>在使用静态变量和方法时不用再指明 ClassName，从而简化代码，但可读性大大降低。</p><p>import static com.xxx.ClassName.*</p><ol start="6"><li>初始化顺序</li></ol><p>静态变量和静态语句块优先于实例变量和普通语句块，静态变量和静态语句块的初始化顺序取决于它们在代码中的顺序。</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> String staticField = <span class="string">"静态变量"</span>;</span><br><span class="line"><span class="keyword">static</span> {</span><br><span class="line">    System.out.println(<span class="string">"静态语句块"</span>);</span><br><span class="line">}</span><br><span class="line"><span class="keyword">public</span> String field = <span class="string">"实例变量"</span>;</span><br><span class="line">{</span><br><span class="line">    System.out.println(<span class="string">"普通语句块"</span>);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>最后才是构造函数的初始化。</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">InitialOrderTest</span><span class="params">()</span> </span>{</span><br><span class="line">    System.out.println(<span class="string">"构造函数"</span>);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>存在继承的情况下，初始化顺序为：</p><p>父类（静态变量、静态语句块）<br>子类（静态变量、静态语句块）<br>父类（实例变量、普通语句块）<br>父类（构造函数）<br>子类（实例变量、普通语句块）<br>子类（构造函数）</p><h4 id="五、Object-通用方法"><a href="#五、Object-通用方法" class="headerlink" title="五、Object 通用方法"></a>五、Object 通用方法</h4><h6 id="概览-1"><a href="#概览-1" class="headerlink" title="概览"></a>概览</h6><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">native</span> <span class="keyword">int</span> <span class="title">hashCode</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">equals</span><span class="params">(Object obj)</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">native</span> Object <span class="title">clone</span><span class="params">()</span> <span class="keyword">throws</span> CloneNotSupportedException</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">native</span> Class<?> <span class="title">getClass</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">finalize</span><span class="params">()</span> <span class="keyword">throws</span> Throwable </span>{}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">native</span> <span class="keyword">void</span> <span class="title">notify</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">native</span> <span class="keyword">void</span> <span class="title">notifyAll</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">native</span> <span class="keyword">void</span> <span class="title">wait</span><span class="params">(<span class="keyword">long</span> timeout)</span> <span class="keyword">throws</span> InterruptedException</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title">wait</span><span class="params">(<span class="keyword">long</span> timeout, <span class="keyword">int</span> nanos)</span> <span class="keyword">throws</span> InterruptedException</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title">wait</span><span class="params">()</span> <span class="keyword">throws</span> InterruptedException</span></span><br></pre></td></tr></tbody></table></figure><h6 id="equals"><a href="#equals" class="headerlink" title="equals()"></a>equals()</h6><ol><li>等价关系</li></ol><p>两个对象具有等价关系，需要满足以下五个条件：</p><p>Ⅰ 自反性</p><p>x.equals(x); // true<br>Ⅱ 对称性</p><p>x.equals(y) == y.equals(x); // true<br>Ⅲ 传递性</p><p>if (x.equals(y) && y.equals(z))<br>x.equals(z); // true;<br>Ⅳ 一致性</p><p>多次调用 equals() 方法结果不变</p><p>x.equals(y) == x.equals(y); // true<br>Ⅴ 与 null 的比较</p><p>对任何不是 null 的对象 x 调用 x.equals(null) 结果都为 false</p><p>x.equals(null); // false;</p><ol start="2"><li>等价与相等</li></ol><p>对于基本类型，== 判断两个值是否相等，基本类型没有 equals() 方法。<br>对于引用类型，== 判断两个变量是否引用同一个对象，而 equals() 判断引用的对象是否等价。</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line">Integer x = <span class="keyword">new</span> Integer(<span class="number">1</span>);</span><br><span class="line">Integer y = <span class="keyword">new</span> Integer(<span class="number">1</span>);</span><br><span class="line">System.out.println(x.equals(y)); <span class="comment">// true</span></span><br><span class="line">System.out.println(x == y);      <span class="comment">// false</span></span><br></pre></td></tr></tbody></table></figure><ol start="3"><li>实现</li></ol><p>检查是否为同一个对象的引用，如果是直接返回 true；<br>检查是否是同一个类型，如果不是，直接返回 false；<br>将 Object 对象进行转型；<br>判断每个关键域是否相等。</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">EqualExample</span> </span>{</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> x;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">int</span> y;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">int</span> z;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">EqualExample</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> z)</span> </span>{</span><br><span class="line">    <span class="keyword">this</span>.x = x;</span><br><span class="line">    <span class="keyword">this</span>.y = y;</span><br><span class="line">    <span class="keyword">this</span>.z = z;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">equals</span><span class="params">(Object o)</span> </span>{</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span> == o) <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    <span class="keyword">if</span> (o == <span class="keyword">null</span> || getClass() != o.getClass()) <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line"></span><br><span class="line">    EqualExample that = (EqualExample) o;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (x != that.x) <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    <span class="keyword">if</span> (y != that.y) <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    <span class="keyword">return</span> z == that.z;</span><br><span class="line">}</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><h6 id="hashCode"><a href="#hashCode" class="headerlink" title="hashCode()"></a>hashCode()</h6><p>hashCode() 返回哈希值，而 equals() 是用来判断两个对象是否等价。等价的两个对象散列值一定相同，但是散列值相同的两个对象不一定等价，这是因为计算哈希值具有随机性，两个值不同的对象可能计算出相同的哈希值。</p><p>在覆盖 equals() 方法时应当总是覆盖 hashCode() 方法，保证等价的两个对象哈希值也相等。</p><p>HashSet 和 HashMap 等集合类使用了 hashCode() 方法来计算对象应该存储的位置，因此要将对象添加到这些集合类中，需要让对应的类实现 hashCode() 方法。</p><p>下面的代码中，新建了两个等价的对象，并将它们添加到 HashSet 中。我们希望将这两个对象当成一样的，只在集合中添加一个对象。但是 EqualExample 没有实现 hashCode() 方法，因此这两个对象的哈希值是不同的，最终导致集合添加了两个等价的对象。</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line">EqualExample e1 = <span class="keyword">new</span> EqualExample(<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">EqualExample e2 = <span class="keyword">new</span> EqualExample(<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">System.out.println(e1.equals(e2)); <span class="comment">// true</span></span><br><span class="line">HashSet<EqualExample> set = <span class="keyword">new</span> HashSet<>();</span><br><span class="line">set.add(e1);</span><br><span class="line">set.add(e2);</span><br><span class="line">System.out.println(set.size());   <span class="comment">// 2</span></span><br></pre></td></tr></tbody></table></figure><p>理想的哈希函数应当具有均匀性，即不相等的对象应当均匀分布到所有可能的哈希值上。这就要求了哈希函数要把所有域的值都考虑进来。可以将每个域都当成 R 进制的某一位，然后组成一个 R 进制的整数。</p><p>R 一般取 31，因为它是一个奇素数，如果是偶数的话，当出现乘法溢出，信息就会丢失，因为与 2 相乘相当于向左移一位，最左边的位丢失。并且一个数与 31 相乘可以转换成移位和减法：31*x == (x<<5)-x，编译器会自动进行这个优化。</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">hashCode</span><span class="params">()</span> </span>{</span><br><span class="line">    <span class="keyword">int</span> result = <span class="number">17</span>;</span><br><span class="line">    result = <span class="number">31</span> * result + x;</span><br><span class="line">    result = <span class="number">31</span> * result + y;</span><br><span class="line">    result = <span class="number">31</span> * result + z;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><h6 id="toString-NaN"><a href="#toString-NaN" class="headerlink" title="toString()"></a>toString()</h6><p>默认返回 ToStringExample@4554617c 这种形式，其中 @ 后面的数值为散列码的无符号十六进制表示。</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ToStringExample</span> </span>{</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> number;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">ToStringExample</span><span class="params">(<span class="keyword">int</span> number)</span> </span>{</span><br><span class="line">    <span class="keyword">this</span>.number = number;</span><br><span class="line">}</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">ToStringExample example = <span class="keyword">new</span> ToStringExample(<span class="number">123</span>);</span><br><span class="line">System.out.println(example.toString());</span><br><span class="line"><span class="comment">//ToStringExample@4554617c</span></span><br></pre></td></tr></tbody></table></figure><h6 id="clone"><a href="#clone" class="headerlink" title="clone()"></a>clone()</h6><ol><li>cloneable</li></ol><p>clone() 是 Object 的 protected 方法，它不是 public，一个类不显式去重写 clone()，其它类就不能直接去调用该类实例的 clone() 方法。</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CloneExample</span> </span>{</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> a;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> b;</span><br><span class="line">}</span><br><span class="line">CloneExample e1 = <span class="keyword">new</span> CloneExample();</span><br><span class="line"><span class="comment">// CloneExample e2 = e1.clone(); // 'clone()' has protected access in 'java.lang.Object'</span></span><br></pre></td></tr></tbody></table></figure><p>重写 clone() 得到以下实现：</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CloneExample</span> </span>{</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> a;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> b;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> CloneExample <span class="title">clone</span><span class="params">()</span> <span class="keyword">throws</span> CloneNotSupportedException </span>{</span><br><span class="line">    <span class="keyword">return</span> (CloneExample)<span class="keyword">super</span>.clone();</span><br><span class="line">}</span><br><span class="line">    }</span><br><span class="line">CloneExample e1 = <span class="keyword">new</span> CloneExample();</span><br><span class="line"><span class="keyword">try</span> {</span><br><span class="line">    CloneExample e2 = e1.clone();</span><br><span class="line">} <span class="keyword">catch</span> (CloneNotSupportedException e) {</span><br><span class="line">    e.printStackTrace();</span><br><span class="line">}</span><br><span class="line"><span class="comment">//java.lang.CloneNotSupportedException: CloneExample</span></span><br></pre></td></tr></tbody></table></figure><p>以上抛出了 CloneNotSupportedException，这是因为 CloneExample 没有实现 Cloneable 接口。</p><p>应该注意的是，clone() 方法并不是 Cloneable 接口的方法，而是 Object 的一个 protected 方法。Cloneable 接口只是规定，如果一个类没有实现 Cloneable 接口又调用了 clone() 方法，就会抛出 CloneNotSupportedException。</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CloneExample</span> <span class="keyword">implements</span> <span class="title">Cloneable</span> </span>{</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> a;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> b;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Object <span class="title">clone</span><span class="params">()</span> <span class="keyword">throws</span> CloneNotSupportedException </span>{</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">super</span>.clone();</span><br><span class="line">}</span><br><span class="line">    }</span><br></pre></td></tr></tbody></table></figure><ol start="2"><li>浅拷贝</li></ol><p>拷贝对象和原始对象的引用类型引用同一个对象。</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ShallowCloneExample</span> <span class="keyword">implements</span> <span class="title">Cloneable</span> </span>{</span><br><span class="line">    </span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">int</span>[] arr;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">ShallowCloneExample</span><span class="params">()</span> </span>{</span><br><span class="line">    arr = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">10</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i < arr.length; i++) {</span><br><span class="line">        arr[i] = i;</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">set</span><span class="params">(<span class="keyword">int</span> index, <span class="keyword">int</span> value)</span> </span>{</span><br><span class="line">    arr[index] = value;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">get</span><span class="params">(<span class="keyword">int</span> index)</span> </span>{</span><br><span class="line">    <span class="keyword">return</span> arr[index];</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> ShallowCloneExample <span class="title">clone</span><span class="params">()</span> <span class="keyword">throws</span> CloneNotSupportedException </span>{</span><br><span class="line">    <span class="keyword">return</span> (ShallowCloneExample) <span class="keyword">super</span>.clone();</span><br><span class="line">}</span><br><span class="line">   }</span><br><span class="line">ShallowCloneExample e1 = <span class="keyword">new</span> ShallowCloneExample();</span><br><span class="line">ShallowCloneExample e2 = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">try</span> {</span><br><span class="line">    e2 = e1.clone();</span><br><span class="line">} <span class="keyword">catch</span> (CloneNotSupportedException e) {</span><br><span class="line">    e.printStackTrace();</span><br><span class="line">}</span><br><span class="line">e1.set(<span class="number">2</span>, <span class="number">222</span>);</span><br><span class="line">System.out.println(e2.get(<span class="number">2</span>)); <span class="comment">// 222</span></span><br></pre></td></tr></tbody></table></figure><ol start="3"><li>深拷贝</li></ol><p>拷贝对象和原始对象的引用类型引用不同对象。</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DeepCloneExample</span> <span class="keyword">implements</span> <span class="title">Cloneable</span> </span>{</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span>[] arr;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">DeepCloneExample</span><span class="params">()</span> </span>{</span><br><span class="line">    arr = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">10</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i < arr.length; i++) {</span><br><span class="line">        arr[i] = i;</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">set</span><span class="params">(<span class="keyword">int</span> index, <span class="keyword">int</span> value)</span> </span>{</span><br><span class="line">    arr[index] = value;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">get</span><span class="params">(<span class="keyword">int</span> index)</span> </span>{</span><br><span class="line">    <span class="keyword">return</span> arr[index];</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> DeepCloneExample <span class="title">clone</span><span class="params">()</span> <span class="keyword">throws</span> CloneNotSupportedException </span>{</span><br><span class="line">    DeepCloneExample result = (DeepCloneExample) <span class="keyword">super</span>.clone();</span><br><span class="line">    result.arr = <span class="keyword">new</span> <span class="keyword">int</span>[arr.length];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i < arr.length; i++) {</span><br><span class="line">        result.arr[i] = arr[i];</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">}</span><br><span class="line">  DeepCloneExample e1 = <span class="keyword">new</span> DeepCloneExample();</span><br><span class="line">DeepCloneExample e2 = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">try</span> {</span><br><span class="line">    e2 = e1.clone();</span><br><span class="line">} <span class="keyword">catch</span> (CloneNotSupportedException e) {</span><br><span class="line">    e.printStackTrace();</span><br><span class="line">}</span><br><span class="line">e1.set(<span class="number">2</span>, <span class="number">222</span>);</span><br><span class="line">System.out.println(e2.get(<span class="number">2</span>)); <span class="comment">// 2</span></span><br><span class="line">  }</span><br></pre></td></tr></tbody></table></figure><ol start="4"><li>clone() 的替代方案</li></ol><p>使用 clone() 方法来拷贝一个对象即复杂又有风险，它会抛出异常，并且还需要类型转换。Effective Java 书上讲到，最好不要去使用 clone()，可以使用拷贝构造函数或者拷贝工厂来拷贝一个对象。</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CloneConstructorExample</span> </span>{</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span>[] arr;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">CloneConstructorExample</span><span class="params">()</span> </span>{</span><br><span class="line">    arr = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">10</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i < arr.length; i++) {</span><br><span class="line">        arr[i] = i;</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">CloneConstructorExample</span><span class="params">(CloneConstructorExample original)</span> </span>{</span><br><span class="line">    arr = <span class="keyword">new</span> <span class="keyword">int</span>[original.arr.length];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i < original.arr.length; i++) {</span><br><span class="line">        arr[i] = original.arr[i];</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">set</span><span class="params">(<span class="keyword">int</span> index, <span class="keyword">int</span> value)</span> </span>{</span><br><span class="line">    arr[index] = value;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">get</span><span class="params">(<span class="keyword">int</span> index)</span> </span>{</span><br><span class="line">    <span class="keyword">return</span> arr[index];</span><br><span class="line">}</span><br><span class="line">   }</span><br><span class="line">CloneConstructorExample e1 = <span class="keyword">new</span> CloneConstructorExample();</span><br><span class="line">CloneConstructorExample e2 = <span class="keyword">new</span> CloneConstructorExample(e1);</span><br><span class="line">e1.set(<span class="number">2</span>, <span class="number">222</span>);</span><br><span class="line">System.out.println(e2.get(<span class="number">2</span>)); <span class="comment">// 2</span></span><br></pre></td></tr></tbody></table></figure><h4 id="六、继承"><a href="#六、继承" class="headerlink" title="六、继承"></a>六、继承</h4><h6 id="访问权限"><a href="#访问权限" class="headerlink" title="访问权限"></a>访问权限</h6><p>Java 中有三个访问权限修饰符：private、protected 以及 public，如果不加访问修饰符，表示包级可见。</p><p>可以对类或类中的成员（字段和方法）加上访问修饰符。</p><p>类可见表示其它类可以用这个类创建实例对象。<br>成员可见表示其它类可以用这个类的实例对象访问到该成员；<br>protected 用于修饰成员，表示在继承体系中成员对于子类可见，但是这个访问修饰符对于类没有意义。</p><p>设计良好的模块会隐藏所有的实现细节，把它的 API 与它的实现清晰地隔离开来。模块之间只通过它们的 API 进行通信，一个模块不需要知道其他模块的内部工作情况，这个概念被称为信息隐藏或封装。因此访问权限应当尽可能地使每个类或者成员不被外界访问。</p><p>如果子类的方法重写了父类的方法，那么子类中该方法的访问级别不允许低于父类的访问级别。这是为了确保可以使用父类实例的地方都可以使用子类实例去代替，也就是确保满足里氏替换原则。</p><p>字段决不能是公有的，因为这么做的话就失去了对这个字段修改行为的控制，客户端可以对其随意修改。例如下面的例子中，AccessExample 拥有 id 公有字段，如果在某个时刻，我们想要使用 int 存储 id 字段，那么就需要修改所有的客户端代码。</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AccessExample</span> </span>{</span><br><span class="line">    <span class="keyword">public</span> String id;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>可以使用公有的 getter 和 setter 方法来替换公有字段，这样的话就可以控制对字段的修改行为。</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AccessExample</span> </span>{</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getId</span><span class="params">()</span> </span>{</span><br><span class="line">    <span class="keyword">return</span> id + <span class="string">""</span>;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(String id)</span> </span>{</span><br><span class="line">    <span class="keyword">this</span>.id = Integer.valueOf(id);</span><br><span class="line">}</span><br><span class="line">    }</span><br></pre></td></tr></tbody></table></figure><p>但是也有例外，如果是包级私有的类或者私有的嵌套类，那么直接暴露成员不会有特别大的影响。</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AccessWithInnerClassExample</span> </span>{</span><br><span class="line">    <span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">InnerClass</span> </span>{</span><br><span class="line">    <span class="keyword">int</span> x;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> InnerClass innerClass;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">AccessWithInnerClassExample</span><span class="params">()</span> </span>{</span><br><span class="line">    innerClass = <span class="keyword">new</span> InnerClass();</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getValue</span><span class="params">()</span> </span>{</span><br><span class="line">    <span class="keyword">return</span> innerClass.x;  <span class="comment">// 直接访问</span></span><br><span class="line">}</span><br><span class="line">   }</span><br></pre></td></tr></tbody></table></figure><h6 id="抽象类与接口"><a href="#抽象类与接口" class="headerlink" title="抽象类与接口"></a>抽象类与接口</h6><ol><li>抽象类</li></ol><p>抽象类和抽象方法都使用 abstract 关键字进行声明。如果一个类中包含抽象方法，那么这个类必须声明为抽象类。</p><p>抽象类和普通类最大的区别是，抽象类不能被实例化，只能被继承。</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">AbstractClassExample</span> </span>{</span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">int</span> x;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">int</span> y;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">func1</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">func2</span><span class="params">()</span> </span>{</span><br><span class="line">    System.out.println(<span class="string">"func2"</span>);</span><br><span class="line">}</span><br><span class="line">    }</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AbstractExtendClassExample</span> <span class="keyword">extends</span> <span class="title">AbstractClassExample</span> </span>{</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">func1</span><span class="params">()</span> </span>{</span><br><span class="line">        System.out.println(<span class="string">"func1"</span>);</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"><span class="comment">// AbstractClassExample ac1 = new AbstractClassExample(); // 'AbstractClassExample' is abstract; cannot be instantiated</span></span><br><span class="line">AbstractClassExample ac2 = <span class="keyword">new</span> AbstractExtendClassExample();</span><br><span class="line">ac2.func1();</span><br></pre></td></tr></tbody></table></figure><ol start="2"><li>接口</li></ol><p>接口是抽象类的延伸，在 Java 8 之前，它可以看成是一个完全抽象的类，也就是说它不能有任何的方法实现。</p><p>从 Java 8 开始，接口也可以拥有默认的方法实现，这是因为不支持默认方法的接口的维护成本太高了。在 Java 8 之前，如果一个接口想要添加新的方法，那么要修改所有实现了该接口的类，让它们都实现新增的方法。</p><p>接口的成员（字段 + 方法）默认都是 public 的，并且不允许定义为 private 或者 protected。</p><p>接口的字段默认都是 static 和 final 的。</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">InterfaceExample</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">func1</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">default</span> <span class="keyword">void</span> <span class="title">func2</span><span class="params">()</span></span>{</span><br><span class="line">    System.out.println(<span class="string">"func2"</span>);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> x = <span class="number">123</span>;</span><br><span class="line"><span class="comment">// int y;               // Variable 'y' might not have been initialized</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">int</span> z = <span class="number">0</span>;       <span class="comment">// Modifier 'public' is redundant for interface fields</span></span><br><span class="line"><span class="comment">// private int k = 0;   // Modifier 'private' not allowed here</span></span><br><span class="line"><span class="comment">// protected int l = 0; // Modifier 'protected' not allowed here</span></span><br><span class="line"><span class="comment">// private void fun3(); // Modifier 'private' not allowed here</span></span><br><span class="line">    }</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">InterfaceImplementExample</span> <span class="keyword">implements</span> <span class="title">InterfaceExample</span> </span>{</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">func1</span><span class="params">()</span> </span>{</span><br><span class="line">        System.out.println(<span class="string">"func1"</span>);</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"><span class="comment">// InterfaceExample ie1 = new InterfaceExample(); // 'InterfaceExample' is abstract; cannot be instantiated</span></span><br><span class="line">InterfaceExample ie2 = <span class="keyword">new</span> InterfaceImplementExample();</span><br><span class="line">ie2.func1();</span><br><span class="line">System.out.println(InterfaceExample.x);</span><br></pre></td></tr></tbody></table></figure><ol start="3"><li>比较</li></ol><p>从设计层面上看，抽象类提供了一种 IS-A 关系，需要满足里式替换原则，即子类对象必须能够替换掉所有父类对象。而接口更像是一种 LIKE-A 关系，它只是提供一种方法实现契约，并不要求接口和实现接口的类具有 IS-A 关系。<br>从使用上来看，一个类可以实现多个接口，但是不能继承多个抽象类。<br>接口的字段只能是 static 和 final 类型的，而抽象类的字段没有这种限制。<br>接口的成员只能是 public 的，而抽象类的成员可以有多种访问权限。</p><ol start="4"><li>使用选择</li></ol><p>使用接口：</p><p>需要让不相关的类都实现一个方法，例如不相关的类都可以实现 Comparable 接口中的 compareTo() 方法；<br>需要使用多重继承。<br>使用抽象类：</p><p>需要在几个相关的类中共享代码。<br>需要能控制继承来的成员的访问权限，而不是都为 public。<br>需要继承非静态和非常量字段。<br>在很多情况下，接口优先于抽象类。因为接口没有抽象类严格的类层次结构要求，可以灵活地为一个类添加行为。并且从 Java 8 开始，接口也可以有默认的方法实现，使得修改接口的成本也变的很低。</p><h6 id="super"><a href="#super" class="headerlink" title="super"></a>super</h6><p>访问父类的构造函数：可以使用 super() 函数访问父类的构造函数，从而委托父类完成一些初始化的工作。应该注意到，子类一定会调用父类的构造函数来完成初始化工作，一般是调用父类的默认构造函数，如果子类需要调用父类其它构造函数，那么就可以使用 super() 函数。<br>访问父类的成员：如果子类重写了父类的某个方法，可以通过使用 super 关键字来引用父类的方法实现。</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SuperExample</span> </span>{</span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">int</span> x;</span><br><span class="line"><span class="keyword">protected</span> <span class="keyword">int</span> y;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">SuperExample</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>{</span><br><span class="line">    <span class="keyword">this</span>.x = x;</span><br><span class="line">    <span class="keyword">this</span>.y = y;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">func</span><span class="params">()</span> </span>{</span><br><span class="line">    System.out.println(<span class="string">"SuperExample.func()"</span>);</span><br><span class="line">}</span><br><span class="line">    }</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SuperExtendExample</span> <span class="keyword">extends</span> <span class="title">SuperExample</span> </span>{</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> z;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">SuperExtendExample</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> z)</span> </span>{</span><br><span class="line">    <span class="keyword">super</span>(x, y);</span><br><span class="line">    <span class="keyword">this</span>.z = z;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">func</span><span class="params">()</span> </span>{</span><br><span class="line">    <span class="keyword">super</span>.func();</span><br><span class="line">    System.out.println(<span class="string">"SuperExtendExample.func()"</span>);</span><br><span class="line">}</span><br><span class="line">    }</span><br><span class="line">SuperExample e = <span class="keyword">new</span> SuperExtendExample(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>);</span><br><span class="line">e.func();</span><br><span class="line">SuperExample.func()</span><br><span class="line">SuperExtendExample.func()</span><br></pre></td></tr></tbody></table></figure><h6 id="重写与重载"><a href="#重写与重载" class="headerlink" title="重写与重载"></a>重写与重载</h6><ol><li>重写（Override）</li></ol><p>存在于继承体系中，指子类实现了一个与父类在方法声明上完全相同的一个方法。</p><p>为了满足里式替换原则，重写有以下三个限制：</p><p>子类方法的访问权限必须大于等于父类方法；<br>子类方法的返回类型必须是父类方法返回类型或为其子类型。<br>子类方法抛出的异常类型必须是父类抛出异常类型或为其子类型。<br>使用 @Override 注解，可以让编译器帮忙检查是否满足上面的三个限制条件。</p><p>下面的示例中，SubClass 为 SuperClass 的子类，SubClass 重写了 SuperClass 的 func() 方法。其中：</p><p>子类方法访问权限为 public，大于父类的 protected。<br>子类的返回类型为 ArrayList，是父类返回类型 List 的子类。<br>子类抛出的异常类型为 Exception，是父类抛出异常 Throwable 的子类。<br>子类重写方法使用 @Override 注解，从而让编译器自动检查是否满足限制条件。</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SuperClass</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">protected</span> List<Integer> <span class="title">func</span><span class="params">()</span> <span class="keyword">throws</span> Throwable </span>{</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ArrayList<>();</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SubClass</span> <span class="keyword">extends</span> <span class="title">SuperClass</span> </span>{</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ArrayList<Integer> <span class="title">func</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>{</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ArrayList<>();</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>在调用一个方法时，先从本类中查找看是否有对应的方法，如果没有再到父类中查看，看是否从父类继承来。否则就要对参数进行转型，转成父类之后看是否有对应的方法。总的来说，方法调用的优先级为：</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">this</span>.func(<span class="keyword">this</span>)</span><br><span class="line"><span class="keyword">super</span>.func(<span class="keyword">this</span>)</span><br><span class="line"><span class="keyword">this</span>.func(<span class="keyword">super</span>)</span><br><span class="line"><span class="keyword">super</span>.func(<span class="keyword">super</span>)</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    A</span></span><br><span class="line"><span class="comment">    |</span></span><br><span class="line"><span class="comment">    B</span></span><br><span class="line"><span class="comment">    |</span></span><br><span class="line"><span class="comment">    C</span></span><br><span class="line"><span class="comment">    |</span></span><br><span class="line"><span class="comment">    D</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span> </span>{</span><br><span class="line"></span><br><span class="line">```</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">show</span><span class="params">(A obj)</span> </span>{</span><br><span class="line">    System.out.println(<span class="string">"A.show(A)"</span>);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">show</span><span class="params">(C obj)</span> </span>{</span><br><span class="line">    System.out.println(<span class="string">"A.show(C)"</span>);</span><br><span class="line">}</span><br><span class="line">```</span><br><span class="line"></span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span> <span class="keyword">extends</span> <span class="title">A</span> </span>{</span><br><span class="line"></span><br><span class="line">```</span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">show</span><span class="params">(A obj)</span> </span>{</span><br><span class="line">    System.out.println(<span class="string">"B.show(A)"</span>);</span><br><span class="line">}</span><br><span class="line">```</span><br><span class="line"></span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span> <span class="keyword">extends</span> <span class="title">B</span> </span>{</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">D</span> <span class="keyword">extends</span> <span class="title">C</span> </span>{</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>{</span><br><span class="line">    A a = <span class="keyword">new</span> A();</span><br><span class="line">B b = <span class="keyword">new</span> B();</span><br><span class="line">C c = <span class="keyword">new</span> C();</span><br><span class="line">D d = <span class="keyword">new</span> D();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 在 A 中存在 show(A obj)，直接调用</span></span><br><span class="line">a.show(a); <span class="comment">// A.show(A)</span></span><br><span class="line"><span class="comment">// 在 A 中不存在 show(B obj)，将 B 转型成其父类 A</span></span><br><span class="line">a.show(b); <span class="comment">// A.show(A)</span></span><br><span class="line"><span class="comment">// 在 B 中存在从 A 继承来的 show(C obj)，直接调用</span></span><br><span class="line">b.show(c); <span class="comment">// A.show(C)</span></span><br><span class="line"><span class="comment">// 在 B 中不存在 show(D obj)，但是存在从 A 继承来的 show(C obj)，将 D 转型成其父类 C</span></span><br><span class="line">b.show(d); <span class="comment">// A.show(C)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 引用的还是 B 对象，所以 ba 和 b 的调用结果一样</span></span><br><span class="line">A ba = <span class="keyword">new</span> B();</span><br><span class="line">ba.show(c); <span class="comment">// A.show(C)</span></span><br><span class="line">ba.show(d); <span class="comment">// A.show(C)</span></span><br><span class="line">    }</span><br></pre></td></tr></tbody></table></figure><ol start="2"><li>重载（Overload）</li></ol><p>存在于同一个类中，指一个方法与已经存在的方法名称上相同，但是参数类型、个数、顺序至少有一个不同。</p><p>应该注意的是，返回值不同，其它都相同不算是重载。</p><h4 id="七、反射"><a href="#七、反射" class="headerlink" title="七、反射"></a>七、反射</h4><p>每个类都有一个 Class 对象，包含了与类有关的信息。当编译一个新类时，会产生一个同名的 .class 文件，该文件内容保存着 Class 对象。</p><p>类加载相当于 Class 对象的加载，类在第一次使用时才动态加载到 JVM 中。也可以使用 Class.forName(“com.mysql.jdbc.Driver”) 这种方式来控制类的加载，该方法会返回一个 Class 对象。</p><p>反射可以提供运行时的类信息，并且这个类可以在运行时才加载进来，甚至在编译时期该类的 .class 不存在也可以加载进来。</p><p>Class 和 java.lang.reflect 一起对反射提供了支持，java.lang.reflect 类库主要包含了以下三个类：</p><p>Field ：可以使用 get() 和 set() 方法读取和修改 Field 对象关联的字段；<br>Method ：可以使用 invoke() 方法调用与 Method 对象关联的方法；<br>Constructor ：可以用 Constructor 的 newInstance() 创建新的对象。<br>反射的优点：</p><p><strong>可扩展性</strong> ：应用程序可以利用全限定名创建可扩展对象的实例，来使用来自外部的用户自定义类。<br><strong>类浏览器和可视化开发环境</strong> ：一个类浏览器需要可以枚举类的成员。可视化开发环境（如 IDE）可以从利用反射中可用的类型信息中受益，以帮助程序员编写正确的代码。<br><strong>调试器和测试工具</strong> ： 调试器需要能够检查一个类里的私有成员。测试工具可以利用反射来自动地调用类里定义的可被发现的 API 定义，以确保一组测试中有较高的代码覆盖率。<br>反射的缺点：</p><p>尽管反射非常强大，但也不能滥用。如果一个功能可以不用反射完成，那么最好就不用。在我们使用反射技术时，下面几条内容应该牢记于心。</p><p><strong>性能开销</strong> ：反射涉及了动态类型的解析，所以 JVM 无法对这些代码进行优化。因此，反射操作的效率要比那些非反射操作低得多。我们应该避免在经常被执行的代码或对性能要求很高的程序中使用反射。<br><strong>安全限制</strong> ：使用反射技术要求程序必须在一个没有安全限制的环境中运行。如果一个程序必须在有安全限制的环境中运行，如 Applet，那么这就是个问题了。<br><strong>内部暴露</strong> ：由于反射允许代码执行一些在正常情况下不被允许的操作（比如访问私有的属性和方法），所以使用反射可能会导致意料之外的副作用，这可能导致代码功能失调并破坏可移植性。反射代码破坏了抽象性，因此当平台发生改变的时候，代码的行为就有可能也随着变化。<br>Trail: The Reflection API</p><h4 id="八、异常"><a href="#八、异常" class="headerlink" title="八、异常"></a>八、异常</h4><p>Throwable 可以用来表示任何可以作为异常抛出的类，分为两种： Error 和 Exception。其中 Error 用来表示 JVM 无法处理的错误，Exception 分为两种：</p><p>受检异常 ：需要用 try…catch… 语句捕获并进行处理，并且可以从异常中恢复；<br>非受检异常 ：是程序运行时错误，例如除 0 会引发 Arithmetic Exception，此时程序崩溃并且无法恢复。<br><img src="https://camo.githubusercontent.com/106f71b4556e95b4a8508e82d9b6bec8ccb9e964/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f50506a77502e706e67" width="600" data-canonical-src="https://cs-notes-1256109796.cos.ap-guangzhou.myqcloud.com/PPjwP.png" style="max-width:100%"></p><h4 id="九、泛型"><a href="#九、泛型" class="headerlink" title="九、泛型"></a>九、泛型</h4><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Box</span><<span class="title">T</span>> </span>{</span><br><span class="line">    <span class="comment">// T stands for "Type"</span></span><br><span class="line">    <span class="keyword">private</span> T t;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">set</span><span class="params">(T t)</span> </span>{ <span class="keyword">this</span>.t = t; }</span><br><span class="line">    <span class="function"><span class="keyword">public</span> T <span class="title">get</span><span class="params">()</span> </span>{ <span class="keyword">return</span> t; }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><h4 id="十、注解"><a href="#十、注解" class="headerlink" title="十、注解"></a>十、注解</h4><p>Java 注解是附加在代码中的一些元信息，用于一些工具在编译、运行时进行解析和使用，起到说明、配置的功能。注解不会也不能影响代码的实际逻辑，仅仅起到辅助性的作用。</p><h4 id="十一、特性"><a href="#十一、特性" class="headerlink" title="十一、特性"></a>十一、特性</h4><p>Java 各版本的新特性<br>New highlights in Java SE 8</p><p>Lambda Expressions<br>Pipelines and Streams<br>Date and Time API<br>Default Methods<br>Type Annotations<br>Nashhorn JavaScript Engine<br>Concurrent Accumulators<br>Parallel operations<br>PermGen Error Removed<br>New highlights in Java SE 7</p><p>Strings in Switch Statement<br>Type Inference for Generic Instance Creation<br>Multiple Exception Handling<br>Support for Dynamic Languages<br>Try with Resources<br>Java nio Package<br>Binary Literals, Underscore in literals<br>Diamond Syntax<br>Difference between Java 1.8 and Java 1.7?<br>Java 8 特性<br>Java 与 C++ 的区别<br>Java 是纯粹的面向对象语言，所有的对象都继承自 java.lang.Object，C++ 为了兼容 C 即支持面向对象也支持面向过程。<br>Java 通过虚拟机从而实现跨平台特性，但是 C++ 依赖于特定的平台。<br>Java 没有指针，它的引用可以理解为安全指针，而 C++ 具有和 C 一样的指针。<br>Java 支持自动垃圾回收，而 C++ 需要手动回收。<br>Java 不支持多重继承，只能通过实现多个接口来达到相同目的，而 C++ 支持多重继承。<br>Java 不支持操作符重载，虽然可以对两个 String 对象执行加法运算，但是这是语言内置支持的操作，不属于操作符重载，而 C++ 可以。<br>Java 的 goto 是保留字，但是不可用，C++ 可以使用 goto。</p><p>JRE or JDK<br>JRE：Java Runtime Environment，Java 运行环境的简称，为 Java 的运行提供了所需的环境。它是一个 JVM 程序，主要包括了 JVM 的标准实现和一些 Java 基本类库。<br>JDK：Java Development Kit，Java 开发工具包，提供了 Java 的开发及运行环境。JDK 是 Java 开发的核心，集成了 JRE 以及一些其它的工具，比如编译 Java 源码的编译器 javac 等。</p><!-- rebuild by neat --></body></html>]]></content>
      <categories>
        <category>编程语言</category>
      </categories>
      <tags>
        <tag>java</tag>
      </tags>
  </entry>
  <entry>
    <title>Linux之JDK、Tomcat安装及环境配置</title>
    <url>/el/20/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><!-- build time:Sat May 22 2021 19:59:12 GMT+0800 (GMT+08:00) --><html><head></head><body><img class="st" src="https://i.loli.net/2020/04/28/HtCAO1msxLr6vUX.png"><a id="more"></a><p>在这里只介绍linux下相关软件安装及环境配置，至于linux的基本知识和原理可以百度哈。</p><p>首先在linux上有三种安装软件的方式分别是：</p><div class="note info no-icon"><p>rpm安装<br>解压缩安装<br>yum安装</p></div><h3 id="JDK安装（rpm安装）"><a href="#JDK安装（rpm安装）" class="headerlink" title="JDK安装（rpm安装）"></a>JDK安装（rpm安装）</h3><ol><li>这里我们选择rpm安装jdk</li></ol><ul><li><p>在window上下载rpm包，百度jdk rpm即可</p></li><li><p>如果是自己买的服务器可以用xshell远程连接服务器，然后用xftp将rpm包上传到远程服务器/usr/lib目录下或者虚拟机</p><p>这里推荐还是在服务器/usr/lib目录下新建java目录,将rpm上传在java目录</p></li></ul><ol start="2"><li><p>检查本地是否有安装过jdk</p><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">[root@localhost /]<span class="comment"># java -version</span></span><br><span class="line">java version <span class="string">"1.8.0_121"</span></span><br><span class="line">Java(TM) SE Runtime Environment (build 1.8.0_121-b13)</span><br><span class="line">Java HotSpot(TM) 64-Bit Server VM (build 25.121-b13, mixed mode)</span><br><span class="line"><span class="comment"># 检查服务器本地的jdk的版本</span></span><br><span class="line"><span class="comment"># -qa 列出所有包</span></span><br><span class="line"><span class="comment"># |grep 是否包含某个字符串</span></span><br><span class="line">[root@localhost /]<span class="comment"># rpm -qa|grep jdk</span></span><br><span class="line">jdk1.8.0_121-1.8.0_121-fcs.x86_64</span><br><span class="line"><span class="comment"># 卸载 -e</span></span><br><span class="line"><span class="comment"># 强制删除 --nodeps （可选）</span></span><br><span class="line">[root@localhost /]<span class="comment"># rpm -e --nodeps jdk1.8.0_121-1.8.0_121-fcs.x86_64</span></span><br><span class="line"><span class="comment">#卸载后查看是否还有jdk版本</span></span><br><span class="line">[root@localhost /]<span class="comment"># java -version</span></span><br><span class="line">-bash: /usr/bin/java: No such file or directory</span><br></pre></td></tr></tbody></table></figure></li><li><p>安装JDK</p><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment"># 安装java rpm</span></span><br><span class="line">[root@localhost /]<span class="comment"># cd /usr/lib/java</span></span><br><span class="line"><span class="comment"># i 安装</span></span><br><span class="line"><span class="comment"># v 显示安装过程</span></span><br><span class="line"><span class="comment"># h 显示进度</span></span><br><span class="line">[root@localhost java]<span class="comment"># rpm -ivh jdk-8u221-linux-x64.rpm</span></span><br><span class="line"><span class="comment">#有选择时，选择y</span></span><br></pre></td></tr></tbody></table></figure></li><li><p>配置环境变量</p><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">[root@localhost java]<span class="comment"># cd /</span></span><br><span class="line"><span class="comment">#vim 编辑</span></span><br><span class="line">[root@localhost /]<span class="comment">#vim /etc/profile</span></span><br><span class="line"><span class="comment">#在文本末尾添加以下内容</span></span><br><span class="line">JAVA_HOME=/usr/lib/java/jdk1.8.0_221-amd64</span><br><span class="line">CLASSPATH=%JAVA_HOME%/lib:%JAVA_HOME%/jre/lib</span><br><span class="line">PATH=<span class="variable">$PATH</span>:<span class="variable">$JAVA_HOME</span>/bin:<span class="variable">$JAVA_HOME</span>/jre/bin</span><br><span class="line"><span class="built_in">export</span> PATH CLASSPATH JAVA_HOME</span><br><span class="line"></span><br><span class="line"><span class="comment">#编辑后按ESC输入冒号（:）然后wq回车</span></span><br></pre></td></tr></tbody></table></figure></li><li><p>验证</p><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">#使环境变量生效</span></span><br><span class="line">[root@localhost /]<span class="comment"># source /etc/profile</span></span><br><span class="line">[root@localhost /]<span class="comment"># Java</span></span><br></pre></td></tr></tbody></table></figure></li></ol><h3 id="Tomcat安装（解压缩安装）"><a href="#Tomcat安装（解压缩安装）" class="headerlink" title="Tomcat安装（解压缩安装）"></a>Tomcat安装（解压缩安装）</h3><ol><li>这里选择解压缩安装Tomcat</li></ol><ul><li>下载后缀为tar.gz的tomcat包</li><li>使用xshell将包至于/usr/lib/tomcat，没有这个目录自行新建</li></ul><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">[root@localhost /]<span class="comment"># cd /usr/lib/tomcat</span></span><br><span class="line">[root@localhost tomcat]<span class="comment"># ls</span></span><br><span class="line">apache-tomcat-9.0.22.tar.gz</span><br><span class="line"> <span class="comment"># 解压</span></span><br><span class="line">[root@localhost tomcat]<span class="comment"># tar -zxvf apache-tomcat-9.0.22.tar.gz</span></span><br></pre></td></tr></tbody></table></figure><ol start="2"><li>运行Tomcat，进入bin目录，如同在Windows下的操作</li></ol><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment"># 启动tomcat</span></span><br><span class="line">[root@localhost bin]<span class="comment"># ./startup.sh</span></span><br><span class="line"><span class="comment"># 关闭tomcat</span></span><br><span class="line">[root@localhost bin]<span class="comment"># ./shutdown.sh</span></span><br></pre></td></tr></tbody></table></figure><ol start="3"><li>打开Linux的防火墙端口，如果是阿里云，需要阿里云的安全组策略（只有这个开放才是真正的被访问）是开放的</li></ol><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment"># 查看firewall服务状态</span></span><br><span class="line">[root@localhost /]<span class="comment"># systemctl status firewalld</span></span><br><span class="line"><span class="comment"># firewall服务开启</span></span><br><span class="line">[root@localhost /]<span class="comment"># service firewalld start</span></span><br><span class="line"><span class="comment"># firewall服务重启</span></span><br><span class="line">[root@localhost /]<span class="comment"># service firewalld restart</span></span><br><span class="line"><span class="comment"># firewall服务关闭</span></span><br><span class="line">[root@localhost /]<span class="comment"># service firewalld stop</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看防火墙规则</span></span><br><span class="line">[root@localhost /]<span class="comment"># firewall-cmd --list-all    # 查看全部信息</span></span><br><span class="line">[root@localhost /]<span class="comment"># firewall-cmd --list-ports  # 只看端口信息</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 开启端口</span></span><br><span class="line"><span class="comment"># --zone 作用域</span></span><br><span class="line"><span class="comment"># --add-port=80/tcp  添加端口，格式为：端口/通讯协议</span></span><br><span class="line"><span class="comment"># --permanent   永久生效，没有此参数重启后失效</span></span><br><span class="line">[root@localhost /]<span class="comment"># firewall-cmd --zone=public --add-port=80/tcp --permanent</span></span><br><span class="line"><span class="comment"># 重启防火墙：</span></span><br><span class="line">[root@localhost /]<span class="comment"># systemctl restart firewalld.service</span></span><br></pre></td></tr></tbody></table></figure><!-- rebuild by neat --></body></html>]]></content>
      <categories>
        <category>服务器</category>
      </categories>
      <tags>
        <tag>linux</tag>
        <tag>jdk</tag>
        <tag>Tomcat</tag>
      </tags>
  </entry>
  <entry>
    <title>Ngrok内网穿透</title>
    <url>/net/12/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><!-- build time:Sat May 22 2021 19:59:12 GMT+0800 (GMT+08:00) --><html><head></head><body><h3 id="🐻什么是内网穿透？"><a href="#🐻什么是内网穿透？" class="headerlink" title="🐻什么是内网穿透？"></a>🐻什么是内网穿透？</h3><p>内网穿透，即NAT穿透，网络连接时术语，计算机是局域网内时，外网与内网的计算机节点需要连接通信，有时就会出现不支持内网穿透。就是说映射端口，能让外网的电脑找到处于内网的电脑，提高下载速度。不管是内网穿透还是其他类型的网络穿透，都是网络穿透的统一方法来研究和解决。</p><h4 id="🐻使用Ngrok实现内网穿透"><a href="#🐻使用Ngrok实现内网穿透" class="headerlink" title="🐻使用Ngrok实现内网穿透"></a>🐻使用Ngrok实现内网穿透</h4><ol><li>百度Ngrok进入国内主页，注册账户</li></ol><p><img src="https://i.loli.net/2020/05/12/OrocsqdtMaywYFG.png" alt></p><ol start="2"><li>注册完成后，登录后需要微信验证下，然后我们开通隧道</li></ol><p><img src="https://i.loli.net/2020/05/12/qV2EdpYzfnKjJuw.png" alt></p><ol start="3"><li>往下翻你就可以看到0元的套餐，然后点击购买</li></ol><p><img src="https://i.loli.net/2020/05/12/gGet7TohJyicDWY.png" alt></p><ol start="4"><li>填写信息</li></ol><p><img src="https://i.loli.net/2020/05/12/m5fodixbpOh6saR.png" alt></p><ol start="5"><li>填好信息后下载客户端</li></ol><p><img src="https://i.loli.net/2020/05/12/1HTd3hJbnpKfz8D.png" alt></p><ol start="6"><li>下载后启动.bat可执行文件</li></ol><p><img src="https://i.loli.net/2020/05/12/gdfvLRKpzE4usJX.png" alt><br>最后输入你刚刚购买的隧道id启动客户端，接着用Ngrok自动生成的外网ip访问本机的项目，注意访问时先启动本地项目。</p><!-- rebuild by neat --></body></html>]]></content>
      <categories>
        <category>内网穿透</category>
      </categories>
      <tags>
        <tag>网络</tag>
      </tags>
  </entry>
  <entry>
    <title>docker部署springboot项目</title>
    <url>/zh/20/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><!-- build time:Sat May 22 2021 19:59:12 GMT+0800 (GMT+08:00) --><html><head></head><body><h5 id="准备"><a href="#准备" class="headerlink" title="准备"></a>准备</h5><blockquote><p>需要的知识</p></blockquote><ul><li>Linux操作系统</li><li>docker(了解git的工作方式即可)</li></ul><h5 id="工具"><a href="#工具" class="headerlink" title="工具"></a>工具</h5><blockquote><p>xshell(用来连接linux服务器)<br>xftp用来给linux服务器上传文件<br>sqlyog(或者navicat)在服务器上解析.sql脚本<br>maven(idea自带) 用来打包</p></blockquote><h5 id="Docker"><a href="#Docker" class="headerlink" title="Docker"></a>Docker</h5><p>简单介绍一下，docker我理解的就是更方便的部署工具，如果有玩过服务器的同学都知道，在linux服务器上配置mysql是一件挺麻烦的事，而用了docker，只需要几个命令，就可以配置好mysql。</p><p>docker 的三个概念:</p><p>仓库：仓库就类比于github仓库，上面存储着各种各样版本的软件<br>镜像，我们从docker上拉取一个软件初始就是个镜像<br>容器，容器就是镜像运行时，可以用的软件<br>类比一下好理解，镜像就是java中的类，而容器则是由类生成的对象，类无法直接使用，而对象可以。</p><p>接下来开始实操</p><p>我们按照官网来</p><p>在安装docker前，先安装docker的包</p><figure class="highlight plain"><table><tbody><tr><td class="code"><pre><span class="line">sudo yum install -y yum-utils \</span><br><span class="line">  device-mapper-persistent-data \</span><br><span class="line">  lvm2</span><br></pre></td></tr></tbody></table></figure><p>配置docker的仓库，从docker官方仓库下载会太慢，我们就将仓库配置到阿里云(类似于maven的仓库配置)</p><figure class="highlight plain"><table><tbody><tr><td class="code"><pre><span class="line">sudo yum-config-manager \</span><br><span class="line">    --add-repo \</span><br><span class="line">    http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo</span><br></pre></td></tr></tbody></table></figure><h5 id="安装docker"><a href="#安装docker" class="headerlink" title="安装docker"></a>安装docker</h5><figure class="highlight plain"><table><tbody><tr><td class="code"><pre><span class="line">sudo yum install docker-ce docker-ce-cli containerd.io</span><br></pre></td></tr></tbody></table></figure><p>运行中出现Is this ok,选择y</p><p>要继续配置一下阿里云镜像加速,按如下步骤完成即可.</p><p>步骤2，是写配置文件</p><ol><li><p>mkdir -p /etc/docker</p></li><li><p>vim /etc/docker/daemon.json</p></li><li><p>systemctl daemon-reload</p></li><li><p>systemctl restart docker</p><ul><li>步骤2的配置文件格式<br>{<br>“registry-mirrors”: [“https://｛自已的编码｝.mirror.aliyuncs.com”]<br>}<figure class="highlight plain"><table><tbody><tr><td class="code"><pre><span class="line"></span><br><span class="line">在阿里云镜像云查看镜像加速器配置</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">开启docker</span><br><span class="line"></span><br><span class="line">sudo systemctl start docker</span><br><span class="line"></span><br><span class="line">跑一个docker版的helloworld，类似于java的hello，证明安装成功</span><br><span class="line"></span><br><span class="line">sudo docker run hello-world</span><br><span class="line"></span><br><span class="line">出现下图内容，表示docker运行成功</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">##### 服务器的配置</span><br><span class="line">服务器配置总结为三个，防火墙，端口，和安全组</span><br><span class="line"></span><br><span class="line">1.查看防火墙状态，如未开启要开启防火墙，我的是开启的</span><br><span class="line"></span><br><span class="line">firewall-cmd --state</span><br><span class="line"></span><br><span class="line">如果没开启，开启防火墙的命令</span><br><span class="line"></span><br><span class="line">systemctl start firewalld.service</span><br><span class="line"></span><br><span class="line">添加对外开放的端口，我是开了三个端口，一个80(Http端口),一个8080(tomcat)，一个2206(mysql)</span><br><span class="line">```linux</span><br><span class="line">1. firewall-cmd --zone=public --add-port=80/tcp --permanent</span><br><span class="line">2. firewall-cmd --zone=public --add-port=8080/tcp --permanent</span><br><span class="line">3. firewall-cmd --zone=public --add-port=3306/tcp --permanent</span><br></pre></td></tr></tbody></table></figure>开完端口，要重新加载防火墙</li></ul></li></ol><p>firewall-cmd –reload</p><p>查看开放的端口</p><p>firewall-cmd –list-ports</p><p>配置安全组:百度如何配置进入配安全组的地方，按照下图配置的条件配置即可</p><h5 id="安装mysql"><a href="#安装mysql" class="headerlink" title="安装mysql"></a>安装mysql</h5><p>从docker hub上查找mysql镜像</p><p>docker search mysql</p><p>从docker hub上拉取mysql,我拉取的mysql版本是mysql5.7</p><p>docker pull mysql:5.7</p><p>运行mysql，开放的端口是3306，密码是123456， -d是后台运行</p><p>docker run -p 3306:3306 –name mysql -e MYSQL_ROOT_PASSWORD=123456 -d mysql:5.7</p><p>docker ps 查看容器创建成功</p><p>有个命令，可以进入容器内部,ctrl+p+q可以以后台运行的方式退出这个软件</p><p>docker exec -it 容器的id /bin/bash</p><p>连接服务器上的mysql</p><p>执行我提供的sql脚本就好了</p><p>执行成功</p><p>将springboot项目打成jar包<br>将applicayion.yml中的url中的localhost改成你服务器的公网ip，还有将密码改成你服务器上mysql的密码</p><p>打包的命令有两个，mvn clean ,mvn package</p><p>在target文件夹出现jar表示成功</p><h5 id="编写Dockfile文件"><a href="#编写Dockfile文件" class="headerlink" title="编写Dockfile文件"></a>编写Dockfile文件</h5><p>将springboot jar包项目打包成Docker镜像</p><p>在 /home 目录下创建docker文件夹</p><p>mkdir /home/docker<br>使用xftp上传jar包</p><p>编写Dockerfile文件</p><p>vim Dockerfile</p><p>完整命令, vim的使用方法：点击i开始编写，编写完后点击esc，点击冒号，输入wq保存</p><figure class="highlight plain"><table><tbody><tr><td class="code"><pre><span class="line">FROM java:8</span><br><span class="line">ADD blog-0.0.1-SNAPSHOT.jar /blog.jar</span><br><span class="line">EXPOSE 8080</span><br><span class="line">ENTRYPOINT ["java","-jar","/blog.jar"]</span><br></pre></td></tr></tbody></table></figure><p>解释</p><p>#注意，docker命令全部大写，这是规定。</p><figure class="highlight plain"><table><tbody><tr><td class="code"><pre><span class="line">#注意，docker命令全部大写，这是规定。</span><br><span class="line">#   From 关键字表示，jar包依赖的环境。java:8  相当于jdk1.8</span><br><span class="line">FROM java:8</span><br><span class="line"> </span><br><span class="line">#ADD命令 </span><br><span class="line">#   blog-0.0.1-SNAPSHOT.jar：这是你上传jar包的名称。</span><br><span class="line">#   /blog.jar：这是自定义的名称。但是注意要有之前的/</span><br><span class="line">ADD blog-0.0.1-SNAPSHOT.jar /blog.jar</span><br><span class="line"> </span><br><span class="line">#MAINTAINER  作者名称。可以删除不写。</span><br><span class="line">MAINTAINER zhangxiaosan</span><br><span class="line"> </span><br><span class="line">#EXPOSE 项目暴露的端口号</span><br><span class="line">EXPOSE 8080</span><br><span class="line"> </span><br><span class="line">#/blog.jar此处的名称要和ADD命令后面的一样。</span><br><span class="line">ENTRYPOINT ["java","-jar","/blog.jar"]</span><br></pre></td></tr></tbody></table></figure><p>在docker文件夹下执行如下命令</p><p>docker build -t blog:1.0 .</p><p>说明:<br>blog 代表要打包成的镜像名称。按照自己实际情况写。<br>:1.0 代表版本号，可以不写则默认为latest<br>. 代表为当前目录。这就是为什么一直在步骤一文件夹中进行操作,并且Dockerfile在此文件夹中的原因。</p><p>若之前Dockerfile不在步骤一的文件夹中 则需要指定到对应的地址。</p><p>接下来用docker images 就可以查看到这个镜像已经被创建好了，接下来运行这个镜像就可以了</p><p>docker run –name blog -d -p 80:8080 blog:1.0</p><p>此时就可以用你的公网ip访问了，我绑定了域名，可以用域名访问。</p><p>还有个命令要提下，可以查看容器运行时的日志</p><p>docker logs 容器id</p><!-- rebuild by neat --></body></html>]]></content>
      <categories>
        <category>服务器</category>
      </categories>
      <tags>
        <tag>linux</tag>
        <tag>mysql</tag>
        <tag>docker</tag>
      </tags>
  </entry>
  <entry>
    <title>聊一聊微服务（上）</title>
    <url>/service1/28/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><!-- build time:Sat May 22 2021 19:59:12 GMT+0800 (GMT+08:00) --><html><head></head><body><img class="st" src="https://i.loli.net/2020/05/06/3POFgbz5awRUc1X.jpg"><a id="more"></a><h2 id="一、为什么需要微服务"><a href="#一、为什么需要微服务" class="headerlink" title="一、为什么需要微服务"></a>一、为什么需要微服务</h2><p>​ 传统开发模式下，绝大部分的Web应用都是采用单体架构的风格来进行构建的，这意味着Web应用是作为单个可部署的软件制品进行交付的，所有的接口、业务逻辑、持久层都被打包在一个Web应用中，并且部署在一台服务器上，这种开发模式会带来诸多不便，多团队协同开发的成本极高。</p><h4 id="1-传统开发方式（单体应用）"><a href="#1-传统开发方式（单体应用）" class="headerlink" title="1.传统开发方式（单体应用）"></a>1.传统开发方式（单体应用）</h4><p>​ <img src="https://i.loli.net/2020/08/05/uYwBWmMzkfn2pGE.jpg" alt></p><ul><li><p>单体应用存在的问题</p><p>1.1随着业务的发展，开发变得越来越复杂。<br>1.2修改、新增某个功能，需要对整个系统进行测试、重新部署。<br>1.3一个模块出现问题，很可能导致整个系统崩溃。<br>1.4多个开发团队同时对数据进行管理，容易产生安全漏洞。<br>1.5各个模块使用同-种技术进行开发，各个模块很难根据实际情况选择更合适的技术框架，局限性很大。<br>1.6模块内容过于复杂，如果员工离职，可能需要很长时间才能完成工作交接。</p></li></ul><h4 id="2-微服务架构"><a href="#2-微服务架构" class="headerlink" title="2.微服务架构"></a>2.微服务架构</h4><p><img src="https://i.loli.net/2020/05/06/vKcjUR7MfYlsh6p.png" alt="1588405762151"></p><p><img src="https://i.loli.net/2020/05/06/DomQ9we1P4lVivH.png" alt="1588410701854"></p><h4 id="3-分布式、集群"><a href="#3-分布式、集群" class="headerlink" title="3.分布式、集群"></a>3.分布式、集群</h4><ul><li>集群:一台服务器无法负荷高并发的数据访问量，那么就设置十台服务器-起分担压力， 十台不行就设置一百台(物理层面)。很多人干同-件事情，来分摊压力。</li><li>分布式:将一个复杂问题拆分成若干个简单的小问题，将一个大型的项目架构拆分成若干个微服务来协同完成(软件设计层面)。将一 个庞大的工作拆分成若干个小步骤，分别由不同的人完成这些小步骤，最终将所有的结果进行整合实现大的需求。</li></ul><h4 id="4-微服务优点"><a href="#4-微服务优点" class="headerlink" title="4.微服务优点"></a>4.微服务优点</h4><ul><li>各个服务的开发、测试、部署都相互独立，比如用户服务就可以拆分作为<br>一个单独的服务，而它的开发也不用依赖于其他服务，如果用户量很大，<br>我们可以很容易的对其进行负载。</li><li>当一个新需求出现时，特别是在一一个庞大的项目系统中，你得去考虑各方<br>的问题，兼容性、影响度等等，而使用微服务则可以直接跳过这些废时又<br>烧脑的环节。</li><li>使用微服务将项目进行拆分之后，各服务之间就消除了诸多限制，只需要<br>保证对外提供的接口正常可用，至于使用什么语言、什么框架通通不用关<br>心。</li></ul><h4 id="5-微服务的缺点"><a href="#5-微服务的缺点" class="headerlink" title="5.微服务的缺点"></a>5.微服务的缺点</h4><ul><li>上面我们提到微服务的拆分是基于业务的，不是我们随心所欲，想怎么拆<br>就怎么拆的，那么问题来了，由谁来拆，怎么拆?这就给团队协作沟通带<br>来了很多挑战。</li><li>当服务调用方需要使用某服务的接口时，首先需要找到该服务的提供方，<br>通常在一一个大公司中，这种场景是跨部门的，沟通成本可想而知。同时，<br>如果服务的提供方需要对某个接口进行修改，也得和各个服务调用方进行<br>沟通。</li><li>由于各个服务相互独立，它们的数据也是独立的，这就会带来-一个问题，<br>当调用多个服务接口来进行操作时，如何保证各个服务的数据- -致性，这<br>既是问题，也是难点。</li></ul><h4 id="6-微服务框架对比"><a href="#6-微服务框架对比" class="headerlink" title="6.微服务框架对比"></a>6.微服务框架对比</h4><p><img src="https://i.loli.net/2020/05/06/7GStEnpLFIkogUa.png" alt="1588407091660"></p><h2 id="二、为什么是Spring-Cloud"><a href="#二、为什么是Spring-Cloud" class="headerlink" title="二、为什么是Spring  Cloud"></a>二、为什么是Spring Cloud</h2><ul><li>Spring Cloud完全基于Spring Boot,服务调用方式是基于REST API，整合了<br>各种成熟的产品和架构，同时基于Spring Boot也使得整体的开发、配置、<br>部署都非常方便。</li><li>Spring系的产品集功能齐全、简单好用、性能优越、文档规范等等于一身，<br>因此Spring Cloud还是微服务架构中一个十分优越的实现方案。</li></ul><h4 id="1-Spring-Cloud-架构图"><a href="#1-Spring-Cloud-架构图" class="headerlink" title="1.Spring Cloud 架构图"></a>1.Spring Cloud 架构图</h4><p><img src="https://i.loli.net/2020/05/06/NCVnXzK4Ys8P2vM.png" alt="1588407007493"></p><h4 id="2-Spring-Cloud-核心组件"><a href="#2-Spring-Cloud-核心组件" class="headerlink" title="2.Spring Cloud 核心组件"></a>2.Spring Cloud 核心组件</h4><p><img src="https://i.loli.net/2020/05/06/EDZmTWs92OdBqV4.png" alt="1588692487250"></p><ul><li><p>服务治理的核心又三部分组成:服务提供者、服务消费者、注册中心。</p><p><img src="https://i.loli.net/2020/05/06/3B4PY8v9DnJswoS.png" alt="1588419323735"></p><ul><li>在分布式系统架构中，每个微服务在启动时，将自己的信息存储在注册中心，叫做服务注册。</li><li>服务消费者从注册中心获取服务提供者的网络信息，通过该信息调用服务,叫做服务发现。</li><li>Spring Cloud的服务治理使用Eureka来实现，Eureka 是Netflix开源的基于REST的服务治理解决方案，SpringCloud集成了Eureka, 提供服务注册和服务发现的功能，可以和基于Spring Boot搭建的微服务应用轻松完成整合，开箱即用(Spring Cloud Eureka)。</li></ul></li></ul><h4 id="3-Spring-Cloud-Eureka"><a href="#3-Spring-Cloud-Eureka" class="headerlink" title="3.Spring Cloud Eureka"></a>3.Spring Cloud Eureka</h4><ul><li>Eureka Server：注册中心</li><li>Eureka Client：所有要进行注册的微服务通过Eureka Client连接到Eureka Server完成注册（相当于服务消费者和服务提供者都要集成Eureka Client然后把服务注册到Eureka Server中）。</li></ul><h2 id="三、Eureka-Server代码实现"><a href="#三、Eureka-Server代码实现" class="headerlink" title="三、Eureka Server代码实现"></a>三、Eureka Server代码实现</h2><h4 id="1-新建项目名为springcloud的Maven父工程"><a href="#1-新建项目名为springcloud的Maven父工程" class="headerlink" title="1.新建项目名为springcloud的Maven父工程"></a>1.新建项目名为springcloud的Maven父工程</h4><ul><li><p>父工程pom.xml配置</p><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta"><?xml version="1.0" encoding="UTF-8"?></span></span><br><span class="line"><span class="tag"><<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">"http://maven.apache.org/POM/4.0.0"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span>></span></span><br><span class="line">  <span class="tag"><<span class="name">modelVersion</span>></span>4.0.0<span class="tag"></<span class="name">modelVersion</span>></span></span><br><span class="line">  <span class="tag"><<span class="name">groupId</span>></span>org.example<span class="tag"></<span class="name">groupId</span>></span></span><br><span class="line">  <span class="tag"><<span class="name">artifactId</span>></span>springcloud<span class="tag"></<span class="name">artifactId</span>></span></span><br><span class="line">  <span class="tag"><<span class="name">version</span>></span>1.0-SNAPSHOT<span class="tag"></<span class="name">version</span>></span></span><br><span class="line">  <span class="comment"><!--springboot父依赖--></span></span><br><span class="line">  <span class="tag"><<span class="name">parent</span>></span></span><br><span class="line">    <span class="tag"><<span class="name">groupId</span>></span>org.springframework.boot<span class="tag"></<span class="name">groupId</span>></span></span><br><span class="line">    <span class="tag"><<span class="name">artifactId</span>></span>spring-boot-starter-parent<span class="tag"></<span class="name">artifactId</span>></span></span><br><span class="line">    <span class="tag"><<span class="name">version</span>></span>2.0.6.RELEASE<span class="tag"></<span class="name">version</span>></span></span><br><span class="line">  <span class="tag"></<span class="name">parent</span>></span></span><br><span class="line">  <span class="tag"><<span class="name">dependencies</span>></span></span><br><span class="line">    <span class="comment"><!--web依赖--></span></span><br><span class="line">    <span class="tag"><<span class="name">dependency</span>></span></span><br><span class="line">      <span class="tag"><<span class="name">groupId</span>></span>org.springframework.boot<span class="tag"></<span class="name">groupId</span>></span></span><br><span class="line">      <span class="tag"><<span class="name">artifactId</span>></span>spring-boot-starter-web<span class="tag"></<span class="name">artifactId</span>></span></span><br><span class="line">    <span class="tag"></<span class="name">dependency</span>></span></span><br><span class="line"></span><br><span class="line">    <span class="comment"><!--lombok--></span></span><br><span class="line">    <span class="tag"><<span class="name">dependency</span>></span></span><br><span class="line">      <span class="tag"><<span class="name">groupId</span>></span>org.projectlombok<span class="tag"></<span class="name">groupId</span>></span></span><br><span class="line">      <span class="tag"><<span class="name">artifactId</span>></span>lombok<span class="tag"></<span class="name">artifactId</span>></span></span><br><span class="line">      <span class="tag"><<span class="name">optional</span>></span>true<span class="tag"></<span class="name">optional</span>></span></span><br><span class="line">    <span class="tag"></<span class="name">dependency</span>></span></span><br><span class="line"></span><br><span class="line">    <span class="comment"><!--解决JDK9以上没有JAXB API的问题需加入以下四个依赖，9以下可以不加--></span></span><br><span class="line">    <span class="comment"><!--</span></span><br><span class="line"><span class="comment">        <dependency></span></span><br><span class="line"><span class="comment">            <groupId>javax.xml.bind</groupId></span></span><br><span class="line"><span class="comment">            <artifactId>jaxb-api</artifactId></span></span><br><span class="line"><span class="comment">            <version>2.3.0</version></span></span><br><span class="line"><span class="comment">        </dependency></span></span><br><span class="line"><span class="comment">        <dependency></span></span><br><span class="line"><span class="comment">            <groupId>com.sun.xml.bind</groupId></span></span><br><span class="line"><span class="comment">            <artifactId>jaxb-impl</artifactId></span></span><br><span class="line"><span class="comment">            <version>2.3.0</version></span></span><br><span class="line"><span class="comment">        </dependency></span></span><br><span class="line"><span class="comment">        <dependency></span></span><br><span class="line"><span class="comment">            <groupId>com.sun.xml.bind</groupId></span></span><br><span class="line"><span class="comment">            <artifactId>jaxb-core</artifactId></span></span><br><span class="line"><span class="comment">            <version>2.3.0</version></span></span><br><span class="line"><span class="comment">        </dependency></span></span><br><span class="line"><span class="comment">        <dependency></span></span><br><span class="line"><span class="comment">            <groupId>javax.activation</groupId></span></span><br><span class="line"><span class="comment">            <artifactId>activation</artifactId></span></span><br><span class="line"><span class="comment">            <version>1.1.1</version></span></span><br><span class="line"><span class="comment">        </dependency></span></span><br><span class="line"><span class="comment">        --></span></span><br><span class="line">  <span class="tag"></<span class="name">dependencies</span>></span></span><br><span class="line">  <span class="comment"><!--springCloud依赖--></span></span><br><span class="line">  <span class="tag"><<span class="name">dependencyManagement</span>></span></span><br><span class="line">    <span class="tag"><<span class="name">dependencies</span>></span></span><br><span class="line">      <span class="tag"><<span class="name">dependency</span>></span></span><br><span class="line">        <span class="tag"><<span class="name">groupId</span>></span>org.springframework.cloud<span class="tag"></<span class="name">groupId</span>></span></span><br><span class="line">        <span class="tag"><<span class="name">artifactId</span>></span>spring-cloud-dependencies<span class="tag"></<span class="name">artifactId</span>></span></span><br><span class="line">        <span class="tag"><<span class="name">version</span>></span>Finchley.SR2<span class="tag"></<span class="name">version</span>></span></span><br><span class="line">        <span class="tag"><<span class="name">type</span>></span>pom<span class="tag"></<span class="name">type</span>></span></span><br><span class="line">        <span class="tag"><<span class="name">scope</span>></span>import<span class="tag"></<span class="name">scope</span>></span></span><br><span class="line">      <span class="tag"></<span class="name">dependency</span>></span></span><br><span class="line">    <span class="tag"></<span class="name">dependencies</span>></span></span><br><span class="line">  <span class="tag"></<span class="name">dependencyManagement</span>></span></span><br><span class="line"><span class="tag"></<span class="name">project</span>></span></span><br></pre></td></tr></tbody></table></figure><h4 id="2-在父工程下创建名为eurekaserver的模块（Module）即注册中心"><a href="#2-在父工程下创建名为eurekaserver的模块（Module）即注册中心" class="headerlink" title="2.在父工程下创建名为eurekaserver的模块（Module）即注册中心"></a>2.在父工程下创建名为eurekaserver的模块（Module）即注册中心</h4></li><li><p>eurekaserver模块下pom.xml配置</p></li></ul><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta"><?xml version="1.0" encoding="UTF-8"?></span></span><br><span class="line"><span class="tag"><<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">"http://maven.apache.org/POM/4.0.0"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span>></span></span><br><span class="line">    <span class="tag"><<span class="name">parent</span>></span></span><br><span class="line">        <span class="tag"><<span class="name">artifactId</span>></span>springcloud<span class="tag"></<span class="name">artifactId</span>></span></span><br><span class="line">        <span class="tag"><<span class="name">groupId</span>></span>org.example<span class="tag"></<span class="name">groupId</span>></span></span><br><span class="line">        <span class="tag"><<span class="name">version</span>></span>1.0-SNAPSHOT<span class="tag"></<span class="name">version</span>></span></span><br><span class="line">    <span class="tag"></<span class="name">parent</span>></span></span><br><span class="line">    <span class="tag"><<span class="name">modelVersion</span>></span>4.0.0<span class="tag"></<span class="name">modelVersion</span>></span></span><br><span class="line"></span><br><span class="line">    <span class="tag"><<span class="name">artifactId</span>></span>eurekaserver<span class="tag"></<span class="name">artifactId</span>></span></span><br><span class="line"></span><br><span class="line">    <span class="comment"><!--需要导入的注册中心组件--></span></span><br><span class="line">    <span class="tag"><<span class="name">dependencies</span>></span></span><br><span class="line">        <span class="tag"><<span class="name">dependency</span>></span></span><br><span class="line">            <span class="tag"><<span class="name">groupId</span>></span>org.springframework.cloud<span class="tag"></<span class="name">groupId</span>></span></span><br><span class="line">            <span class="tag"><<span class="name">artifactId</span>></span>spring-cloud-starter-netflix-eureka-server<span class="tag"></<span class="name">artifactId</span>></span></span><br><span class="line">            <span class="tag"><<span class="name">version</span>></span>2.0.2.RELEASE<span class="tag"></<span class="name">version</span>></span></span><br><span class="line">        <span class="tag"></<span class="name">dependency</span>></span></span><br><span class="line">    <span class="tag"></<span class="name">dependencies</span>></span></span><br><span class="line"></span><br><span class="line"><span class="tag"></<span class="name">project</span>></span></span><br></pre></td></tr></tbody></table></figure><h4 id="3-在包eurekaserver-src-main-resource下创建配置文件application-yml，添加Eureka-Server相关的配置"><a href="#3-在包eurekaserver-src-main-resource下创建配置文件application-yml，添加Eureka-Server相关的配置" class="headerlink" title="3.在包eurekaserver.src.main.resource下创建配置文件application.yml，添加Eureka Server相关的配置"></a>3.在包eurekaserver.src.main.resource下创建配置文件application.yml，添加Eureka Server相关的配置</h4><figure class="highlight yaml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">#Eureka Server服务端口号随便配置</span></span><br><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">8761</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#eureka.register-with-eureka: 是否将当前的Eureka Server服务作为客户端进行注册</span></span><br><span class="line"><span class="attr">eureka:</span></span><br><span class="line">  <span class="attr">client:</span></span><br><span class="line">    <span class="comment">#是否要注册自己</span></span><br><span class="line">    <span class="attr">register-with-eureka:</span> <span class="literal">false</span></span><br><span class="line">    <span class="comment">#是否要同步其他注册中心（EurekaServer）的数据</span></span><br><span class="line">    <span class="attr">fetch-registry:</span> <span class="literal">false</span></span><br><span class="line">    <span class="comment">#注册中心的访问路径</span></span><br><span class="line">    <span class="attr">service-url:</span></span><br><span class="line">      <span class="attr">defaultZone:</span> <span class="string">http://localhost:8761/eureka/</span></span><br></pre></td></tr></tbody></table></figure><h4 id="4-在包eurekaserver-src-main创建包org-example（根据自己的创建），springboot启动类"><a href="#4-在包eurekaserver-src-main创建包org-example（根据自己的创建），springboot启动类" class="headerlink" title="4.在包eurekaserver.src.main创建包org.example（根据自己的创建），springboot启动类"></a>4.在包eurekaserver.src.main创建包org.example（根据自己的创建），springboot启动类</h4><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> org.example;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.SpringApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.cloud.netflix.eureka.server.EnableEurekaServer;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@EnableEurekaServer</span>   <span class="comment">//声明该类是一个EurekaServer微服务,提供服务注册和服务发现功能，即注册中心</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">EurekaServerApplication</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>{</span><br><span class="line">        SpringApplication.run(EurekaServerApplication<span class="class">.<span class="keyword">class</span>,<span class="title">args</span>)</span>;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><h4 id="5-启动微服务显示页面（http-localhost-8761）"><a href="#5-启动微服务显示页面（http-localhost-8761）" class="headerlink" title="5.启动微服务显示页面（http://localhost:8761）"></a>5.启动微服务显示页面（<a href="http://localhost:8761）">http://localhost:8761）</a></h4><p><img src="https://i.loli.net/2020/05/06/4IFTmzpWwDtuLHU.png" alt="1588420890055"></p><h2 id="四、Eureka-Client代码实现"><a href="#四、Eureka-Client代码实现" class="headerlink" title="四、Eureka Client代码实现"></a>四、Eureka Client代码实现</h2><h4 id="1-在父工程下创建子模块eurekaclient"><a href="#1-在父工程下创建子模块eurekaclient" class="headerlink" title="1.在父工程下创建子模块eurekaclient"></a>1.在父工程下创建子模块eurekaclient</h4><ul><li>eurekaclient子模块下pom.xml配置</li></ul><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta"><?xml version="1.0" encoding="UTF-8"?></span></span><br><span class="line"><span class="tag"><<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">"http://maven.apache.org/POM/4.0.0"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span>></span></span><br><span class="line">    <span class="tag"><<span class="name">parent</span>></span></span><br><span class="line">        <span class="tag"><<span class="name">artifactId</span>></span>springcloud<span class="tag"></<span class="name">artifactId</span>></span></span><br><span class="line">        <span class="tag"><<span class="name">groupId</span>></span>org.example<span class="tag"></<span class="name">groupId</span>></span></span><br><span class="line">        <span class="tag"><<span class="name">version</span>></span>1.0-SNAPSHOT<span class="tag"></<span class="name">version</span>></span></span><br><span class="line">    <span class="tag"></<span class="name">parent</span>></span></span><br><span class="line">    <span class="tag"><<span class="name">modelVersion</span>></span>4.0.0<span class="tag"></<span class="name">modelVersion</span>></span></span><br><span class="line"></span><br><span class="line">    <span class="tag"><<span class="name">artifactId</span>></span>eurekaclient<span class="tag"></<span class="name">artifactId</span>></span></span><br><span class="line"></span><br><span class="line">    <span class="comment"><!--所需的eureka-client依赖--></span></span><br><span class="line">    <span class="tag"><<span class="name">dependencies</span>></span></span><br><span class="line">        <span class="tag"><<span class="name">dependency</span>></span></span><br><span class="line">            <span class="tag"><<span class="name">groupId</span>></span>org.springframework.cloud<span class="tag"></<span class="name">groupId</span>></span></span><br><span class="line">            <span class="tag"><<span class="name">artifactId</span>></span>spring-cloud-starter-netflix-eureka-client<span class="tag"></<span class="name">artifactId</span>></span></span><br><span class="line">            <span class="tag"><<span class="name">version</span>></span>2.0.2.RELEASE<span class="tag"></<span class="name">version</span>></span></span><br><span class="line">        <span class="tag"></<span class="name">dependency</span>></span></span><br><span class="line">    <span class="tag"></<span class="name">dependencies</span>></span></span><br><span class="line"><span class="tag"></<span class="name">project</span>></span></span><br></pre></td></tr></tbody></table></figure><h4 id="2-在包eurekaclient-src-main-resource下创建配置文件application-yml，添加Eureka-Client相关的配置"><a href="#2-在包eurekaclient-src-main-resource下创建配置文件application-yml，添加Eureka-Client相关的配置" class="headerlink" title="2.在包eurekaclient.src.main.resource下创建配置文件application.yml，添加Eureka Client相关的配置"></a>2.在包eurekaclient.src.main.resource下创建配置文件application.yml，添加Eureka Client相关的配置</h4><figure class="highlight yaml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">#端口随便配置</span></span><br><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">8010</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#当前服务注册在Eureka Server上的名称，后面可以直接通过名字访问</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">provider</span>  <span class="comment">#假设是服务提供者</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#将注册中心的地址配置过来（注册中心访问地址）</span></span><br><span class="line"><span class="attr">eureka:</span></span><br><span class="line">  <span class="attr">client:</span></span><br><span class="line">    <span class="attr">service-url:</span></span><br><span class="line">      <span class="attr">defaultZone:</span> <span class="string">http://localhost:8761/eureka/</span></span><br><span class="line">  <span class="attr">instance:</span></span><br><span class="line">    <span class="attr">prefer-ip-address:</span> <span class="literal">true</span> <span class="comment">#是否将当前服务的ip注册到EurekaServer</span></span><br></pre></td></tr></tbody></table></figure><h4 id="3-在包eurekaclient-src-main创建包org-example（根据自己的创建），springboot启动类"><a href="#3-在包eurekaclient-src-main创建包org-example（根据自己的创建），springboot启动类" class="headerlink" title="3.在包eurekaclient.src.main创建包org.example（根据自己的创建），springboot启动类"></a>3.在包eurekaclient.src.main创建包org.example（根据自己的创建），springboot启动类</h4><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> org.example;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.SpringApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProviderApplication</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>{</span><br><span class="line">        SpringApplication.run(ProviderApplication<span class="class">.<span class="keyword">class</span>,<span class="title">args</span>)</span>;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>4.将服务提供者注册到注册中心，首先启动EurekaServerApplication（注册中心），再启动ProviderApplication（服务提供者），再浏览器地址栏输入注册中心地址：<a href="http://localhost:8761/，显示页面如下：" target="_blank" rel="noopener">http://localhost:8761/，显示页面如下：</a></p><p><img src="https://i.loli.net/2020/05/06/CH9uEU1BVfIWw3x.png" alt="1588427608086"></p><ul><li>如果没有出现如图的情况，查看一下eurekaclient或者eurekaserver的pom.xml依赖，注意不要把eurekaclient的依赖写成spring-cloud-netflix-eureka-client，请仔细观察</li></ul><p>5.我们可以理解为每个服务提供者就充当一个一个的功能模块。这里基于eurekaclient（服务提供者）写个小业务便于理解，首先在eurekaclint(eurekaclient.src.main.java.org.example)目录下分别创建dao层，entity,controller层，这里省略service层</p><ul><li><p>entity</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> org.example.entity;</span><br><span class="line"><span class="keyword">import</span> lombok.AllArgsConstructor;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"><span class="keyword">import</span> lombok.NoArgsConstructor;</span><br><span class="line"></span><br><span class="line"><span class="comment">//使用lombok需要下载lombok插件</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>{</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">long</span> id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></li><li><p>Dao层接口</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> org.example.dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.example.entity.Student;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Collection;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">StudentRepository</span> </span>{</span><br><span class="line">    <span class="comment">//查找</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Collection<Student> <span class="title">findAll</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="comment">//查找</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Student <span class="title">findById</span><span class="params">(<span class="keyword">long</span> id)</span></span>;</span><br><span class="line">    <span class="comment">//添加或修改</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">saveOrUpdate</span><span class="params">(Student student)</span></span>;</span><br><span class="line">    <span class="comment">//删除</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">deleteById</span><span class="params">(<span class="keyword">long</span> id)</span></span>;</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></li><li><p>Dao层实现类</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> org.example.dao.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.example.dao.StudentRepository;</span><br><span class="line"><span class="keyword">import</span> org.example.entity.Student;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Repository;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestBody;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Collection;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Repository</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StudentRepositoryImpl</span> <span class="keyword">implements</span> <span class="title">StudentRepository</span> </span>{</span><br><span class="line"></span><br><span class="line">    <span class="comment">//向Map集合添加数据</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Map<Long, Student> studentMap;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> {</span><br><span class="line">        studentMap = <span class="keyword">new</span> HashMap<>();</span><br><span class="line">        studentMap.put(<span class="number">1L</span>, <span class="keyword">new</span> Student(<span class="number">1L</span>, <span class="string">"刘备"</span>, <span class="number">24</span>));</span><br><span class="line">        studentMap.put(<span class="number">3L</span>, <span class="keyword">new</span> Student(<span class="number">3L</span>, <span class="string">"关羽"</span>, <span class="number">23</span>));</span><br><span class="line">        studentMap.put(<span class="number">2L</span>, <span class="keyword">new</span> Student(<span class="number">2L</span>, <span class="string">"张飞"</span>, <span class="number">22</span>));</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Collection<Student> <span class="title">findAll</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span>  studentMap.values();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Student <span class="title">findById</span><span class="params">(<span class="keyword">long</span> id)</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> studentMap.get(id);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">saveOrUpdate</span><span class="params">(Student student)</span> </span>{</span><br><span class="line">        studentMap.put(student.getId(), student);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">deleteById</span><span class="params">(<span class="keyword">long</span> id)</span> </span>{</span><br><span class="line">        studentMap.remove(id);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></li><li><p>Controller层</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> org.example.controller;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.example.dao.StudentRepository;</span><br><span class="line"><span class="keyword">import</span> org.example.entity.Student;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.*;</span><br><span class="line"><span class="keyword">import</span> java.util.Collection;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/student"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StudentController</span> </span>{</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> StudentRepository studentRepository;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping</span>(<span class="string">"/findAll"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Collection<Student> <span class="title">findAll</span><span class="params">()</span></span>{</span><br><span class="line">        <span class="keyword">return</span> studentRepository.findAll();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping</span>(<span class="string">"/findById/{id}"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Student <span class="title">findById</span><span class="params">(@PathVariable(<span class="string">"id"</span>)</span> <span class="keyword">long</span> id)</span>{</span><br><span class="line">        <span class="keyword">return</span> studentRepository.findById(id);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@PostMapping</span>(<span class="string">"/save"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">save</span><span class="params">(@RequestBody Student student)</span></span>{</span><br><span class="line">        studentRepository.saveOrUpdate(student);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@PutMapping</span>(<span class="string">"/update"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">(@RequestBody Student student)</span></span>{</span><br><span class="line">        studentRepository.saveOrUpdate(student);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@DeleteMapping</span>(<span class="string">"/deleteById/{id}"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">deleteById</span><span class="params">(@PathVariable(<span class="string">"id"</span>)</span> <span class="keyword">long</span> id)</span>{</span><br><span class="line">        studentRepository.deleteById(id);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></li><li><p>整体项目结构</p><p><img src="https://i.loli.net/2020/05/06/GEnmQBMLfdPXjvS.png" alt="1588435093112"></p></li><li><p>测试eurekaclient功能模块</p><p>浏览器输入：<a href="http://localhost:8010/student/findAll测试我们刚刚写的查询学生方法，其他接口自行测试，返回结果：" target="_blank" rel="noopener">http://localhost:8010/student/findAll测试我们刚刚写的查询学生方法，其他接口自行测试，返回结果：</a></p><figure class="highlight json"><table><tbody><tr><td class="code"><pre><span class="line">[{<span class="attr">"id"</span>:<span class="number">1</span>,<span class="attr">"name"</span>:<span class="string">"刘备"</span>,<span class="attr">"age"</span>:<span class="number">24</span>},{<span class="attr">"id"</span>:<span class="number">2</span>,<span class="attr">"name"</span>:<span class="string">"张飞"</span>,<span class="attr">"age"</span>:<span class="number">22</span>},{<span class="attr">"id"</span>:<span class="number">3</span>,<span class="attr">"name"</span>:<span class="string">"关羽"</span>,<span class="attr">"age"</span>:<span class="number">23</span>}]</span><br></pre></td></tr></tbody></table></figure></li></ul><h2 id="五、RestTemplate组件的使用"><a href="#五、RestTemplate组件的使用" class="headerlink" title="五、RestTemplate组件的使用"></a>五、RestTemplate组件的使用</h2><h4 id="1-什么是RestTemplate"><a href="#1-什么是RestTemplate" class="headerlink" title="1.什么是RestTemplate?"></a>1.什么是RestTemplate?</h4><p>RestTemplate是Spring框架提供的基于REST的服务组件，底层是对HTTP请求及响应进行了封装，提供了很多访问RETS服务的方法，可以简化代码开发。根据上面我们知道的，既然是微服务，那么eurekaclient模块与另外一个模块之间是又是怎么调用的呢？没错就是通过RestTemplate组件来实现的模块与模块之间的调用，这样以来我们就可以通过RestTemplate来调用eurekaclient模块。</p><h4 id="2-RestTemplate的使用"><a href="#2-RestTemplate的使用" class="headerlink" title="2.RestTemplate的使用"></a>2.RestTemplate的使用</h4><ul><li><p>在父工程下创建resttemplate模块（maven）,pom.xml配置</p><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta"><?xml version="1.0" encoding="UTF-8"?></span></span><br><span class="line"><span class="tag"><<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">"http://maven.apache.org/POM/4.0.0"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span>></span></span><br><span class="line">    <span class="tag"><<span class="name">parent</span>></span></span><br><span class="line">        <span class="tag"><<span class="name">artifactId</span>></span>springcloud<span class="tag"></<span class="name">artifactId</span>></span></span><br><span class="line">        <span class="tag"><<span class="name">groupId</span>></span>org.example<span class="tag"></<span class="name">groupId</span>></span></span><br><span class="line">        <span class="tag"><<span class="name">version</span>></span>1.0-SNAPSHOT<span class="tag"></<span class="name">version</span>></span></span><br><span class="line">    <span class="tag"></<span class="name">parent</span>></span></span><br><span class="line">    <span class="tag"><<span class="name">modelVersion</span>></span>4.0.0<span class="tag"></<span class="name">modelVersion</span>></span></span><br><span class="line"></span><br><span class="line">    <span class="tag"><<span class="name">artifactId</span>></span>resttemplate<span class="tag"></<span class="name">artifactId</span>></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="tag"></<span class="name">project</span>></span></span><br></pre></td></tr></tbody></table></figure></li><li><p>创建调用另外一个模块所需的实体类</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> org.example.entity;</span><br><span class="line"><span class="keyword">import</span> lombok.AllArgsConstructor;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"><span class="keyword">import</span> lombok.NoArgsConstructor;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>{</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">long</span> id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></li><li><p>springboot启动类</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> org.example;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.SpringApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.client.RestTemplate;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RestTemplateApplication</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>{</span><br><span class="line">        SpringApplication.run(RestTemplateApplication<span class="class">.<span class="keyword">class</span>,<span class="title">args</span>)</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">//提供RestTemplate实例将其添加到ioc容器</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> RestTemplate <span class="title">restTemplate</span><span class="params">()</span></span>{</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> RestTemplate();</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></li><li><p>编写Controller层</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> org.example.controller;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.example.entity.Student;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.*;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.client.RestTemplate;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Collection;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/rest"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RestTmpController</span> </span>{</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> RestTemplate restTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     * 调用eurekaclient模块下的Controller里面的接口</span></span><br><span class="line"><span class="comment">     * getForEntity中的的get为GET请求,参数一：要调用的地址 参数二：结果集</span></span><br><span class="line"><span class="comment">     * restTemplate.getForEntity().getBody()作用与restTemplate.getForObject（）作用相同</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@GetMapping</span>(<span class="string">"/findAllR"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Collection<Student> <span class="title">findAll</span><span class="params">()</span></span>{</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span>  restTemplate.getForEntity(</span><br><span class="line">            <span class="string">"http://localhost:8010/student/findAll"</span>,                                  Collection<span class="class">.<span class="keyword">class</span>).<span class="title">getBody</span>()</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping</span>(<span class="string">"/findAllR2"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Collection<Student> <span class="title">findAll2</span><span class="params">()</span></span>{</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> restTemplate.getForObject(<span class="string">"http://localhost:8010/student/findAll"</span>,Collection<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">//根据id查询</span></span><br><span class="line">    <span class="meta">@GetMapping</span>(<span class="string">"/findById/{id}"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Student <span class="title">findById</span><span class="params">(@PathVariable(<span class="string">"id"</span>)</span> <span class="keyword">long</span> id)</span>{</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> restTemplate.getForEntity(<span class="string">"http://localhost:8010/student/findById/"</span>,Student<span class="class">.<span class="keyword">class</span>,<span class="title">id</span>).<span class="title">getBody</span>()</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping</span>(<span class="string">"/findById2/{id}"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Student <span class="title">findById2</span><span class="params">(@PathVariable(<span class="string">"id"</span>)</span> <span class="keyword">long</span> id)</span>{</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> restTemplate.getForObject(<span class="string">"http://localhost:8010/student/findById/"</span>,Student<span class="class">.<span class="keyword">class</span>,<span class="title">id</span>)</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//查询</span></span><br><span class="line">    <span class="meta">@PostMapping</span>(<span class="string">"/save"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">save</span><span class="params">(@RequestBody Student student)</span></span>{</span><br><span class="line"></span><br><span class="line">        restTemplate.postForEntity(<span class="string">"http://localhost:8010/student/save"</span>,student,<span class="keyword">null</span>).getBody();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping</span>(<span class="string">"/save2"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">save2</span><span class="params">(@RequestBody Student student)</span></span>{</span><br><span class="line"></span><br><span class="line">        restTemplate.postForObject(<span class="string">"http://localhost:8010/student/save"</span>,student,<span class="keyword">null</span>);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">//修改</span></span><br><span class="line">    <span class="meta">@PutMapping</span>(<span class="string">"/update"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">(@RequestBody Student student)</span></span>{</span><br><span class="line">        restTemplate.put(<span class="string">"http://localhost:8010/student/update"</span>,student);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">//删除</span></span><br><span class="line">    <span class="meta">@DeleteMapping</span>(<span class="string">"//deleteById/{id}"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">(@PathVariable(<span class="string">"id"</span>)</span> <span class="keyword">long</span> id)</span>{</span><br><span class="line">        restTemplate.delete(<span class="string">"http://localhost:8010/student/update"</span>,id);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></li><li><p>这里没有配置配置文件，所有默认端口号为8080，接着按顺序启动项（eurekaserver注册中心->eurekaclient服务提供者->resttemplate服务消费者）</p></li><li><p>浏览器访问resttemplate地址：<a href="http://localhost:8080/rest/findAllR，显示结果：" target="_blank" rel="noopener">http://localhost:8080/rest/findAllR，显示结果：</a></p><figure class="highlight json"><table><tbody><tr><td class="code"><pre><span class="line">[{<span class="attr">"id"</span>:<span class="number">1</span>,<span class="attr">"name"</span>:<span class="string">"刘备"</span>,<span class="attr">"age"</span>:<span class="number">24</span>},{<span class="attr">"id"</span>:<span class="number">2</span>,<span class="attr">"name"</span>:<span class="string">"张飞"</span>,<span class="attr">"age"</span>:<span class="number">22</span>},{<span class="attr">"id"</span>:<span class="number">3</span>,<span class="attr">"name"</span>:<span class="string">"关羽"</span>,<span class="attr">"age"</span>:<span class="number">23</span>}]</span><br></pre></td></tr></tbody></table></figure><p>这里通过resttemplate消费者里面的findAll方法成功调用了eurekaclient服务提供者的查询方法，其他方法自行测试，注意：resttemplate并不算是严格的服务消费者，因为并没有向注册中心注册,它与服务消费者的区别就是是否向注册中心注册</p></li></ul><h2 id="六、服务消费者Consumer代码实现"><a href="#六、服务消费者Consumer代码实现" class="headerlink" title="六、服务消费者Consumer代码实现"></a>六、服务消费者Consumer代码实现</h2><h4 id="1-在父工程下创建consumer服务消费者模块，pom-xml"><a href="#1-在父工程下创建consumer服务消费者模块，pom-xml" class="headerlink" title="1.在父工程下创建consumer服务消费者模块，pom.xml"></a>1.在父工程下创建consumer服务消费者模块，pom.xml</h4><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta"><?xml version="1.0" encoding="UTF-8"?></span></span><br><span class="line"><span class="tag"><<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">"http://maven.apache.org/POM/4.0.0"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span>></span></span><br><span class="line">    <span class="tag"><<span class="name">parent</span>></span></span><br><span class="line">        <span class="tag"><<span class="name">artifactId</span>></span>springcloud<span class="tag"></<span class="name">artifactId</span>></span></span><br><span class="line">        <span class="tag"><<span class="name">groupId</span>></span>org.example<span class="tag"></<span class="name">groupId</span>></span></span><br><span class="line">        <span class="tag"><<span class="name">version</span>></span>1.0-SNAPSHOT<span class="tag"></<span class="name">version</span>></span></span><br><span class="line">    <span class="tag"></<span class="name">parent</span>></span></span><br><span class="line">    <span class="tag"><<span class="name">modelVersion</span>></span>4.0.0<span class="tag"></<span class="name">modelVersion</span>></span></span><br><span class="line"></span><br><span class="line">    <span class="tag"><<span class="name">artifactId</span>></span>consumer<span class="tag"></<span class="name">artifactId</span>></span></span><br><span class="line"></span><br><span class="line">    <span class="comment"><!--添加依赖--></span></span><br><span class="line">    <span class="tag"><<span class="name">dependencies</span>></span></span><br><span class="line">        <span class="tag"><<span class="name">dependency</span>></span></span><br><span class="line">            <span class="tag"><<span class="name">groupId</span>></span>org.springframework.cloud<span class="tag"></<span class="name">groupId</span>></span></span><br><span class="line">            <span class="tag"><<span class="name">artifactId</span>></span>spring-cloud-starter-netflix-eureka-client<span class="tag"></<span class="name">artifactId</span>></span></span><br><span class="line">            <span class="tag"><<span class="name">version</span>></span>2.0.2.RELEASE<span class="tag"></<span class="name">version</span>></span></span><br><span class="line">        <span class="tag"></<span class="name">dependency</span>></span></span><br><span class="line">    <span class="tag"></<span class="name">dependencies</span>></span></span><br><span class="line"></span><br><span class="line"><span class="tag"></<span class="name">project</span>></span></span><br></pre></td></tr></tbody></table></figure><h4 id="2-创建application-yml配置文件"><a href="#2-创建application-yml配置文件" class="headerlink" title="2.创建application.yml配置文件"></a>2.创建application.yml配置文件</h4><figure class="highlight yaml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">#端口自定义</span></span><br><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">8020</span></span><br><span class="line"><span class="comment">#应用名字</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">consumer</span></span><br><span class="line">    <span class="comment">#注册中心地址</span></span><br><span class="line"><span class="attr">eureka:</span></span><br><span class="line">  <span class="attr">client:</span></span><br><span class="line">    <span class="attr">service-url:</span></span><br><span class="line">      <span class="attr">defaultZone:</span> <span class="string">http://localhost:8761/eureka/</span></span><br><span class="line">  <span class="attr">instance:</span></span><br><span class="line">    <span class="attr">prefer-ip-address:</span> <span class="literal">true</span> <span class="comment">#进行注册</span></span><br></pre></td></tr></tbody></table></figure><h4 id="3-创建启动类"><a href="#3-创建启动类" class="headerlink" title="3.创建启动类"></a>3.创建启动类</h4><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> org.example;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.SpringApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.client.RestTemplate;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConsumerApplication</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>{</span><br><span class="line">        SpringApplication.run(ConsumerApplication<span class="class">.<span class="keyword">class</span>, <span class="title">args</span>)</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">//提供RestTemplate实例将其添加到ioc容器</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> RestTemplate <span class="title">restTemplate</span><span class="params">()</span></span>{</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> RestTemplate();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><h4 id="4-创建实体类，跟resttemplate模块一样"><a href="#4-创建实体类，跟resttemplate模块一样" class="headerlink" title="4.创建实体类，跟resttemplate模块一样"></a>4.创建实体类，跟resttemplate模块一样</h4><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> org.example.entity;</span><br><span class="line"><span class="keyword">import</span> lombok.AllArgsConstructor;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"><span class="keyword">import</span> lombok.NoArgsConstructor;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>{</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">long</span> id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><h4 id="5-创建Controller-跟resttemplate模块一样"><a href="#5-创建Controller-跟resttemplate模块一样" class="headerlink" title="5.创建Controller,跟resttemplate模块一样"></a>5.创建Controller,跟resttemplate模块一样</h4><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> org.example.controller;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.example.entity.Student;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.*;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.client.RestTemplate;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Collection;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/consumer"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConsumerController</span> </span>{</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> RestTemplate restTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     * 调用eurekaclient模块下的Controller里面的接口</span></span><br><span class="line"><span class="comment">     * getForEntity中的的get为GET请求,参数一：要调用的地址 参数二：结果集</span></span><br><span class="line"><span class="comment">     * restTemplate.getForEntity().getBody()作用与restTemplate.getForObject（）作用相同</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@GetMapping</span>(<span class="string">"/findAllR"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Collection<Student> <span class="title">findAll</span><span class="params">()</span></span>{</span><br><span class="line"></span><br><span class="line">       <span class="keyword">return</span> restTemplate.getForEntity(<span class="string">"http://localhost:8010/student/findAll"</span>,Collection<span class="class">.<span class="keyword">class</span>).<span class="title">getBody</span>()</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping</span>(<span class="string">"/findAllR2"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Collection<Student> <span class="title">findAll2</span><span class="params">()</span></span>{</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> restTemplate.getForObject(<span class="string">"http://localhost:8010/student/findAll"</span>,Collection<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">//根据id查询</span></span><br><span class="line">    <span class="meta">@GetMapping</span>(<span class="string">"/findById/{id}"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Student <span class="title">findById</span><span class="params">(@PathVariable(<span class="string">"id"</span>)</span> <span class="keyword">long</span> id)</span>{</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> restTemplate.getForEntity(<span class="string">"http://localhost:8010/student/findById/"</span>,Student<span class="class">.<span class="keyword">class</span>,<span class="title">id</span>).<span class="title">getBody</span>()</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping</span>(<span class="string">"/findById2/{id}"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Student <span class="title">findById2</span><span class="params">(@PathVariable(<span class="string">"id"</span>)</span> <span class="keyword">long</span> id)</span>{</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> restTemplate.getForObject(<span class="string">"http://localhost:8010/student/findById/"</span>,Student<span class="class">.<span class="keyword">class</span>,<span class="title">id</span>)</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//查询</span></span><br><span class="line">    <span class="meta">@PostMapping</span>(<span class="string">"/save"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">save</span><span class="params">(@RequestBody Student student)</span></span>{</span><br><span class="line"></span><br><span class="line">        restTemplate.postForEntity(<span class="string">"http://localhost:8010/student/save"</span>,student,<span class="keyword">null</span>).getBody();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping</span>(<span class="string">"/save2"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">save2</span><span class="params">(@RequestBody Student student)</span></span>{</span><br><span class="line"></span><br><span class="line">       restTemplate.postForObject(<span class="string">"http://localhost:8010/student/save"</span>,student,<span class="keyword">null</span>);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">//修改</span></span><br><span class="line">    <span class="meta">@PutMapping</span>(<span class="string">"/update"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">(@RequestBody Student student)</span></span>{</span><br><span class="line">        restTemplate.put(<span class="string">"http://localhost:8010/student/update"</span>,student);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">//删除</span></span><br><span class="line">    <span class="meta">@DeleteMapping</span>(<span class="string">"//deleteById/{id}"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">(@PathVariable(<span class="string">"id"</span>)</span> <span class="keyword">long</span> id)</span>{</span><br><span class="line">        restTemplate.delete(<span class="string">"http://localhost:8010/student/update"</span>,id);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><h4 id="6-按顺序启动服务（eurekaserver注册中心-gt-eurekaclient服务提供者-gt-consumer服务消费者）"><a href="#6-按顺序启动服务（eurekaserver注册中心-gt-eurekaclient服务提供者-gt-consumer服务消费者）" class="headerlink" title="6.按顺序启动服务（eurekaserver注册中心->eurekaclient服务提供者->consumer服务消费者）"></a>6.按顺序启动服务（eurekaserver注册中心->eurekaclient服务提供者->consumer服务消费者）</h4><p>注：这里说明下consumer服务消费者在某些时候也可以当成服务提供者，主要区别在于谁调用谁，如果后者调用前者，那么后者就是服务消费者，前者是服务提供者，反之，前者是服务消费者，后者是服务提供者。</p><h4 id="7-浏览器输入eurekaserver注册中心地址：http-localhost-8761"><a href="#7-浏览器输入eurekaserver注册中心地址：http-localhost-8761" class="headerlink" title="7.浏览器输入eurekaserver注册中心地址：http://localhost:8761/"></a>7.浏览器输入eurekaserver注册中心地址：<a href="http://localhost:8761/" target="_blank" rel="noopener">http://localhost:8761/</a></h4><p><img src="https://i.loli.net/2020/05/06/p3eXzPrK8ulSMna.png" alt="1588582648490"></p><p>可以看到成功注册了服务消费者和服务提供者，接下来只需要服务消费者调用服务提供者。</p><h4 id="8-输入地址调用服务提供者：http-localhost-8020-consumer-findAllR"><a href="#8-输入地址调用服务提供者：http-localhost-8020-consumer-findAllR" class="headerlink" title="8.输入地址调用服务提供者：http://localhost:8020/consumer/findAllR"></a>8.输入地址调用服务提供者：<a href="http://localhost:8020/consumer/findAllR" target="_blank" rel="noopener">http://localhost:8020/consumer/findAllR</a></h4><figure class="highlight json"><table><tbody><tr><td class="code"><pre><span class="line">[{<span class="attr">"id"</span>:<span class="number">1</span>,<span class="attr">"name"</span>:<span class="string">"刘备"</span>,<span class="attr">"age"</span>:<span class="number">24</span>},{<span class="attr">"id"</span>:<span class="number">2</span>,<span class="attr">"name"</span>:<span class="string">"张飞"</span>,<span class="attr">"age"</span>:<span class="number">22</span>},{<span class="attr">"id"</span>:<span class="number">3</span>,<span class="attr">"name"</span>:<span class="string">"关羽"</span>,<span class="attr">"age"</span>:<span class="number">23</span>}]</span><br></pre></td></tr></tbody></table></figure><p>其他方法自行测试</p><blockquote><p>声明：此文章是结合B站’楠哥教你学Java’视频自己整理出来的笔记，如有不清楚的可以去看楠哥视频。</p></blockquote><!-- rebuild by neat --></body></html>]]></content>
      <categories>
        <category>springCloud</category>
      </categories>
      <tags>
        <tag>微服务</tag>
        <tag>springCloud</tag>
        <tag>笔记</tag>
      </tags>
  </entry>
  <entry>
    <title>springboot入门</title>
    <url>/Details/02/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><!-- build time:Sat May 22 2021 19:59:12 GMT+0800 (GMT+08:00) --><html><head></head><body><img class="st" src="https://i.loli.net/2020/04/25/y1fDMlYq9PNint3.png"><a id="more"></a><h2 id="1-初识springboot"><a href="#1-初识springboot" class="headerlink" title="1.初识springboot"></a>1.初识springboot</h2><ul><li>SpringBoot是由Pivotal团队在2013年开始研发、2014年4月发布第一个版本的全新开源的轻量级框架。它基于Spring4.0设计，不仅继承了Spring框架原有的优秀特性，而且还通过简化配置来进一步简化了Spring应用的整个搭建和开发过程。另外SpringBoot通过集成大量的框架使得依赖包的版本冲突，以及引用的不稳定性等问题得到了很好的解决。可能这样说了你还是很懵逼，用通俗易懂的语言将就是帮助我们简化传统的ssm框架等的配置，比如各种繁琐的xml配置。</li></ul><h2 id="2-环境"><a href="#2-环境" class="headerlink" title="2.环境"></a>2.环境</h2><ul><li>jdk</li><li>maven</li><li>idea</li></ul><h2 id="3-springboot优势"><a href="#3-springboot优势" class="headerlink" title="3.springboot优势"></a>3.springboot优势</h2><ol><li>springboot可以帮助我们自动装配javabean</li><li>springboot可以帮我们自动配置事务</li><li>springboot可以帮我们加载配置文件</li><li>springboot内嵌tomcat</li></ol><p>这些都是springboot一些优点，当然还不止这些，比如支持热部署，日志，各种引擎模板，还可以整合其他优秀的框架等等。</p><h2 id="4-入门"><a href="#4-入门" class="headerlink" title="4.入门"></a>4.入门</h2><p>步骤如下：<br>1.首先新建项目选择Spring Initializr，点击右边的next</p><p><img src="https://i.loli.net/2020/04/25/v674kT5obKpPOli.png" alt></p><p>2.然后输入规范包名、项目名，一般是自动生成，然后next</p><p><img src="https://i.loli.net/2020/04/25/KfC5zyuXBnZrs9L.png" alt></p><p>3.选择需要的依赖，这里为了方便演示选择了springWeb依赖，然后next,选择项目存储位置，最后finish,这样下项目初始化完成</p><p><img src="https://i.loli.net/2020/04/25/e4tzyHKEOdgYJil.png" alt></p><p>4.可以删除项目中多余的文件，接下展开文件夹你便可以看到xxxApplication的类啦，这个就是程序主入口，我们先在demo目录下创建一个test目录，并在其下面创建Controller类，然后类上面加Controller注解表示这个类被springboot自动装配到容器中，再加上GetMapping、ResponseBody注解映射，这里加入ResponseBody会在浏览器返回字符串，否则会返回springboot默认的，也就是resources下面的html，由于没有定义页面，启动后会报404错误。</p><p><img src="https://i.loli.net/2020/04/25/RZ8YL6NnD72m4FS.png" alt></p><p>5.找到上面的程序主入口启动项目，等待几秒钟</p><p><img src="https://i.loli.net/2020/04/25/Rjst3AOl8KJVDCM.png" alt></p><p>6.最后浏览器输入localhost:8080，你就可以看到”hello world!”啦</p><p>是不是觉得so easy啊!</p><!-- rebuild by neat --></body></html>]]></content>
      <categories>
        <category>springboot</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>javaWeb</tag>
        <tag>springboot</tag>
      </tags>
  </entry>
  <entry>
    <title>spring笔记</title>
    <url>/note/10/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><!-- build time:Sat May 22 2021 19:59:12 GMT+0800 (GMT+08:00) --><html><head></head><body><img class="st" src="https://i.loli.net/2020/08/05/UwuLkJy12XzYeK6.jpg"><a id="more"></a><h6 id="1-导入maven依赖"><a href="#1-导入maven依赖" class="headerlink" title="1. 导入maven依赖"></a>1. 导入maven依赖</h6><ul><li>注意：导入相关依赖，为了减少手写也可直接导入spring-webmvc依赖包</li></ul><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta"><?xml version="1.0" encoding="UTF-8"?></span></span><br><span class="line"><span class="tag"><<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">"http://maven.apache.org/POM/4.0.0"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span>></span></span><br><span class="line">    <span class="tag"><<span class="name">modelVersion</span>></span>4.0.0<span class="tag"></<span class="name">modelVersion</span>></span></span><br><span class="line"></span><br><span class="line">    <span class="tag"><<span class="name">groupId</span>></span>org.example<span class="tag"></<span class="name">groupId</span>></span></span><br><span class="line">    <span class="tag"><<span class="name">artifactId</span>></span>spring_01<span class="tag"></<span class="name">artifactId</span>></span></span><br><span class="line">    <span class="tag"><<span class="name">version</span>></span>1.0-SNAPSHOT<span class="tag"></<span class="name">version</span>></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="tag"><<span class="name">dependencies</span>></span></span><br><span class="line"><span class="comment"><!--导入spring及其相关依赖（aop,beans,context,core,expression,spring-web：spring-webmvc包含spring相关依赖--></span></span><br><span class="line">    <span class="tag"><<span class="name">dependency</span>></span></span><br><span class="line">        <span class="tag"><<span class="name">groupId</span>></span>org.springframework<span class="tag"></<span class="name">groupId</span>></span></span><br><span class="line">        <span class="tag"><<span class="name">artifactId</span>></span>spring-webmvc<span class="tag"></<span class="name">artifactId</span>></span></span><br><span class="line">        <span class="tag"><<span class="name">version</span>></span>5.2.2.RELEASE<span class="tag"></<span class="name">version</span>></span></span><br><span class="line">    <span class="tag"></<span class="name">dependency</span>></span></span><br><span class="line"><span class="comment"><!--    单元测试--></span></span><br><span class="line">    <span class="tag"><<span class="name">dependency</span>></span></span><br><span class="line">        <span class="tag"><<span class="name">groupId</span>></span>junit<span class="tag"></<span class="name">groupId</span>></span></span><br><span class="line">        <span class="tag"><<span class="name">artifactId</span>></span>junit<span class="tag"></<span class="name">artifactId</span>></span></span><br><span class="line">        <span class="tag"><<span class="name">version</span>></span>4.12<span class="tag"></<span class="name">version</span>></span></span><br><span class="line">        <span class="tag"><<span class="name">scope</span>></span>test<span class="tag"></<span class="name">scope</span>></span></span><br><span class="line">    <span class="tag"></<span class="name">dependency</span>></span></span><br><span class="line"><span class="tag"></<span class="name">dependencies</span>></span></span><br><span class="line"></span><br><span class="line"><span class="tag"></<span class="name">project</span>></span></span><br></pre></td></tr></tbody></table></figure><h6 id="2-ApplicationContext-xml全局配置文件"><a href="#2-ApplicationContext-xml全局配置文件" class="headerlink" title="2.ApplicationContext.xml全局配置文件"></a>2.ApplicationContext.xml全局配置文件</h6><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta"><?xml version="1.0" encoding="UTF-8"?></span></span><br><span class="line"><span class="tag"><<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:aop</span>=<span class="string">"http://www.springframework.org/schema/aop"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag"></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">        https://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="tag"><span class="string">        https://www.springframework.org/schema/context/spring-context.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/aop</span></span></span><br><span class="line"><span class="tag"><span class="string">        https://www.springframework.org/schema/aop/spring-aop.xsd"</span>></span></span><br><span class="line"></span><br><span class="line">    <span class="comment"><!-- 指定扫描org.example包下的所有类中的注解  --></span></span><br><span class="line">    <span class="tag"><<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"org.example"</span>></span><span class="tag"></<span class="name">context:component-scan</span>></span></span><br><span class="line"></span><br><span class="line">    <span class="comment"><!--开启注解--></span></span><br><span class="line">    <span class="tag"><<span class="name">context:annotation-config</span>/></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"><!--spring容器中bean对象--></span></span><br><span class="line">  <span class="comment"><!--  <bean id="user" class="org.example.pojo.User"></span></span><br><span class="line"><span class="comment">        <property name="name" value="chengLong"/></span></span><br><span class="line"><span class="comment">    </bean></span></span><br><span class="line"><span class="comment">--></span></span><br><span class="line"></span><br><span class="line">    <span class="comment"><!-- more bean definitions go here --></span></span><br><span class="line"></span><br><span class="line"><span class="tag"></<span class="name">beans</span>></span></span><br></pre></td></tr></tbody></table></figure><h6 id="3-静态代理"><a href="#3-静态代理" class="headerlink" title="3. 静态代理"></a>3. 静态代理</h6><ul><li><p>代理模式分为三个角色：被代理角色、代理角色、客户角色，以租房为实例进行演示：</p><ul><li>租房抽象接口类</li></ul><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> org.example.proxy;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*租房抽象接口*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Rent</span> </span>{</span><br><span class="line">    <span class="comment">//出租房屋的方法</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">rent</span><span class="params">()</span></span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><ul><li>被代理对象类（房东）</li></ul><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> org.example.proxy;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*真实角色（房东）*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Host</span> <span class="keyword">implements</span> <span class="title">Rent</span> </span>{</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">rent</span><span class="params">()</span> </span>{</span><br><span class="line">        System.out.println(<span class="string">"xx要出租房屋"</span>);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><ul><li>代理对象类（租房中介）</li></ul><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> org.example.proxy;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*代理角色（房屋中介）*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">proxy</span> <span class="keyword">implements</span> <span class="title">Rent</span> </span>{</span><br><span class="line">    <span class="comment">//被代理的类</span></span><br><span class="line">    <span class="keyword">private</span> Host host;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setHost</span><span class="params">(Host host)</span> </span>{</span><br><span class="line">        <span class="keyword">this</span>.host = host;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">rent</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="comment">//调用代理类特有的方法实现不修改原有代码（host类）而实现功能的增加</span></span><br><span class="line">        pre();</span><br><span class="line"></span><br><span class="line">        host.rent();</span><br><span class="line"></span><br><span class="line">        after();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//代理类特有方法</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">pre</span><span class="params">()</span></span>{</span><br><span class="line">        System.out.println(<span class="string">"【Debug】"</span>+<span class="string">"带客户看房"</span>);</span><br><span class="line">    }</span><br><span class="line">    <span class="comment">//代理类特有方法</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">after</span><span class="params">()</span></span>{</span><br><span class="line">        System.out.println(<span class="string">"【Debug】"</span>+<span class="string">"收取租金并签定租赁合同"</span>);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><ul><li>客户类</li></ul><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> org.example.proxy;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*客户*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>{</span><br><span class="line">        Host host = <span class="keyword">new</span> Host();</span><br><span class="line"></span><br><span class="line">        proxy proxy = <span class="keyword">new</span> proxy();</span><br><span class="line">        proxy.setHost(host);</span><br><span class="line">        proxy.rent();</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></li></ul><h6 id="4-动态代理"><a href="#4-动态代理" class="headerlink" title="4. 动态代理"></a>4. 动态代理</h6><ul><li>动态代理即动态生成代理类，实例以静态代理为基础做升级。</li><li>抽象接口</li></ul><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> org.example.proxy;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*租房抽象接口*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Rent</span> </span>{</span><br><span class="line">    <span class="comment">//出租房屋的方法</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">rent</span><span class="params">()</span></span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><ul><li>被代理类</li></ul><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> org.example.proxy;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*真实角色（房东）*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Host</span> <span class="keyword">implements</span> <span class="title">Rent</span> </span>{</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">rent</span><span class="params">()</span> </span>{</span><br><span class="line">        System.out.println(<span class="string">"xx要出租房屋"</span>);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><ul><li>实现<strong>InvocationHandler</strong>接口的类用于动态生成代理</li></ul><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> org.example.proxy;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.InvocationHandler;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Proxy;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*动态代理万能模板,InvocationHandler这个类自动生成代理类*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProxyInvocationHandler</span> <span class="keyword">implements</span> <span class="title">InvocationHandler</span> </span>{</span><br><span class="line">    <span class="keyword">private</span> Object target;<span class="comment">//被代理的接口</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setTarget</span><span class="params">(Object target)</span> </span>{</span><br><span class="line">        <span class="keyword">this</span>.target = target;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">//生成得到代理类</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">getProxy</span><span class="params">()</span></span>{</span><br><span class="line">        <span class="keyword">return</span> Proxy.newProxyInstance(<span class="keyword">this</span>.getClass().getClassLoader(),</span><br><span class="line">                target.getClass().getInterfaces(),<span class="keyword">this</span>);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">//处理代理实例并返回结果</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">invoke</span><span class="params">(Object proxy, Method method, Object[] args)</span> <span class="keyword">throws</span> Throwable </span>{</span><br><span class="line"></span><br><span class="line">        before(method.getName());</span><br><span class="line">        Object result = method.invoke(target, args);</span><br><span class="line">        after(method.getName());</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">//特有方法</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">before</span><span class="params">(String b)</span></span>{</span><br><span class="line">        System.out.println(<span class="string">"[Debug]:"</span>+b+<span class="string">"方法初始化"</span>);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">after</span><span class="params">(String a)</span></span>{</span><br><span class="line">        System.out.println(<span class="string">"[Debug]:"</span>+a+<span class="string">"方法结束"</span>);</span><br><span class="line"></span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><ul><li>测试类</li></ul><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> org.example.proxy;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*客户*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>{</span><br><span class="line">        <span class="comment">//真实角色</span></span><br><span class="line">        Host host = <span class="keyword">new</span> Host();</span><br><span class="line">        <span class="comment">//代理角色，不存在</span></span><br><span class="line">        ProxyInvocationHandler pid = <span class="keyword">new</span> ProxyInvocationHandler();</span><br><span class="line">        <span class="comment">//设置要代理的对象</span></span><br><span class="line">        pid.setTarget(host);</span><br><span class="line">        <span class="comment">//动态生成代理类</span></span><br><span class="line">        Rent proxy =(Rent) pid.getProxy();</span><br><span class="line">        proxy.rent();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><ul><li>输出结果</li></ul><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line">[Debug]:rent方法初始化</span><br><span class="line">xx要出租房屋</span><br><span class="line">[Debug]:rent方法结束</span><br></pre></td></tr></tbody></table></figure><h6 id="5-aop面向切面编程"><a href="#5-aop面向切面编程" class="headerlink" title="5. aop面向切面编程"></a>5. aop面向切面编程</h6><p>​ 5.1 aop面向切面编程有三种方法分别是面向接口的aop配置、面向切面的aop配置、注解配置。</p><p>方法一：</p><ul><li>接口和实体类(被代理类、目标类)</li></ul><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> org.example.service;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*业务抽象接口*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserService</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">add</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">delete</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">select</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> org.example.service;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*真实业务*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserServiceImpl</span> <span class="keyword">implements</span> <span class="title">UserService</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">add</span><span class="params">()</span> </span>{</span><br><span class="line">        System.out.println(<span class="string">"添加用户"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"ok"</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">delete</span><span class="params">()</span> </span>{</span><br><span class="line">        System.out.println(<span class="string">"删除用户"</span>);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">()</span> </span>{</span><br><span class="line">        System.out.println(<span class="string">"修改用户"</span>);</span><br><span class="line"></span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">select</span><span class="params">()</span> </span>{</span><br><span class="line">        System.out.println(<span class="string">"查询用户"</span>);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><ul><li>要增强的特定方法（通知）</li></ul><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> org.example.advice;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.aop.MethodBeforeAdvice;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*方法一    前置方法*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Before</span> <span class="keyword">implements</span> <span class="title">MethodBeforeAdvice</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">before</span><span class="params">(Method method, Object[] objects, Object o)</span> <span class="keyword">throws</span> Throwable </span>{</span><br><span class="line">        System.out.println(method.getName()+<span class="string">"方法被初始化了"</span>);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> org.example.advice;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.aop.AfterReturningAdvice;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*方法一    后置方法*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">After</span> <span class="keyword">implements</span> <span class="title">AfterReturningAdvice</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">afterReturning</span><span class="params">(Object o, Method method, Object[] objects, Object o1)</span> <span class="keyword">throws</span> Throwable </span>{</span><br><span class="line">        System.out.println(method.getName()+<span class="string">"方法结束了"</span>);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><ul><li>装配bean和配置aop</li></ul><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta"><?xml version="1.0" encoding="UTF-8"?></span></span><br><span class="line"><span class="tag"><<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:aop</span>=<span class="string">"http://www.springframework.org/schema/aop"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">        https://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="tag"><span class="string">        https://www.springframework.org/schema/context/spring-context.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/aop</span></span></span><br><span class="line"><span class="tag"><span class="string">        https://www.springframework.org/schema/aop/spring-aop.xsd"</span>></span></span><br><span class="line"></span><br><span class="line"><span class="comment"><!--注册bean--></span></span><br><span class="line">    <span class="tag"><<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"before"</span> <span class="attr">class</span>=<span class="string">"org.example.advice.Before"</span>></span><span class="tag"></<span class="name">bean</span>></span></span><br><span class="line">    <span class="tag"><<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"userService"</span> <span class="attr">class</span>=<span class="string">"org.example.service.UserServiceImpl"</span>></span><span class="tag"></<span class="name">bean</span>></span></span><br><span class="line">    <span class="tag"><<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"after"</span> <span class="attr">class</span>=<span class="string">"org.example.advice.After"</span>></span><span class="tag"></<span class="name">bean</span>></span></span><br><span class="line">    <span class="comment"><!--方法二--></span></span><br><span class="line">    <span class="tag"><<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"aspect"</span> <span class="attr">class</span>=<span class="string">"org.example.aspect.Aspect"</span>></span><span class="tag"></<span class="name">bean</span>></span></span><br><span class="line">    <span class="comment"><!--aop配置   方法一 原生态面向接口（功能强大）--></span></span><br><span class="line">    <span class="tag"><<span class="name">aop:config</span>></span></span><br><span class="line">        <span class="comment"><!--expression:表达式，execution(返回类型 具体类.方法(参数)) *代表所有类型--></span></span><br><span class="line">        <span class="tag"><<span class="name">aop:pointcut</span> <span class="attr">id</span>=<span class="string">"pointcut"</span> <span class="attr">expression</span>=<span class="string">"execution(* org.example.service.UserServiceImpl.*(..))"</span>/></span></span><br><span class="line">        <span class="comment"><!--环绕通知 前置--></span></span><br><span class="line">        <span class="tag"><<span class="name">aop:advisor</span> <span class="attr">advice-ref</span>=<span class="string">"before"</span> <span class="attr">pointcut-ref</span>=<span class="string">"pointcut"</span>></span><span class="tag"></<span class="name">aop:advisor</span>></span></span><br><span class="line">        <span class="comment"><!--后置--></span></span><br><span class="line">        <span class="tag"><<span class="name">aop:advisor</span> <span class="attr">advice-ref</span>=<span class="string">"after"</span> <span class="attr">pointcut-ref</span>=<span class="string">"pointcut"</span>></span><span class="tag"></<span class="name">aop:advisor</span>></span></span><br><span class="line"></span><br><span class="line">    <span class="tag"></<span class="name">aop:config</span>></span></span><br><span class="line"></span><br><span class="line">    <span class="comment"><!--方法二 面向切面--></span></span><br><span class="line">   <span class="tag"><<span class="name">aop:config</span>></span></span><br><span class="line">       <span class="tag"><<span class="name">aop:pointcut</span> <span class="attr">id</span>=<span class="string">"pointcut"</span> <span class="attr">expression</span>=<span class="string">"execution(* org.example.service.UserServiceImpl.*(..))"</span>/></span></span><br><span class="line">       <span class="tag"><<span class="name">aop:aspect</span> <span class="attr">ref</span>=<span class="string">"aspect"</span> ></span></span><br><span class="line">           <span class="tag"><<span class="name">aop:before</span> <span class="attr">method</span>=<span class="string">"before"</span> <span class="attr">pointcut-ref</span>=<span class="string">"pointcut"</span>></span><span class="tag"></<span class="name">aop:before</span>></span></span><br><span class="line">           <span class="tag"><<span class="name">aop:after</span> <span class="attr">method</span>=<span class="string">"after"</span> <span class="attr">pointcut-ref</span>=<span class="string">"pointcut"</span>></span><span class="tag"></<span class="name">aop:after</span>></span></span><br><span class="line">       <span class="tag"></<span class="name">aop:aspect</span>></span></span><br><span class="line">   <span class="tag"></<span class="name">aop:config</span>></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="tag"></<span class="name">beans</span>></span></span><br></pre></td></tr></tbody></table></figure><ul><li>测试类</li></ul><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> org.example;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.example.service.UserService;</span><br><span class="line"><span class="keyword">import</span> org.example.service.UserServiceImpl;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.support.ClassPathXmlApplicationContext;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyTest</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>{</span><br><span class="line">        ClassPathXmlApplicationContext context = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">"ApplicationContext.xml"</span>);</span><br><span class="line">        <span class="comment">//获取接口对象</span></span><br><span class="line">        UserService userService = context.getBean(<span class="string">"userService"</span>, UserService<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">       userService.add();</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><ul><li>运行结果</li></ul><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line">add方法被初始化了</span><br><span class="line">添加用户</span><br><span class="line">add方法结束了</span><br></pre></td></tr></tbody></table></figure><p>方法二：</p><ul><li>实体类和接口如同方法一，不同之处是通知及配置，通知类如下</li></ul><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> org.example.aspect;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*方法二 面向切面*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Aspect</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">before</span><span class="params">()</span></span>{</span><br><span class="line">        System.out.println(<span class="string">"方法执行了"</span>);</span><br><span class="line">    }</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">after</span><span class="params">()</span></span>{</span><br><span class="line">        System.out.println(<span class="string">"方法结束了"</span>);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><ul><li>ApplicationContext.xml配置文件详解方法一</li></ul><!-- rebuild by neat --></body></html>]]></content>
      <categories>
        <category>spring</category>
      </categories>
      <tags>
        <tag>spring</tag>
        <tag>aop</tag>
      </tags>
  </entry>
  <entry>
    <title>使用lombok报错解决</title>
    <url>/err/09/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><!-- build time:Sat May 22 2021 19:59:12 GMT+0800 (GMT+08:00) --><html><head></head><body><p>之前做项目时在使用lombok插件启动项目时报错，在此记录一下</p><a id="more"></a><p>，希望能帮到大家。</p><h4 id="问题描述"><a href="#问题描述" class="headerlink" title="问题描述"></a>问题描述</h4><figure class="highlight plain"><table><tbody><tr><td class="code"><pre><span class="line">ERROR o.a.c.c.C.[.[.[.【dispatcherServlet】 </span><br><span class="line">- Servlet.service() for servlet 【dispatcherServlet】</span><br><span class="line"> in context with path 【】 threw exception 【Handler processing failed; nested exception is java.lang.StackOverflowError】 with root cause</span><br><span class="line">java.lang.StackOverflowError: null</span><br></pre></td></tr></tbody></table></figure><ul><li>出现以上错误并且实体类之间不停的出现调用，这个问题是由于实体类之间存在关系，在使用lombok的注解时是会默认生成tostring方法，在一方调用另一方的时候就会出现相互调用的情况，所以会出现栈溢出的情况。<h4 id="解决方法"><a href="#解决方法" class="headerlink" title="解决方法"></a>解决方法</h4></li><li>取消一方实体类的tostring方法，即在需要取消的属性上加上lombok注解@ToString.Exclude或者在类似加上@ToString(exclude=”属性名”)，好了，问题得到解决。</li></ul><!-- rebuild by neat --></body></html>]]></content>
      <categories>
        <category>errorNote</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>lombok</tag>
      </tags>
  </entry>
  <entry>
    <title>搭建mybatis</title>
    <url>/Details/09/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><!-- build time:Sat May 22 2021 19:59:12 GMT+0800 (GMT+08:00) --><html><head></head><body><img class="st" src="https://i.loli.net/2020/04/25/p5w6GHLN7A2VtrP.jpg"><a id="more"></a><p>MyBatis 是支持定制化 SQL、存储过程以及高级映射的优秀的持久层框架。MyBatis 避免了几乎所有的 JDBC 代码和手动设置参数以及获取结果集。MyBatis 可以对配置和原生Map使用简单的 XML 或注解，将接口和 Java 的 POJOs(Plain Old Java Objects,普通的 Java对象)映射成数据库中的记录</p><h6 id="1-基础项目目录结构"><a href="#1-基础项目目录结构" class="headerlink" title="1. 基础项目目录结构"></a>1. 基础项目目录结构</h6><p><img src="https://i.loli.net/2020/04/25/fcR1gSCtBHi2umz.png" alt="load"></p><h6 id="2-maven依赖"><a href="#2-maven依赖" class="headerlink" title="2. maven依赖"></a>2. maven依赖</h6><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta"><?xml version="1.0" encoding="UTF-8"?></span></span><br><span class="line"><span class="tag"><<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">"http://maven.apache.org/POM/4.0.0"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span>></span></span><br><span class="line">    <span class="tag"><<span class="name">modelVersion</span>></span>4.0.0<span class="tag"></<span class="name">modelVersion</span>></span></span><br><span class="line"></span><br><span class="line">    <span class="tag"><<span class="name">groupId</span>></span>org.org.example<span class="tag"></<span class="name">groupId</span>></span></span><br><span class="line">    <span class="tag"><<span class="name">artifactId</span>></span>mybatis_01<span class="tag"></<span class="name">artifactId</span>></span></span><br><span class="line">    <span class="tag"><<span class="name">version</span>></span>1.0-SNAPSHOT<span class="tag"></<span class="name">version</span>></span></span><br><span class="line"><span class="comment"><!--java文件中xml映射默认无法扫描，需加上build即可扫描xml配置文件--></span></span><br><span class="line">    <span class="tag"><<span class="name">build</span>></span></span><br><span class="line">        <span class="tag"><<span class="name">resources</span>></span></span><br><span class="line">            <span class="comment"><!-- resources文件 --></span></span><br><span class="line">            <span class="tag"><<span class="name">resource</span>></span></span><br><span class="line">                <span class="tag"><<span class="name">directory</span>></span>src/main/java<span class="tag"></<span class="name">directory</span>></span></span><br><span class="line">                <span class="comment"><!-- 引入映射文件等 --></span></span><br><span class="line">                <span class="tag"><<span class="name">includes</span>></span></span><br><span class="line">                    <span class="tag"><<span class="name">include</span>></span>**/*.xml<span class="tag"></<span class="name">include</span>></span></span><br><span class="line">                <span class="tag"></<span class="name">includes</span>></span></span><br><span class="line">            <span class="tag"></<span class="name">resource</span>></span></span><br><span class="line">        <span class="tag"></<span class="name">resources</span>></span></span><br><span class="line">    <span class="tag"></<span class="name">build</span>></span></span><br><span class="line">    <span class="tag"><<span class="name">dependencies</span>></span></span><br><span class="line"></span><br><span class="line">    <span class="comment"><!--mybatis--></span></span><br><span class="line">        <span class="tag"><<span class="name">dependency</span>></span></span><br><span class="line">            <span class="tag"><<span class="name">groupId</span>></span>org.mybatis<span class="tag"></<span class="name">groupId</span>></span></span><br><span class="line">            <span class="tag"><<span class="name">artifactId</span>></span>mybatis<span class="tag"></<span class="name">artifactId</span>></span></span><br><span class="line">            <span class="tag"><<span class="name">version</span>></span>3.4.6<span class="tag"></<span class="name">version</span>></span></span><br><span class="line">        <span class="tag"></<span class="name">dependency</span>></span></span><br><span class="line">        <span class="comment"><!--mysql连接驱动--></span></span><br><span class="line">        <span class="tag"><<span class="name">dependency</span>></span></span><br><span class="line">            <span class="tag"><<span class="name">groupId</span>></span>MySQL<span class="tag"></<span class="name">groupId</span>></span></span><br><span class="line">            <span class="tag"><<span class="name">artifactId</span>></span>mysql-connector-java<span class="tag"></<span class="name">artifactId</span>></span></span><br><span class="line">            <span class="tag"><<span class="name">version</span>></span>5.1.40<span class="tag"></<span class="name">version</span>></span></span><br><span class="line">        <span class="tag"></<span class="name">dependency</span>></span></span><br><span class="line"></span><br><span class="line">        <span class="comment"><!--junit测试--></span></span><br><span class="line">        <span class="tag"><<span class="name">dependency</span>></span></span><br><span class="line">            <span class="tag"><<span class="name">groupId</span>></span>junit<span class="tag"></<span class="name">groupId</span>></span></span><br><span class="line">            <span class="tag"><<span class="name">artifactId</span>></span>junit<span class="tag"></<span class="name">artifactId</span>></span></span><br><span class="line">            <span class="tag"><<span class="name">version</span>></span>4.12<span class="tag"></<span class="name">version</span>></span></span><br><span class="line">            <span class="tag"><<span class="name">scope</span>></span>test<span class="tag"></<span class="name">scope</span>></span></span><br><span class="line">        <span class="tag"></<span class="name">dependency</span>></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="tag"></<span class="name">dependencies</span>></span></span><br><span class="line"></span><br><span class="line"><span class="tag"></<span class="name">project</span>></span></span><br></pre></td></tr></tbody></table></figure><h6 id="3-全局配置mybatis-config-xml"><a href="#3-全局配置mybatis-config-xml" class="headerlink" title="3. 全局配置mybatis-config.xml"></a>3. 全局配置mybatis-config.xml</h6><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta"><?xml version="1.0" encoding="UTF-8" ?></span></span><br><span class="line"><span class="meta"><!DOCTYPE <span class="meta-keyword">configuration</span></span></span><br><span class="line"><span class="meta">        <span class="meta-keyword">PUBLIC</span> <span class="meta-string">"-//mybatis.org//DTD Config 3.0//EN"</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">"http://mybatis.org/dtd/mybatis-3-config.dtd"</span>></span></span><br><span class="line"><span class="tag"><<span class="name">configuration</span>></span></span><br><span class="line"><span class="comment"><!--别名，包名默认为类的小写--></span></span><br><span class="line">   <span class="comment"><!--</span></span><br><span class="line"><span class="comment">   <typeAlias type="org.example.pojo.User" alias="User"/></span></span><br><span class="line"><span class="comment">   --></span></span><br><span class="line">    <span class="tag"><<span class="name">typeAliases</span>></span></span><br><span class="line">        <span class="tag"><<span class="name">package</span> <span class="attr">name</span>=<span class="string">"org.example.pojo"</span>/></span></span><br><span class="line">    <span class="tag"></<span class="name">typeAliases</span>></span></span><br><span class="line"><span class="comment"><!--环境--></span></span><br><span class="line">    <span class="tag"><<span class="name">environments</span> <span class="attr">default</span>=<span class="string">"development"</span>></span></span><br><span class="line">        <span class="tag"><<span class="name">environment</span> <span class="attr">id</span>=<span class="string">"development"</span>></span></span><br><span class="line">            <span class="tag"><<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">"JDBC"</span>/></span></span><br><span class="line">            <span class="tag"><<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">"POOLED"</span>></span></span><br><span class="line">                <span class="tag"><<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driver"</span> <span class="attr">value</span>=<span class="string">"com.mysql.jdbc.Driver"</span>/></span></span><br><span class="line"><span class="comment"><!--?useUnicode=true&amp;characterEncoding=utf8解决中文乱码--></span></span><br><span class="line">                <span class="tag"><<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span> <span class="attr">value</span>=<span class="string">"jdbc:mysql://localhost:3306/login?useUnicode=true<span class="symbol">&amp;</span>characterEncoding=utf8"</span>/></span></span><br><span class="line">                <span class="tag"><<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">"root"</span>/></span></span><br><span class="line">                <span class="tag"><<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"123456"</span>/></span></span><br><span class="line">            <span class="tag"></<span class="name">dataSource</span>></span></span><br><span class="line">        <span class="tag"></<span class="name">environment</span>></span></span><br><span class="line">    <span class="tag"></<span class="name">environments</span>></span></span><br><span class="line"></span><br><span class="line"><span class="comment"><!--映射sql配置文件--></span></span><br><span class="line">    <span class="tag"><<span class="name">mappers</span>></span></span><br><span class="line">        <span class="tag"><<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">"org/example/dao/UserMapper.xml"</span>/></span></span><br><span class="line">    <span class="tag"></<span class="name">mappers</span>></span></span><br><span class="line"><span class="tag"></<span class="name">configuration</span>></span></span><br></pre></td></tr></tbody></table></figure><h6 id="4-接口绑定配置文件UserMapper-xml"><a href="#4-接口绑定配置文件UserMapper-xml" class="headerlink" title="4. 接口绑定配置文件UserMapper.xml"></a>4. 接口绑定配置文件UserMapper.xml</h6><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta"><?xml version="1.0" encoding="UTF-8" ?></span></span><br><span class="line">        <span class="meta"><!DOCTYPE <span class="meta-keyword">mapper</span></span></span><br><span class="line"><span class="meta">                <span class="meta-keyword">PUBLIC</span> <span class="meta-string">"-//mybatis.org//DTD Mapper 3.0//EN"</span></span></span><br><span class="line"><span class="meta">                <span class="meta-string">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span>></span></span><br><span class="line"><span class="comment"><!--绑定接口全限定类名--></span></span><br><span class="line"><span class="tag"><<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"org.example.dao.UserMapper"</span>></span></span><br><span class="line"></span><br><span class="line"><span class="tag"><<span class="name">select</span> <span class="attr">id</span>=<span class="string">"queryUser"</span> <span class="attr">resultType</span>=<span class="string">"user"</span>></span></span><br><span class="line">    select *from login.user</span><br><span class="line"><span class="tag"></<span class="name">select</span>></span></span><br><span class="line"></span><br><span class="line"><span class="tag"><<span class="name">select</span> <span class="attr">id</span>=<span class="string">"queryUserById"</span> <span class="attr">parameterType</span>=<span class="string">"int"</span> <span class="attr">resultType</span>=<span class="string">"user"</span>></span></span><br><span class="line">    select *from login.user where id=#{id}</span><br><span class="line"><span class="tag"></<span class="name">select</span>></span></span><br><span class="line"></span><br><span class="line"><span class="tag"><<span class="name">insert</span> <span class="attr">id</span>=<span class="string">"addUser"</span> <span class="attr">parameterType</span>=<span class="string">"org.example.pojo.User"</span>></span></span><br><span class="line">    insert into login.user (id,username,password) values (#{id},#{username},#{password})</span><br><span class="line"><span class="tag"></<span class="name">insert</span>></span></span><br><span class="line"></span><br><span class="line"><span class="tag"><<span class="name">update</span> <span class="attr">id</span>=<span class="string">"updateUser"</span> <span class="attr">parameterType</span>=<span class="string">"org.example.pojo.User"</span>></span></span><br><span class="line">        update login.user set username=#{username},paassword=#{password} where id={id}</span><br><span class="line">    <span class="tag"></<span class="name">update</span>></span></span><br><span class="line"></span><br><span class="line"><span class="tag"><<span class="name">delete</span> <span class="attr">id</span>=<span class="string">"deleteUser"</span> <span class="attr">parameterType</span>=<span class="string">"int"</span>></span></span><br><span class="line">        delete from login.user where id=#{id}</span><br><span class="line">    <span class="tag"></<span class="name">delete</span>></span></span><br><span class="line"><span class="tag"></<span class="name">mapper</span>></span></span><br></pre></td></tr></tbody></table></figure><!-- rebuild by neat --></body></html>]]></content>
      <categories>
        <category>mybatis</category>
      </categories>
      <tags>
        <tag>sql</tag>
        <tag>jdbc</tag>
        <tag>框架</tag>
      </tags>
  </entry>
  <entry>
    <title>聊一聊微服务（下）</title>
    <url>/service2/20/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><!-- build time:Sat May 22 2021 19:59:12 GMT+0800 (GMT+08:00) --><html><head></head><body><img class="st" src="https://i.loli.net/2020/05/06/TVG52RcIoYkU6Km.jpg"><a id="more"></a><h2 id="七、服务网关"><a href="#七、服务网关" class="headerlink" title="七、服务网关"></a>七、服务网关</h2><h4 id="1-什么是服务网关？"><a href="#1-什么是服务网关？" class="headerlink" title="1.什么是服务网关？"></a>1.什么是服务网关？</h4><p>服务网关 = 路由转发 + 过滤器,在一开始也有提到过，当客户端要请求一个系统中的多个微服务时，这时有多个微服务（模块）就要请求几次，明显这样不利于管理，于是出现就加入了服务网关，只需要客户端与网关交互，然后由网关来进行请求转发。</p><p><img src="https://i.loli.net/2020/05/06/X2yO9eRWGmhaLdF.png" alt="1588587290249"></p><h4 id="2-Spring-Cloud集成了Zuul组件，实现服务网关。"><a href="#2-Spring-Cloud集成了Zuul组件，实现服务网关。" class="headerlink" title="2.Spring Cloud集成了Zuul组件，实现服务网关。"></a>2.Spring Cloud集成了Zuul组件，实现服务网关。</h4><ul><li><p>什么是Zuul?</p><p>Zuul是Netflix提供的一个开源的API网关服务器，是客户端和网站后端所有请求的中间层，对外开放-个API,将所有请求导入统- -的入口， 屏蔽了服务端的具体实现逻辑，Zuul 可以实现反向代理的功能，在网关内部实现动态路由、身份认证、IP 过滤、数据监控等,并且Zuul还自带了负载均衡功能。</p></li></ul><h4 id="3-在父工程下创建maven工程zuul，pom-xml配置"><a href="#3-在父工程下创建maven工程zuul，pom-xml配置" class="headerlink" title="3.在父工程下创建maven工程zuul，pom.xml配置"></a>3.在父工程下创建maven工程zuul，pom.xml配置</h4><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta"><?xml version="1.0" encoding="UTF-8"?></span></span><br><span class="line"><span class="tag"><<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">"http://maven.apache.org/POM/4.0.0"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span>></span></span><br><span class="line">    <span class="tag"><<span class="name">parent</span>></span></span><br><span class="line">        <span class="tag"><<span class="name">artifactId</span>></span>springcloud<span class="tag"></<span class="name">artifactId</span>></span></span><br><span class="line">        <span class="tag"><<span class="name">groupId</span>></span>org.example<span class="tag"></<span class="name">groupId</span>></span></span><br><span class="line">        <span class="tag"><<span class="name">version</span>></span>1.0-SNAPSHOT<span class="tag"></<span class="name">version</span>></span></span><br><span class="line">    <span class="tag"></<span class="name">parent</span>></span></span><br><span class="line">    <span class="tag"><<span class="name">modelVersion</span>></span>4.0.0<span class="tag"></<span class="name">modelVersion</span>></span></span><br><span class="line"></span><br><span class="line">    <span class="tag"><<span class="name">artifactId</span>></span>zuul<span class="tag"></<span class="name">artifactId</span>></span></span><br><span class="line">   <span class="comment"><!--zuul组件也需要注册，引入client--></span></span><br><span class="line">    <span class="tag"><<span class="name">dependencies</span>></span></span><br><span class="line">        <span class="tag"><<span class="name">dependency</span>></span></span><br><span class="line">            <span class="tag"><<span class="name">groupId</span>></span>org.springframework.cloud<span class="tag"></<span class="name">groupId</span>></span></span><br><span class="line">            <span class="tag"><<span class="name">artifactId</span>></span>spring-cloud-starter-netflix-eureka-client<span class="tag"></<span class="name">artifactId</span>></span></span><br><span class="line">            <span class="tag"><<span class="name">version</span>></span>2.0.2.RELEASE<span class="tag"></<span class="name">version</span>></span></span><br><span class="line">        <span class="tag"></<span class="name">dependency</span>></span></span><br><span class="line"></span><br><span class="line">        <span class="comment"><!--zuul依赖--></span></span><br><span class="line">        <span class="tag"><<span class="name">dependency</span>></span></span><br><span class="line">            <span class="tag"><<span class="name">groupId</span>></span>org.springframework.cloud<span class="tag"></<span class="name">groupId</span>></span></span><br><span class="line">            <span class="tag"><<span class="name">artifactId</span>></span>spring-cloud-starter-netflix-zuul<span class="tag"></<span class="name">artifactId</span>></span></span><br><span class="line">            <span class="tag"><<span class="name">version</span>></span>2.0.2.RELEASE<span class="tag"></<span class="name">version</span>></span></span><br><span class="line">        <span class="tag"></<span class="name">dependency</span>></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="tag"></<span class="name">dependencies</span>></span></span><br><span class="line"></span><br><span class="line"><span class="tag"></<span class="name">project</span>></span></span><br></pre></td></tr></tbody></table></figure><h4 id="4-创建application-yml配置文件"><a href="#4-创建application-yml配置文件" class="headerlink" title="4.创建application.yml配置文件"></a>4.创建application.yml配置文件</h4><figure class="highlight yaml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">#自定义端口</span></span><br><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">8030</span></span><br><span class="line">  <span class="comment">#名称</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">gateway</span></span><br><span class="line"><span class="comment">#注册到注册中心</span></span><br><span class="line"><span class="attr">eureka:</span></span><br><span class="line">  <span class="attr">client:</span></span><br><span class="line">    <span class="attr">service-url:</span></span><br><span class="line">      <span class="attr">defaulttZone:</span> <span class="string">http://localhost:8761/eureka/</span></span><br><span class="line"><span class="attr">zuul:</span></span><br><span class="line">  <span class="attr">routes:</span></span><br><span class="line">    <span class="attr">provider:</span> <span class="string">/p/**</span> <span class="comment">#给服务提供者provider设置映射，后面访问就可以通过/p/**来直接访问而不需要端口号去访问</span></span><br></pre></td></tr></tbody></table></figure><h4 id="5-创建启动类"><a href="#5-创建启动类" class="headerlink" title="5.创建启动类"></a>5.创建启动类</h4><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> org.example;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.SpringApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.autoconfigure.EnableAutoConfiguration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.cloud.netflix.zuul.EnableZuulProxy;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@EnableZuulProxy</span>：包含了EnableZuulServer,设置该类是网关的启动类</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@EnableAutoConfiguration</span>: 可以帮助Spring Boot应用将所有符合条件的<span class="doctag">@Configuration</span>配置加载到当前Spring Boot创建并使用的loC容器中。</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@EnableZuulProxy</span></span><br><span class="line"><span class="meta">@EnableAutoConfiguration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ZuulApplication</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>{</span><br><span class="line">        SpringApplication.run(ZuulApplication<span class="class">.<span class="keyword">class</span>, <span class="title">args</span>)</span>;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><h4 id="6-按顺序启动（eurekaserver注册中心-gt-eurekaclient服务提供者-gt-zuul服务网关）"><a href="#6-按顺序启动（eurekaserver注册中心-gt-eurekaclient服务提供者-gt-zuul服务网关）" class="headerlink" title="6.按顺序启动（eurekaserver注册中心->eurekaclient服务提供者->zuul服务网关）"></a>6.按顺序启动（eurekaserver注册中心->eurekaclient服务提供者->zuul服务网关）</h4><h4 id="7-浏览器输入：http-localhost-8030-p-student-findAll-通过服务网关的端口去访问任何一个服务提供者，返回结果"><a href="#7-浏览器输入：http-localhost-8030-p-student-findAll-通过服务网关的端口去访问任何一个服务提供者，返回结果" class="headerlink" title="7.浏览器输入：http://localhost:8030/p/student/findAll, 通过服务网关的端口去访问任何一个服务提供者，返回结果"></a>7.浏览器输入：<a href="http://localhost:8030/p/student/findAll" target="_blank" rel="noopener">http://localhost:8030/p/student/findAll</a>, 通过服务网关的端口去访问任何一个服务提供者，返回结果</h4><figure class="highlight json"><table><tbody><tr><td class="code"><pre><span class="line">[{<span class="attr">"id"</span>:<span class="number">1</span>,<span class="attr">"name"</span>:<span class="string">"刘备"</span>,<span class="attr">"age"</span>:<span class="number">24</span>},{<span class="attr">"id"</span>:<span class="number">2</span>,<span class="attr">"name"</span>:<span class="string">"张飞"</span>,<span class="attr">"age"</span>:<span class="number">22</span>},{<span class="attr">"id"</span>:<span class="number">3</span>,<span class="attr">"name"</span>:<span class="string">"关羽"</span>,<span class="attr">"age"</span>:<span class="number">23</span>}]</span><br></pre></td></tr></tbody></table></figure><h2 id="八、Ribbon实现负载均衡"><a href="#八、Ribbon实现负载均衡" class="headerlink" title="八、Ribbon实现负载均衡"></a>八、Ribbon实现负载均衡</h2><h4 id="1-什么是负载均衡？"><a href="#1-什么是负载均衡？" class="headerlink" title="1.什么是负载均衡？"></a>1.什么是负载均衡？</h4><p>将负载（工作任务，访问请求）进行平衡、分摊到多个操作单元（服务器，组件）上进行执行。是解决高性能，单点故障（高可用），扩展性（水平伸缩）的终极解决方案，简单讲就是一个人将每次到来的一个任务随机均衡分配给多个人来完成，这样来达到减轻人的工作压力，这里的”任务”表示请求，”人”表示服务器。</p><h4 id="2-什么是Ribbon？"><a href="#2-什么是Ribbon？" class="headerlink" title="2.什么是Ribbon？"></a>2.什么是Ribbon？</h4><p>Spring Cloud Ribbon是一个负载均衡解决方案，Ribbon是Netfix公司发布的负载均衡器，而SpringCloud进行了整合，是基于Netfix Ribbon实现的，是一个用于对HTTP请求进行控制的负载均衡客户端。在注册中心对Ribbon进行注册之后，Ribon就可以基于某种均衡算法、如轮询、随机、加权轮询、加权随机等自动帮助服务消费者调用接口，开发者也可以根据需求自定义Ribbon负载均衡算法，实际开发中，Spring Cloud Ribbon需要结合Spring Cloud Eureka来使用，Eureka Server提供所有可以调用的服务提供者列表， Ribbon基于特定的负载均衡算法从这些服务提供者中选择要调用的具体实例。</p><p><img src="https://i.loli.net/2020/05/06/GJrciZ9xlFKjBwy.png" alt="1588597010570"></p><h4 id="3-在父工程下创建Maven工程，pom-xml配置"><a href="#3-在父工程下创建Maven工程，pom-xml配置" class="headerlink" title="3.在父工程下创建Maven工程，pom.xml配置"></a>3.在父工程下创建Maven工程，pom.xml配置</h4><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta"><?xml version="1.0" encoding="UTF-8"?></span></span><br><span class="line"><span class="tag"><<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">"http://maven.apache.org/POM/4.0.0"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span>></span></span><br><span class="line">    <span class="tag"><<span class="name">parent</span>></span></span><br><span class="line">        <span class="tag"><<span class="name">artifactId</span>></span>springcloud<span class="tag"></<span class="name">artifactId</span>></span></span><br><span class="line">        <span class="tag"><<span class="name">groupId</span>></span>org.example<span class="tag"></<span class="name">groupId</span>></span></span><br><span class="line">        <span class="tag"><<span class="name">version</span>></span>1.0-SNAPSHOT<span class="tag"></<span class="name">version</span>></span></span><br><span class="line">    <span class="tag"></<span class="name">parent</span>></span></span><br><span class="line">    <span class="tag"><<span class="name">modelVersion</span>></span>4.0.0<span class="tag"></<span class="name">modelVersion</span>></span></span><br><span class="line"></span><br><span class="line">    <span class="tag"><<span class="name">artifactId</span>></span>ribbon<span class="tag"></<span class="name">artifactId</span>></span></span><br><span class="line"></span><br><span class="line">    <span class="comment"><!--所需的eureka-client依赖--></span></span><br><span class="line">    <span class="tag"><<span class="name">dependencies</span>></span></span><br><span class="line">        <span class="tag"><<span class="name">dependency</span>></span></span><br><span class="line">            <span class="tag"><<span class="name">groupId</span>></span>org.springframework.cloud<span class="tag"></<span class="name">groupId</span>></span></span><br><span class="line">            <span class="tag"><<span class="name">artifactId</span>></span>spring-cloud-starter-netflix-eureka-client<span class="tag"></<span class="name">artifactId</span>></span></span><br><span class="line">            <span class="tag"><<span class="name">version</span>></span>2.0.2.RELEASE<span class="tag"></<span class="name">version</span>></span></span><br><span class="line">        <span class="tag"></<span class="name">dependency</span>></span></span><br><span class="line">    <span class="tag"></<span class="name">dependencies</span>></span></span><br><span class="line"><span class="tag"></<span class="name">project</span>></span></span><br></pre></td></tr></tbody></table></figure><h4 id="4-创建application-yml配置文件-1"><a href="#4-创建application-yml配置文件-1" class="headerlink" title="4.创建application.yml配置文件"></a>4.创建application.yml配置文件</h4><figure class="highlight yaml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">#端口</span></span><br><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">8040</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#当前服务注册在Eureka Server上的名称</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">ribbon</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#注册中心访问地址</span></span><br><span class="line"><span class="attr">eureka:</span></span><br><span class="line">  <span class="attr">client:</span></span><br><span class="line">    <span class="attr">service-url:</span></span><br><span class="line">      <span class="attr">defaultZone:</span> <span class="string">http://localhost:8761/eureka/</span></span><br><span class="line">  <span class="attr">instance:</span></span><br><span class="line">    <span class="attr">prefer-ip-address:</span> <span class="literal">true</span> <span class="comment">#是否将当前服务的ip注册到EurekaServer</span></span><br></pre></td></tr></tbody></table></figure><h4 id="5-创建启动类-1"><a href="#5-创建启动类-1" class="headerlink" title="5.创建启动类"></a>5.创建启动类</h4><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> org.example;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.SpringApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.cloud.client.loadbalancer.LoadBalanced;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.client.RestTemplate;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RibbonApplication</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>{</span><br><span class="line">        SpringApplication.run(RibbonApplication<span class="class">.<span class="keyword">class</span>,<span class="title">args</span>)</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="meta">@LoadBalanced</span> <span class="comment">//开启负载均衡</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> RestTemplate <span class="title">restTemplate</span><span class="params">()</span></span>{</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> RestTemplate();</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><h4 id="6-修改eurekaclient模块的Ctroller层"><a href="#6-修改eurekaclient模块的Ctroller层" class="headerlink" title="6.修改eurekaclient模块的Ctroller层"></a>6.修改eurekaclient模块的Ctroller层</h4><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> org.example.controller;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.example.dao.StudentRepository;</span><br><span class="line"><span class="keyword">import</span> org.example.entity.Student;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Value;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.*;</span><br><span class="line"><span class="keyword">import</span> java.util.Collection;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/student"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StudentController</span> </span>{</span><br><span class="line">    <span class="comment">//当前端口号，从配置文件中读取端口号</span></span><br><span class="line">    <span class="meta">@Value</span>(<span class="string">"${server.port}"</span>)</span><br><span class="line">    <span class="keyword">private</span> String port;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> StudentRepository studentRepository;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping</span>(<span class="string">"/findAll"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Collection<Student> <span class="title">findAll</span><span class="params">()</span></span>{</span><br><span class="line">        <span class="keyword">return</span> studentRepository.findAll();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping</span>(<span class="string">"/findById/{id}"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Student <span class="title">findById</span><span class="params">(@PathVariable(<span class="string">"id"</span>)</span> <span class="keyword">long</span> id)</span>{</span><br><span class="line">        <span class="keyword">return</span> studentRepository.findById(id);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@PostMapping</span>(<span class="string">"/save"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">save</span><span class="params">(@RequestBody Student student)</span></span>{</span><br><span class="line">        studentRepository.saveOrUpdate(student);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@PutMapping</span>(<span class="string">"/update"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">(@RequestBody Student student)</span></span>{</span><br><span class="line">        studentRepository.saveOrUpdate(student);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@DeleteMapping</span>(<span class="string">"/deleteById/{id}"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">deleteById</span><span class="params">(@PathVariable(<span class="string">"id"</span>)</span> <span class="keyword">long</span> id)</span>{</span><br><span class="line">        studentRepository.deleteById(id);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">//测试负载均衡（需要添加的地方）</span></span><br><span class="line">    <span class="meta">@GetMapping</span>(<span class="string">"/port"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">port</span><span class="params">()</span></span>{</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"当前端口"</span>+<span class="keyword">this</span>.port;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><h4 id="7-创建Ctroller层"><a href="#7-创建Ctroller层" class="headerlink" title="7.创建Ctroller层"></a>7.创建Ctroller层</h4><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> org.example.controller;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.example.entity.Student;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Value;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.*;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.client.RestTemplate;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Collection;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/ribbon"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RibbonController</span> </span>{</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> RestTemplate restTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     * 调用eurekaclient模块下的Controller里面的接口</span></span><br><span class="line"><span class="comment">     * getForEntity中的的get为GET请求,参数一：要调用的地址 参数二：结果集</span></span><br><span class="line"><span class="comment">     * restTemplate.getForEntity().getBody()作用与restTemplate.getForObject（）作用相同</span></span><br><span class="line"><span class="comment">     * 用服务提供者名字provider替换localhost:8010</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping</span>(<span class="string">"/findAll"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Collection<Student> <span class="title">findAll2</span><span class="params">()</span></span>{</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> restTemplate.getForObject(<span class="string">"http://provider/student/findAll"</span>,Collection<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">//测试负载均衡</span></span><br><span class="line">    <span class="meta">@GetMapping</span>(<span class="string">"/port"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">port</span><span class="params">()</span></span>{</span><br><span class="line">        <span class="keyword">return</span> restTemplate.getForObject(<span class="string">"http://provider/student/port"</span>, String<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><h4 id="8-依次开启服务：eurekaServer注册中心-gt-eurekaclient服务提供者-8080-gt-eurekaclient服务提供者-8081-gt-Ribbon"><a href="#8-依次开启服务：eurekaServer注册中心-gt-eurekaclient服务提供者-8080-gt-eurekaclient服务提供者-8081-gt-Ribbon" class="headerlink" title="8.依次开启服务：eurekaServer注册中心->eurekaclient服务提供者(8080)->eurekaclient服务提供者(8081)->Ribbon"></a>8.依次开启服务：eurekaServer注册中心->eurekaclient服务提供者(8080)->eurekaclient服务提供者(8081)->Ribbon</h4><p>注：这里开启的是两个服务提供者端口号不同</p><h4 id="9-浏览器输入：http-localhost-8040-ribbon-port，这里也可以检验查询方法，这里展示的是为了能直观的看到效果"><a href="#9-浏览器输入：http-localhost-8040-ribbon-port，这里也可以检验查询方法，这里展示的是为了能直观的看到效果" class="headerlink" title="9.浏览器输入：http://localhost:8040/ribbon/port，这里也可以检验查询方法，这里展示的是为了能直观的看到效果"></a>9.浏览器输入：<a href="http://localhost:8040/ribbon/port，这里也可以检验查询方法，这里展示的是为了能直观的看到效果" target="_blank" rel="noopener">http://localhost:8040/ribbon/port，这里也可以检验查询方法，这里展示的是为了能直观的看到效果</a></h4><p>目的是检验负载均衡，这时会显示“当前端口8080”，刷新一次端口号变成了“当前端口8081”，每刷新一次都会在这两个端口相互切换，如果开了n个服务提供者就在n个端口之间相互切换，这样一来就减少了单个服务器的压力。</p><h2 id="九、Feign"><a href="#九、Feign" class="headerlink" title="九、Feign"></a>九、Feign</h2><h4 id="1-什么是Feign？"><a href="#1-什么是Feign？" class="headerlink" title="1.什么是Feign？"></a>1.什么是Feign？</h4><p>与Ribbon -样，Feign 也是由Netflix提供的负载均衡器，是基于ribbon进行封装的，Feign 是一个声明式、模版化的Web Service客户端，它简化了开发者编写Web服务客户端的操作，开发者可以通过简单的接口和注解来调用HTTP API, Spring Cloud Feign,它整合了Ribbon和Hystrix,具有可插拔、基于注解、负载均衡、服务熔断等-系列便捷功能。相比较于Ribbon + RestTemplate的方式，Feign 大大简化了代码的开发，Feign 支持多种注解，包括Feign注解、JAX-RS注解、Spring MVC注解等，Spring Cloud对Feing进行了优化，整合了Ribbon和Eureka,从而让Feign的使用更加方便。</p><h4 id="2-Ribbon和Feign的区别"><a href="#2-Ribbon和Feign的区别" class="headerlink" title="2.Ribbon和Feign的区别"></a>2.Ribbon和Feign的区别</h4><p>Ribbon是一个通用的HTTP客户端工具，Feign 是基于Ribbon实现的。</p><h4 id="3-Feign的特点"><a href="#3-Feign的特点" class="headerlink" title="3.Feign的特点"></a>3.Feign的特点</h4><ul><li>Feign是一个声明式的Web Service客户端。</li><li>支持Feign注解、Spring MVC注解、JAX-RS注解。</li><li>Feign 基于Ribbon实现，使用起来更加简单。</li><li>Feign 集成了Hystrix，具备服务熔断的功能。</li></ul><h4 id="4-代码实现：创建模块，pom-xml配置"><a href="#4-代码实现：创建模块，pom-xml配置" class="headerlink" title="4.代码实现：创建模块，pom.xml配置"></a>4.代码实现：创建模块，pom.xml配置</h4><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta"><?xml version="1.0" encoding="UTF-8"?></span></span><br><span class="line"><span class="tag"><<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">"http://maven.apache.org/POM/4.0.0"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span>></span></span><br><span class="line">    <span class="tag"><<span class="name">parent</span>></span></span><br><span class="line">        <span class="tag"><<span class="name">artifactId</span>></span>springcloud<span class="tag"></<span class="name">artifactId</span>></span></span><br><span class="line">        <span class="tag"><<span class="name">groupId</span>></span>org.example<span class="tag"></<span class="name">groupId</span>></span></span><br><span class="line">        <span class="tag"><<span class="name">version</span>></span>1.0-SNAPSHOT<span class="tag"></<span class="name">version</span>></span></span><br><span class="line">    <span class="tag"></<span class="name">parent</span>></span></span><br><span class="line">    <span class="tag"><<span class="name">modelVersion</span>></span>4.0.0<span class="tag"></<span class="name">modelVersion</span>></span></span><br><span class="line"></span><br><span class="line">    <span class="tag"><<span class="name">artifactId</span>></span>feign<span class="tag"></<span class="name">artifactId</span>></span></span><br><span class="line"></span><br><span class="line">    <span class="comment"><!--相关依赖--></span></span><br><span class="line">            <span class="tag"><<span class="name">dependencies</span>></span></span><br><span class="line">        <span class="tag"><<span class="name">dependency</span>></span></span><br><span class="line">            <span class="tag"><<span class="name">groupId</span>></span>org.springframework.cloud<span class="tag"></<span class="name">groupId</span>></span></span><br><span class="line">            <span class="tag"><<span class="name">artifactId</span>></span>spring-cloud-starter-netflix-eureka-client<span class="tag"></<span class="name">artifactId</span>></span></span><br><span class="line">            <span class="tag"><<span class="name">version</span>></span>2.0.2.RELEASE<span class="tag"></<span class="name">version</span>></span></span><br><span class="line">        <span class="tag"></<span class="name">dependency</span>></span></span><br><span class="line"></span><br><span class="line">        <span class="tag"><<span class="name">dependency</span>></span></span><br><span class="line">            <span class="tag"><<span class="name">groupId</span>></span>org.springframework.cloud<span class="tag"></<span class="name">groupId</span>></span></span><br><span class="line">            <span class="tag"><<span class="name">artifactId</span>></span>spring-cloud-starter-openfeign<span class="tag"></<span class="name">artifactId</span>></span></span><br><span class="line">            <span class="tag"><<span class="name">version</span>></span>2.0.2.RELEASE<span class="tag"></<span class="name">version</span>></span></span><br><span class="line">        <span class="tag"></<span class="name">dependency</span>></span></span><br><span class="line">    <span class="tag"></<span class="name">dependencies</span>></span></span><br><span class="line"></span><br><span class="line"><span class="tag"></<span class="name">project</span>></span></span><br></pre></td></tr></tbody></table></figure><h4 id="5-创建application-yml"><a href="#5-创建application-yml" class="headerlink" title="5.创建application.yml"></a>5.创建application.yml</h4><figure class="highlight yaml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">#自定义端口</span></span><br><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">8050</span></span><br><span class="line">  <span class="comment">#名称</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">feign</span></span><br><span class="line"><span class="comment">#注册到注册中心</span></span><br><span class="line"><span class="attr">eureka:</span></span><br><span class="line">  <span class="attr">client:</span></span><br><span class="line">    <span class="attr">service-url:</span></span><br><span class="line">      <span class="attr">defaulttZone:</span> <span class="string">http://localhost:8761/eureka/</span></span><br><span class="line">  <span class="attr">instance:</span></span><br><span class="line">    <span class="attr">prefer-ip-address:</span> <span class="literal">true</span></span><br></pre></td></tr></tbody></table></figure><h4 id="6-启动类"><a href="#6-启动类" class="headerlink" title="6.启动类"></a>6.启动类</h4><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> org.example;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.SpringApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.cloud.openfeign.EnableFeignClients;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@EnableFeignClients</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FeignApplication</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>{</span><br><span class="line">        SpringApplication.run(FeignApplication<span class="class">.<span class="keyword">class</span>, <span class="title">args</span>)</span>;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><h4 id="7-创建实体类"><a href="#7-创建实体类" class="headerlink" title="7.创建实体类"></a>7.创建实体类</h4><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> org.example.entity;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.AllArgsConstructor;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"><span class="keyword">import</span> lombok.NoArgsConstructor;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>{</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">long</span> id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><h4 id="8-创建声明式接口"><a href="#8-创建声明式接口" class="headerlink" title="8.创建声明式接口"></a>8.创建声明式接口</h4><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> org.example.Feign;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.example.entity.Student;</span><br><span class="line"><span class="keyword">import</span> org.springframework.cloud.openfeign.FeignClient;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.GetMapping;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Collection;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@FeignClient</span>: 需要访问服务提供者的名字</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  <span class="doctag">@GetMapping</span>("/student/findAll")： 需要访问服务提供者的接口</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@FeignClient</span>(value = <span class="string">"provider"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">FeignProviderClient</span> </span>{</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping</span>(<span class="string">"/student/findAll"</span>)</span><br><span class="line">    <span class="comment">//查询</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Collection<Student> <span class="title">findAll</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping</span>(<span class="string">"/student/port"</span>)</span><br><span class="line">    <span class="comment">//查询当前接口</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">port</span><span class="params">()</span></span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><h4 id="9-创建Controller层"><a href="#9-创建Controller层" class="headerlink" title="9.创建Controller层"></a>9.创建Controller层</h4><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> org.example.controller;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.example.Feign.FeignProviderClient;</span><br><span class="line"><span class="keyword">import</span> org.example.entity.Student;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.GetMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Collection;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/feign"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FeignController</span> </span>{</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> FeignProviderClient feignProviderClient;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * feignProviderClient:刚创建的声明式接口</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping</span>(<span class="string">"/findAll"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Collection<Student> <span class="title">findAll2</span><span class="params">()</span> </span>{</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> feignProviderClient.findAll();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">//测试负载均衡</span></span><br><span class="line">    <span class="meta">@GetMapping</span>(<span class="string">"/port"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">port</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> feignProviderClient.port();</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>10.按顺序启动，类似于Ribbon，只是这里是用Feign去调用服务提供者</p><p><img src="https://i.loli.net/2020/05/06/OFbqzfRX1Vgm7kt.png" alt="1588660326959"></p><p>这里注册中心已经注册了四个，分别是一个Feign、两个Provider服务提供者、一个Ribbon，其中Feign和Ribbon都有负载均衡的作用，任何一个都会均衡调用服务提供者。</p><h4 id="11-在Feign配置文件中开启Feign熔断机制，application-yml"><a href="#11-在Feign配置文件中开启Feign熔断机制，application-yml" class="headerlink" title="11.在Feign配置文件中开启Feign熔断机制，application.yml"></a>11.在Feign配置文件中开启Feign熔断机制，application.yml</h4><figure class="highlight yaml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">#自定义端口</span></span><br><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">8050</span></span><br><span class="line">  <span class="comment">#名称</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">feign</span></span><br><span class="line"><span class="comment">#注册到注册中心</span></span><br><span class="line"><span class="attr">eureka:</span></span><br><span class="line">  <span class="attr">client:</span></span><br><span class="line">    <span class="attr">service-url:</span></span><br><span class="line">      <span class="attr">defaulttZone:</span> <span class="string">http://localhost:8761/eureka/</span></span><br><span class="line">  <span class="attr">instance:</span></span><br><span class="line">    <span class="attr">prefer-ip-address:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#是否开启熔断机制</span></span><br><span class="line"><span class="attr">feign:</span></span><br><span class="line">  <span class="attr">hystrix:</span></span><br><span class="line">    <span class="attr">enabled:</span> <span class="literal">true</span></span><br></pre></td></tr></tbody></table></figure><h4 id="12-创建FeignProviderClient接口的实现类FeignError-定义容错处理逻辑，通过-Component-注解将FeignError实例注入loC容器中。"><a href="#12-创建FeignProviderClient接口的实现类FeignError-定义容错处理逻辑，通过-Component-注解将FeignError实例注入loC容器中。" class="headerlink" title="12.创建FeignProviderClient接口的实现类FeignError,定义容错处理逻辑，通过@Component 注解将FeignError实例注入loC容器中。"></a>12.创建FeignProviderClient接口的实现类FeignError,定义容错处理逻辑，通过@Component 注解将FeignError实例注入loC容器中。</h4><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> org.example.Feign.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> feign.Feign;</span><br><span class="line"><span class="keyword">import</span> org.example.Feign.FeignProviderClient;</span><br><span class="line"><span class="keyword">import</span> org.example.entity.Student;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Collection;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FeignError</span> <span class="keyword">implements</span> <span class="title">FeignProviderClient</span> </span>{</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Collection<Student> <span class="title">findAll</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">port</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"服务器维护中......"</span>;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><h4 id="13-在FeignProviderClient定义处通过-FeignClient的fallback属性设置映射。"><a href="#13-在FeignProviderClient定义处通过-FeignClient的fallback属性设置映射。" class="headerlink" title="13.在FeignProviderClient定义处通过@FeignClient的fallback属性设置映射。"></a>13.在FeignProviderClient定义处通过@FeignClient的fallback属性设置映射。</h4><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> org.example.Feign;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.example.Feign.impl.FeignError;</span><br><span class="line"><span class="keyword">import</span> org.example.entity.Student;</span><br><span class="line"><span class="keyword">import</span> org.springframework.cloud.openfeign.FeignClient;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.GetMapping;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Collection;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@FeignClient</span>: 需要访问服务提供者的名字</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  <span class="doctag">@GetMapping</span>("/student/findAll")： 需要访问服务提供者的接口</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@FeignClient</span>(value = <span class="string">"provider"</span>,fallback = FeignError<span class="class">.<span class="keyword">class</span>)//要加入的</span></span><br><span class="line"><span class="class"><span class="title">public</span> <span class="title">interface</span> <span class="title">FeignProviderClient</span> </span>{</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping</span>(<span class="string">"/student/findAll"</span>)</span><br><span class="line">    <span class="comment">//查询</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Collection<Student> <span class="title">findAll</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping</span>(<span class="string">"/student/port"</span>)</span><br><span class="line">    <span class="comment">//查询当前接口</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">port</span><span class="params">()</span></span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><ul><li>这里只启动注册中心和Feigin，然后去调用服务提供者的业务，由于服务提供者我们没有启动，所以浏览器会显示刚刚我们设置的容错机制—-“服务器维护中”，如果不设置服务容错机制就会显示404或者500等信息。</li></ul><h2 id="十、Hystrix容错机制"><a href="#十、Hystrix容错机制" class="headerlink" title="十、Hystrix容错机制"></a>十、Hystrix容错机制</h2><h4 id="1-什么是容错机制？"><a href="#1-什么是容错机制？" class="headerlink" title="1.什么是容错机制？"></a>1.什么是容错机制？</h4><p>随着分布式、微服务项目的快速发展，各个服务之间的通讯，难免出现依赖关系，若某一个单元出现故障，就很容易因依赖关系而发生故障的蔓延，为了解决这样的问题，容错作为其中一项很重要的技术也广为人知，类似于电路中的保险丝，如果电路中某处出现故障就会烧断保险丝而防止故障继续蔓延。</p><h4 id="2-设计原则"><a href="#2-设计原则" class="headerlink" title="2.设计原则"></a>2.设计原则</h4><ul><li>服务隔离机制</li><li>服务降级机制</li><li>熔断机制</li><li>提供实时的监控和报警功能</li><li>提供实时的配置修改功能</li></ul><h4 id="3-介绍"><a href="#3-介绍" class="headerlink" title="3.介绍"></a>3.介绍</h4><p>Hystrix数据监控需要结合SpringBoot Actuator组件来使用，Actuator 提供了对服务的健康监控、数据统计，可以通过hystrix-stream节点获取监控的请求数据，提供了可视化的监控界面。</p><h4 id="4-实例—创建hystrix模块，pom-xml配置"><a href="#4-实例—创建hystrix模块，pom-xml配置" class="headerlink" title="4.实例—创建hystrix模块，pom.xml配置"></a>4.实例—创建hystrix模块，pom.xml配置</h4><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta"><?xml version="1.0" encoding="UTF-8"?></span></span><br><span class="line"><span class="tag"><<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">"http://maven.apache.org/POM/4.0.0"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span>></span></span><br><span class="line">    <span class="tag"><<span class="name">parent</span>></span></span><br><span class="line">        <span class="tag"><<span class="name">artifactId</span>></span>springcloud<span class="tag"></<span class="name">artifactId</span>></span></span><br><span class="line">        <span class="tag"><<span class="name">groupId</span>></span>org.example<span class="tag"></<span class="name">groupId</span>></span></span><br><span class="line">        <span class="tag"><<span class="name">version</span>></span>1.0-SNAPSHOT<span class="tag"></<span class="name">version</span>></span></span><br><span class="line">    <span class="tag"></<span class="name">parent</span>></span></span><br><span class="line">    <span class="tag"><<span class="name">modelVersion</span>></span>4.0.0<span class="tag"></<span class="name">modelVersion</span>></span></span><br><span class="line"></span><br><span class="line">    <span class="tag"><<span class="name">artifactId</span>></span>hystrix<span class="tag"></<span class="name">artifactId</span>></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="tag"><<span class="name">dependencies</span>></span></span><br><span class="line">        <span class="comment"><!--eureka-client依赖--></span></span><br><span class="line">        <span class="tag"><<span class="name">dependency</span>></span></span><br><span class="line">            <span class="tag"><<span class="name">groupId</span>></span>org.springframework.cloud<span class="tag"></<span class="name">groupId</span>></span></span><br><span class="line">            <span class="tag"><<span class="name">artifactId</span>></span>spring-cloud-starter-netflix-eureka-client<span class="tag"></<span class="name">artifactId</span>></span></span><br><span class="line">            <span class="tag"><<span class="name">version</span>></span>2.0.2.RELEASE<span class="tag"></<span class="name">version</span>></span></span><br><span class="line">        <span class="tag"></<span class="name">dependency</span>></span></span><br><span class="line"></span><br><span class="line">        <span class="comment"><!--feign依赖--></span></span><br><span class="line">        <span class="tag"><<span class="name">dependency</span>></span></span><br><span class="line">            <span class="tag"><<span class="name">groupId</span>></span>org.springframework.cloud<span class="tag"></<span class="name">groupId</span>></span></span><br><span class="line">            <span class="tag"><<span class="name">artifactId</span>></span>spring-cloud-starter-openfeign<span class="tag"></<span class="name">artifactId</span>></span></span><br><span class="line">            <span class="tag"><<span class="name">version</span>></span>2.0.2.RELEASE<span class="tag"></<span class="name">version</span>></span></span><br><span class="line">        <span class="tag"></<span class="name">dependency</span>></span></span><br><span class="line"></span><br><span class="line">        <span class="comment"><!--actuator数据监控依赖--></span></span><br><span class="line">        <span class="tag"><<span class="name">dependency</span>></span></span><br><span class="line">            <span class="tag"><<span class="name">groupId</span>></span>org.springframework.boot<span class="tag"></<span class="name">groupId</span>></span></span><br><span class="line">            <span class="tag"><<span class="name">artifactId</span>></span>spring-boot-starter-actuator<span class="tag"></<span class="name">artifactId</span>></span></span><br><span class="line">            <span class="tag"><<span class="name">version</span>></span>2.0.7.RELEASE<span class="tag"></<span class="name">version</span>></span></span><br><span class="line">        <span class="tag"></<span class="name">dependency</span>></span></span><br><span class="line"></span><br><span class="line">        <span class="comment"><!--hystrix依赖--></span></span><br><span class="line">        <span class="tag"><<span class="name">dependency</span>></span></span><br><span class="line">            <span class="tag"><<span class="name">groupId</span>></span>org.springframework.cloud<span class="tag"></<span class="name">groupId</span>></span></span><br><span class="line">            <span class="tag"><<span class="name">artifactId</span>></span>spring-cloud-starter-netflix-hystrix<span class="tag"></<span class="name">artifactId</span>></span></span><br><span class="line">            <span class="tag"><<span class="name">version</span>></span>2.0.2.RELEASE<span class="tag"></<span class="name">version</span>></span></span><br><span class="line">        <span class="tag"></<span class="name">dependency</span>></span></span><br><span class="line"></span><br><span class="line">        <span class="comment"><!--数据监控可视化依赖--></span></span><br><span class="line">        <span class="tag"><<span class="name">dependency</span>></span></span><br><span class="line">            <span class="tag"><<span class="name">groupId</span>></span>org.springframework.cloud<span class="tag"></<span class="name">groupId</span>></span></span><br><span class="line">            <span class="tag"><<span class="name">artifactId</span>></span>spring-cloud-starter-netflix-hystrix-dashboard<span class="tag"></<span class="name">artifactId</span>></span></span><br><span class="line">            <span class="tag"><<span class="name">version</span>></span>2.0.2.RELEASE<span class="tag"></<span class="name">version</span>></span></span><br><span class="line">        <span class="tag"></<span class="name">dependency</span>></span></span><br><span class="line">    <span class="tag"></<span class="name">dependencies</span>></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="tag"></<span class="name">project</span>></span></span><br></pre></td></tr></tbody></table></figure><h4 id="5-创建配置文件，application-yml"><a href="#5-创建配置文件，application-yml" class="headerlink" title="5.创建配置文件，application.yml"></a>5.创建配置文件，application.yml</h4><figure class="highlight yaml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">#自定义端口</span></span><br><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">8060</span></span><br><span class="line">  <span class="comment">#名称</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">hystrix</span></span><br><span class="line"><span class="comment">#注册到注册中心</span></span><br><span class="line"><span class="attr">eureka:</span></span><br><span class="line">  <span class="attr">client:</span></span><br><span class="line">    <span class="attr">service-url:</span></span><br><span class="line">      <span class="attr">defaulttZone:</span> <span class="string">http://localhost:8761/eureka/</span></span><br><span class="line">  <span class="attr">instance:</span></span><br><span class="line">    <span class="attr">prefer-ip-address:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#是否开启熔断机制</span></span><br><span class="line"><span class="attr">feign:</span></span><br><span class="line">  <span class="attr">hystrix:</span></span><br><span class="line">    <span class="attr">enabled:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">#数据监控</span></span><br><span class="line"><span class="attr">management:</span></span><br><span class="line">  <span class="attr">endpoints:</span></span><br><span class="line">    <span class="attr">web:</span></span><br><span class="line">      <span class="attr">exposure:</span></span><br><span class="line">        <span class="attr">include:</span> <span class="string">'hystrix.stream'</span></span><br></pre></td></tr></tbody></table></figure><h4 id="6-创建启动类"><a href="#6-创建启动类" class="headerlink" title="6.创建启动类"></a>6.创建启动类</h4><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> org.example;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.SpringApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.cloud.client.circuitbreaker.EnableCircuitBreaker;</span><br><span class="line"><span class="keyword">import</span> org.springframework.cloud.netflix.hystrix.dashboard.EnableHystrixDashboard;</span><br><span class="line"><span class="keyword">import</span> org.springframework.cloud.openfeign.EnableFeignClients;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@EnableCircuitBreaker</span>: 声明启用数据监控</span></span><br><span class="line"><span class="comment"> *<span class="doctag">@EnableHystrixDashboard</span>： 声明启用可视化数据监控</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@EnableFeignClients</span></span><br><span class="line"><span class="meta">@EnableCircuitBreaker</span></span><br><span class="line"><span class="meta">@EnableHystrixDashboard</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HystrixApplication</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>{</span><br><span class="line">        SpringApplication.run(HystrixApplication<span class="class">.<span class="keyword">class</span>, <span class="title">args</span>)</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><h4 id="7-与Feign一样创建Controller层、实体类、Feign接口与实现类"><a href="#7-与Feign一样创建Controller层、实体类、Feign接口与实现类" class="headerlink" title="7.与Feign一样创建Controller层、实体类、Feign接口与实现类"></a>7.与Feign一样创建Controller层、实体类、Feign接口与实现类</h4><h4 id="8-启动：注册中心-gt-服务提供者-gt-hystrix模块"><a href="#8-启动：注册中心-gt-服务提供者-gt-hystrix模块" class="headerlink" title="8.启动：注册中心->服务提供者->hystrix模块"></a>8.启动：注册中心->服务提供者->hystrix模块</h4><ul><li>启动成功之后，访问<a href="http://localhost:8060/actuator/hystrix.stream可以监控到请求数据" target="_blank" rel="noopener">http://localhost:8060/actuator/hystrix.stream可以监控到请求数据</a></li><li>访问<a href="http://localhost:8060/hystrix，可以看到可视化的监控界面,输入要监控的地址节点即可看到该节点的可视化数据监控。" target="_blank" rel="noopener">http://localhost:8060/hystrix，可以看到可视化的监控界面,输入要监控的地址节点即可看到该节点的可视化数据监控。</a></li></ul><p><img src="https://i.loli.net/2020/05/06/lqV6m32zQHu8nvs.png" alt="1588667837381"></p><p>再新打开一个窗口输入hystrix接口地址调用查询方法findAll便可以看到如下数据监控</p><p><img src="https://i.loli.net/2020/05/06/UoW5RSfqBdGlJv6.png" alt="1588669311295"></p><h2 id="十-一、Spring-Cloud配置中心"><a href="#十-一、Spring-Cloud配置中心" class="headerlink" title="十 一、Spring Cloud配置中心"></a>十 一、Spring Cloud配置中心</h2><h4 id="1-为什么要使用配置中心？"><a href="#1-为什么要使用配置中心？" class="headerlink" title="1.为什么要使用配置中心？"></a>1.为什么要使用配置中心？</h4><p>由于一个一个微服务都有自己的配置文件，每次修改都需要找到对应的微服务的配置文件修改，然后重新启动，那么如果又上百个或者上千个我们也这样去改吗？显然这样做是不合理的，于是就可以将所有的配置文件整合在一个配置中心，需要修改时直接在配置中心修改。</p><h4 id="2-Spring-Cloud-Config"><a href="#2-Spring-Cloud-Config" class="headerlink" title="2.Spring Cloud Config"></a>2.Spring Cloud Config</h4><p>通过服务端可以为多个客户端提供配置服务。Spring Cloud Config可以将配置文件存储在本地，也可以将配置文件存储在远程Git仓库，创建Config Server,通过它管理所有的配置文件。</p><h4 id="3-本地配置中心"><a href="#3-本地配置中心" class="headerlink" title="3.本地配置中心"></a>3.本地配置中心</h4><ul><li><p>在父工程下创建Maven工程，pom.xml配置</p><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta"><?xml version="1.0" encoding="UTF-8"?></span></span><br><span class="line"><span class="tag"><<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">"http://maven.apache.org/POM/4.0.0"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span>></span></span><br><span class="line">    <span class="tag"><<span class="name">parent</span>></span></span><br><span class="line">        <span class="tag"><<span class="name">artifactId</span>></span>springcloud<span class="tag"></<span class="name">artifactId</span>></span></span><br><span class="line">        <span class="tag"><<span class="name">groupId</span>></span>org.example<span class="tag"></<span class="name">groupId</span>></span></span><br><span class="line">        <span class="tag"><<span class="name">version</span>></span>1.0-SNAPSHOT<span class="tag"></<span class="name">version</span>></span></span><br><span class="line">    <span class="tag"></<span class="name">parent</span>></span></span><br><span class="line">    <span class="tag"><<span class="name">modelVersion</span>></span>4.0.0<span class="tag"></<span class="name">modelVersion</span>></span></span><br><span class="line"></span><br><span class="line">    <span class="tag"><<span class="name">artifactId</span>></span>nativeconfigserver<span class="tag"></<span class="name">artifactId</span>></span></span><br><span class="line"></span><br><span class="line">    <span class="tag"><<span class="name">dependencies</span>></span></span><br><span class="line">        <span class="comment"><!--config依赖--></span></span><br><span class="line">        <span class="tag"><<span class="name">dependency</span>></span></span><br><span class="line">            <span class="tag"><<span class="name">groupId</span>></span>org.springframework.cloud<span class="tag"></<span class="name">groupId</span>></span></span><br><span class="line">            <span class="tag"><<span class="name">artifactId</span>></span>spring-cloud-config-server<span class="tag"></<span class="name">artifactId</span>></span></span><br><span class="line">            <span class="tag"><<span class="name">version</span>></span>2.0.2.RELEASE<span class="tag"></<span class="name">version</span>></span></span><br><span class="line">        <span class="tag"></<span class="name">dependency</span>></span></span><br><span class="line">    <span class="tag"></<span class="name">dependencies</span>></span></span><br><span class="line"></span><br><span class="line"><span class="tag"></<span class="name">project</span>></span></span><br></pre></td></tr></tbody></table></figure></li><li><p>创建application.yml</p><figure class="highlight yaml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">8762</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">nativeconfigserver</span></span><br><span class="line">  <span class="attr">profiles:</span></span><br><span class="line">    <span class="attr">active:</span> <span class="string">native</span>  <span class="comment">#配置文件的获取方式</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">config:</span></span><br><span class="line">      <span class="attr">server:</span></span><br><span class="line">        <span class="attr">native:</span></span><br><span class="line">          <span class="attr">search-locations:</span> <span class="string">calsspath:/shared</span> <span class="comment">#本地配置文件路径</span></span><br></pre></td></tr></tbody></table></figure></li><li><p>resources路径下创建shared文件夹，并在此路径下创建configclient-dev.yml</p></li><li><p>创建启动类</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> org.example;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.SpringApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.cloud.config.server.EnableConfigServer;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@EnableConfigServer</span>    <span class="comment">//声明配置中心</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">NativeConfigServerApplication</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>{</span><br><span class="line">        SpringApplication.run(NativeConfigServerApplication<span class="class">.<span class="keyword">class</span>, <span class="title">args</span>)</span>;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></li></ul><h4 id="4-创建本地配置中心客户端读取本地配置中心的配置文件"><a href="#4-创建本地配置中心客户端读取本地配置中心的配置文件" class="headerlink" title="4.创建本地配置中心客户端读取本地配置中心的配置文件"></a>4.创建本地配置中心客户端读取本地配置中心的配置文件</h4><ul><li><p>在父工程下创建客户端模块，pom.xml</p><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta"><?xml version="1.0" encoding="UTF-8"?></span></span><br><span class="line"><span class="tag"><<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">"http://maven.apache.org/POM/4.0.0"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span>></span></span><br><span class="line">    <span class="tag"><<span class="name">parent</span>></span></span><br><span class="line">        <span class="tag"><<span class="name">artifactId</span>></span>springcloud<span class="tag"></<span class="name">artifactId</span>></span></span><br><span class="line">        <span class="tag"><<span class="name">groupId</span>></span>org.example<span class="tag"></<span class="name">groupId</span>></span></span><br><span class="line">        <span class="tag"><<span class="name">version</span>></span>1.0-SNAPSHOT<span class="tag"></<span class="name">version</span>></span></span><br><span class="line">    <span class="tag"></<span class="name">parent</span>></span></span><br><span class="line">    <span class="tag"><<span class="name">modelVersion</span>></span>4.0.0<span class="tag"></<span class="name">modelVersion</span>></span></span><br><span class="line"></span><br><span class="line">    <span class="tag"><<span class="name">artifactId</span>></span>nativeconfigclient<span class="tag"></<span class="name">artifactId</span>></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="tag"><<span class="name">dependencies</span>></span></span><br><span class="line">        <span class="comment"><!--config依赖--></span></span><br><span class="line">        <span class="tag"><<span class="name">dependency</span>></span></span><br><span class="line">            <span class="tag"><<span class="name">groupId</span>></span>org.springframework.cloud<span class="tag"></<span class="name">groupId</span>></span></span><br><span class="line">            <span class="tag"><<span class="name">artifactId</span>></span>spring-cloud-starter-config<span class="tag"></<span class="name">artifactId</span>></span></span><br><span class="line">            <span class="tag"><<span class="name">version</span>></span>2.0.2.RELEASE<span class="tag"></<span class="name">version</span>></span></span><br><span class="line">        <span class="tag"></<span class="name">dependency</span>></span></span><br><span class="line">    <span class="tag"></<span class="name">dependencies</span>></span></span><br><span class="line"><span class="tag"></<span class="name">project</span>></span></span><br></pre></td></tr></tbody></table></figure></li><li><p>创建bootstrap.yml配置文件，用于配置加载配置中心文件的内容</p><p>注:配置文件名必须为bootstrap</p><figure class="highlight yaml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">configclient</span> <span class="comment">#客户端名字</span></span><br><span class="line">  <span class="attr">profiles:</span></span><br><span class="line">    <span class="attr">active:</span> <span class="string">dev</span>  <span class="comment">#与客户端名字拼接起来作为文件名字找到与拼接名字一致的配置中心配置文件</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">config:</span></span><br><span class="line">      <span class="attr">uri:</span>  <span class="string">http://localhost:8762</span>  <span class="comment">#配置中心地址</span></span><br><span class="line">      <span class="attr">fail-fast:</span> <span class="literal">true</span>  <span class="comment">#设置客户端优先判断Config Server获取是否正常。</span></span><br></pre></td></tr></tbody></table></figure></li><li><p>创建启动类</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> org.example;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.SpringApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">NativeConfigClientApplication</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>{</span><br><span class="line">        SpringApplication.run(NativeConfigClientApplication<span class="class">.<span class="keyword">class</span>, <span class="title">args</span>)</span>;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></li><li><p>创建Controller层</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> org.example.controller;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Value;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.GetMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/native"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">NativeConfigClientController</span> </span>{</span><br><span class="line">    <span class="meta">@Value</span>(<span class="string">"${server.port}"</span>)</span><br><span class="line">    <span class="keyword">private</span> String port;</span><br><span class="line">    <span class="meta">@Value</span>(<span class="string">"foo"</span>)</span><br><span class="line">    <span class="keyword">private</span> String foo;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//用于返回shared文件下的配置中心文件里面的端口和foo值</span></span><br><span class="line">    <span class="meta">@GetMapping</span>(<span class="string">"/index"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">index</span><span class="params">()</span></span>{</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.port+<span class="string">"---"</span>+<span class="keyword">this</span>.foo;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></li><li><p>启动：注册中心->本地配置中心->本地配置中心客户端</p><p>浏览器输入本地配置中心客户端的地址，结果返回8070—foo version 1，可以看出是调用了本地配置中心的配置文件。</p></li></ul><h2 id="十二、服务跟踪"><a href="#十二、服务跟踪" class="headerlink" title="十二、服务跟踪"></a>十二、服务跟踪</h2><h4 id="1-为什么需要服务跟踪"><a href="#1-为什么需要服务跟踪" class="headerlink" title="1.为什么需要服务跟踪"></a>1.为什么需要服务跟踪</h4><p>在微服务架构下，往往有成百上千个微小的服务，同时又存在服务与服务之间调用，之间是非常的复杂，所以服务跟踪可以跟踪记录一次用户请求都发起了哪些调用，经过哪些服务处理，并且记录每一次调用所涉及的服务的详细信息，通过日志快速定位是调用失败的环节。</p><h4 id="2-Spring-Cloud-Zipkin"><a href="#2-Spring-Cloud-Zipkin" class="headerlink" title="2.Spring Cloud Zipkin"></a>2.Spring Cloud Zipkin</h4><p>Zipkin是-一个可以采集并且跟踪分布式系统中请求数据的组件,让开发者可以更加直观的监控到请求在各个微服务所耗费的时间等，Zipkin: Zipkin Server. Zipkin Client。</p><h4 id="3-创建zipkinserver模块，pom-xml"><a href="#3-创建zipkinserver模块，pom-xml" class="headerlink" title="3.创建zipkinserver模块，pom.xml"></a>3.创建zipkinserver模块，pom.xml</h4><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta"><?xml version="1.0" encoding="UTF-8"?></span></span><br><span class="line"><span class="tag"><<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">"http://maven.apache.org/POM/4.0.0"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span>></span></span><br><span class="line">    <span class="tag"><<span class="name">parent</span>></span></span><br><span class="line">        <span class="tag"><<span class="name">artifactId</span>></span>springcloud<span class="tag"></<span class="name">artifactId</span>></span></span><br><span class="line">        <span class="tag"><<span class="name">groupId</span>></span>org.example<span class="tag"></<span class="name">groupId</span>></span></span><br><span class="line">        <span class="tag"><<span class="name">version</span>></span>1.0-SNAPSHOT<span class="tag"></<span class="name">version</span>></span></span><br><span class="line">    <span class="tag"></<span class="name">parent</span>></span></span><br><span class="line">    <span class="tag"><<span class="name">modelVersion</span>></span>4.0.0<span class="tag"></<span class="name">modelVersion</span>></span></span><br><span class="line"></span><br><span class="line">    <span class="tag"><<span class="name">artifactId</span>></span>zipkinserver<span class="tag"></<span class="name">artifactId</span>></span></span><br><span class="line"></span><br><span class="line">    <span class="tag"><<span class="name">dependencies</span>></span></span><br><span class="line">          <span class="tag"><<span class="name">dependency</span>></span></span><br><span class="line">            <span class="tag"><<span class="name">groupId</span>></span>org.springframework.boot<span class="tag"></<span class="name">groupId</span>></span></span><br><span class="line">            <span class="tag"><<span class="name">artifactId</span>></span>spring-boot-starter-web<span class="tag"></<span class="name">artifactId</span>></span></span><br><span class="line">            <span class="comment"><!--排除这个slf4j-log4j12造成的冲突--></span></span><br><span class="line">            <span class="tag"><<span class="name">exclusions</span>></span></span><br><span class="line">                <span class="tag"><<span class="name">exclusion</span>></span></span><br><span class="line">                    <span class="tag"><<span class="name">groupId</span>></span>org.slf4j<span class="tag"></<span class="name">groupId</span>></span></span><br><span class="line">                    <span class="tag"><<span class="name">artifactId</span>></span>slf4j-log4j12<span class="tag"></<span class="name">artifactId</span>></span></span><br><span class="line">                <span class="tag"></<span class="name">exclusion</span>></span></span><br><span class="line">            <span class="tag"></<span class="name">exclusions</span>></span></span><br><span class="line">        <span class="tag"></<span class="name">dependency</span>></span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"><!--zipkin依赖--></span></span><br><span class="line">        <span class="tag"><<span class="name">dependency</span>></span></span><br><span class="line">            <span class="tag"><<span class="name">groupId</span>></span>io.zipkin.java<span class="tag"></<span class="name">groupId</span>></span></span><br><span class="line">            <span class="tag"><<span class="name">artifactId</span>></span>zipkin-server<span class="tag"></<span class="name">artifactId</span>></span></span><br><span class="line">            <span class="tag"><<span class="name">version</span>></span>2.9.4<span class="tag"></<span class="name">version</span>></span></span><br><span class="line">        <span class="tag"></<span class="name">dependency</span>></span></span><br><span class="line">        <span class="comment"><!--可视化界面--></span></span><br><span class="line">        <span class="tag"><<span class="name">dependency</span>></span></span><br><span class="line">            <span class="tag"><<span class="name">groupId</span>></span>io.zipkin.java<span class="tag"></<span class="name">groupId</span>></span></span><br><span class="line">            <span class="tag"><<span class="name">artifactId</span>></span>zipkin-autoconfigure-ui<span class="tag"></<span class="name">artifactId</span>></span></span><br><span class="line">            <span class="tag"><<span class="name">version</span>></span>2.9.4<span class="tag"></<span class="name">version</span>></span></span><br><span class="line">        <span class="tag"></<span class="name">dependency</span>></span></span><br><span class="line">    <span class="tag"></<span class="name">dependencies</span>></span></span><br><span class="line"></span><br><span class="line"><span class="tag"></<span class="name">project</span>></span></span><br></pre></td></tr></tbody></table></figure><h4 id="4-创建配置文件"><a href="#4-创建配置文件" class="headerlink" title="4.创建配置文件"></a>4.创建配置文件</h4><figure class="highlight yaml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">9090</span></span><br><span class="line"></span><br><span class="line"><span class="attr">management:</span></span><br><span class="line">  <span class="attr">metrics:</span></span><br><span class="line">    <span class="attr">web:</span></span><br><span class="line">      <span class="attr">server:</span></span><br><span class="line">        <span class="attr">auto-time-requests:</span> <span class="literal">false</span></span><br></pre></td></tr></tbody></table></figure><h4 id="5-创建启动类-2"><a href="#5-创建启动类-2" class="headerlink" title="5.创建启动类"></a>5.创建启动类</h4><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> org.example;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.SpringApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;</span><br><span class="line"><span class="keyword">import</span> zipkin.server.internal.EnableZipkinServer;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@EnableZipkinServer</span>  <span class="comment">//声明启动ZipkinServer</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ZipkinServerApplication</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>{</span><br><span class="line">        SpringApplication.run(ZipkinServerApplication<span class="class">.<span class="keyword">class</span>, <span class="title">args</span>)</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><h4 id="6-创建zipkinclient模块-pom-xml"><a href="#6-创建zipkinclient模块-pom-xml" class="headerlink" title="6.创建zipkinclient模块,pom.xml"></a>6.创建zipkinclient模块,pom.xml</h4><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta"><?xml version="1.0" encoding="UTF-8"?></span></span><br><span class="line"><span class="tag"><<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">"http://maven.apache.org/POM/4.0.0"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span>></span></span><br><span class="line">    <span class="tag"><<span class="name">parent</span>></span></span><br><span class="line">        <span class="tag"><<span class="name">artifactId</span>></span>springcloud<span class="tag"></<span class="name">artifactId</span>></span></span><br><span class="line">        <span class="tag"><<span class="name">groupId</span>></span>org.example<span class="tag"></<span class="name">groupId</span>></span></span><br><span class="line">        <span class="tag"><<span class="name">version</span>></span>1.0-SNAPSHOT<span class="tag"></<span class="name">version</span>></span></span><br><span class="line">    <span class="tag"></<span class="name">parent</span>></span></span><br><span class="line">    <span class="tag"><<span class="name">modelVersion</span>></span>4.0.0<span class="tag"></<span class="name">modelVersion</span>></span></span><br><span class="line"></span><br><span class="line">    <span class="tag"><<span class="name">artifactId</span>></span>zipkinclient<span class="tag"></<span class="name">artifactId</span>></span></span><br><span class="line"></span><br><span class="line">    <span class="tag"><<span class="name">dependencies</span>></span></span><br><span class="line">        <span class="comment"><!--zipkinclient依赖--></span></span><br><span class="line">        <span class="tag"><<span class="name">dependency</span>></span></span><br><span class="line">            <span class="tag"><<span class="name">groupId</span>></span>org.springframework.cloud<span class="tag"></<span class="name">groupId</span>></span></span><br><span class="line">            <span class="tag"><<span class="name">artifactId</span>></span>spring-cloud-starter-zipkin<span class="tag"></<span class="name">artifactId</span>></span></span><br><span class="line">            <span class="tag"><<span class="name">version</span>></span>2.0.2.RELEASE<span class="tag"></<span class="name">version</span>></span></span><br><span class="line">        <span class="tag"></<span class="name">dependency</span>></span></span><br><span class="line">        </span><br><span class="line">        <span class="tag"><<span class="name">dependency</span>></span></span><br><span class="line">            <span class="tag"><<span class="name">groupId</span>></span>org.springframework.cloud<span class="tag"></<span class="name">groupId</span>></span></span><br><span class="line">            <span class="tag"><<span class="name">artifactId</span>></span>spring-cloud-starter-netflix-eureka-client<span class="tag"></<span class="name">artifactId</span>></span></span><br><span class="line">            <span class="tag"><<span class="name">version</span>></span>2.0.2.RELEASE<span class="tag"></<span class="name">version</span>></span></span><br><span class="line">        <span class="tag"></<span class="name">dependency</span>></span></span><br><span class="line"></span><br><span class="line">    <span class="tag"></<span class="name">dependencies</span>></span></span><br><span class="line"></span><br><span class="line"><span class="tag"></<span class="name">project</span>></span></span><br></pre></td></tr></tbody></table></figure><h4 id="7-创建配置文件"><a href="#7-创建配置文件" class="headerlink" title="7.创建配置文件"></a>7.创建配置文件</h4><figure class="highlight yaml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">8090</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">zipkinclient</span></span><br><span class="line">  <span class="attr">sleuth:</span></span><br><span class="line">    <span class="attr">web:</span></span><br><span class="line">      <span class="attr">client:</span></span><br><span class="line">        <span class="attr">enabled:</span> <span class="literal">true</span> <span class="comment">#设置开启请求跟踪</span></span><br><span class="line">    <span class="attr">sampler:</span></span><br><span class="line">      <span class="attr">probability:</span> <span class="number">1.0</span>  <span class="comment">#设置采样比例，默认是1.0</span></span><br><span class="line">  <span class="attr">zipkin:</span></span><br><span class="line">    <span class="attr">base-url:</span> <span class="string">http://localhost:9090/</span>  <span class="comment">#zipkin Server地址</span></span><br><span class="line"><span class="attr">eureka:</span></span><br><span class="line">  <span class="attr">client:</span></span><br><span class="line">    <span class="attr">service-url:</span></span><br><span class="line">      <span class="attr">defaultZone:</span> <span class="string">http://localhost:8761/eureka/</span></span><br></pre></td></tr></tbody></table></figure><h4 id="8-创建启动类"><a href="#8-创建启动类" class="headerlink" title="8.创建启动类"></a>8.创建启动类</h4><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> org.example;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.SpringApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ZipkinApplication</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>{</span><br><span class="line">        SpringApplication.run(ZipkinApplication<span class="class">.<span class="keyword">class</span>, <span class="title">args</span>)</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><h4 id="9-创建Controller层-1"><a href="#9-创建Controller层-1" class="headerlink" title="9.创建Controller层"></a>9.创建Controller层</h4><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> org.example.controller;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Value;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.GetMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/zipkin"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ZipkinController</span> </span>{</span><br><span class="line"><span class="meta">@Value</span>(<span class="string">"${server.port}"</span>)</span><br><span class="line">    <span class="keyword">private</span> String port;</span><br><span class="line"></span><br><span class="line"><span class="meta">@GetMapping</span>(<span class="string">"/index"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">index</span><span class="params">()</span></span>{</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.port;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><h4 id="10-启动：注册中心-gt-zipkinserver模块-gt-zipkinclient模块"><a href="#10-启动：注册中心-gt-zipkinserver模块-gt-zipkinclient模块" class="headerlink" title="10.启动：注册中心->zipkinserver模块->zipkinclient模块"></a>10.启动：注册中心->zipkinserver模块->zipkinclient模块</h4><h4 id="11-浏览器输入：http-localhost-9090-zipkin-（可视化图形界面）"><a href="#11-浏览器输入：http-localhost-9090-zipkin-（可视化图形界面）" class="headerlink" title="11.浏览器输入：http://localhost:9090/zipkin/ （可视化图形界面）"></a>11.浏览器输入：<a href="http://localhost:9090/zipkin/" target="_blank" rel="noopener">http://localhost:9090/zipkin/</a> （可视化图形界面）</h4><p><img src="https://i.loli.net/2020/05/06/w3WyrfZ5CqusHzp.png" alt="1588691911516"></p><p>我们可以新打开一个窗口输入zipkinclient模块的地址进行调用：<a href="http://localhost:8090/zipkin/index，返回图形界面便可以看到跟踪记录。，返回图形界面便可以看到跟踪记录。" target="_blank" rel="noopener">http://localhost:8090/zipkin/index，返回图形界面便可以看到跟踪记录。，返回图形界面便可以看到跟踪记录。</a></p><blockquote><p>声明：此文章是结合B站’楠哥教你学Java’视频自己整理出来的笔记，如有不清楚的可以去看楠哥视频。�</p></blockquote><!-- rebuild by neat --></body></html>]]></content>
      <categories>
        <category>springCloud</category>
      </categories>
      <tags>
        <tag>微服务</tag>
        <tag>springCloud</tag>
        <tag>笔记</tag>
      </tags>
  </entry>
  <entry>
    <title>阿里云Linux高危漏洞修复</title>
    <url>/ali/21/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><!-- build time:Sat May 22 2021 19:59:12 GMT+0800 (GMT+08:00) --><html><head></head><body><img class="st" src="https://i.loli.net/2020/05/21/TiZyhsIBWMjOzwm.jpg"><a id="more"></a> 1. 描述<p>当我们购买阿里云服务器后，有时候会出现高危漏洞的情况，于是便点修复，接着就是让你开通云安全中心，各种购买，像我这种穷屌丝一个能不用钱解决的绝不用钱解决，当然有时候也是需要出一点钱的🤪</p><p><img src="https://i.loli.net/2020/05/18/wAHLRT9PV7UxeSB.png" alt="1589771146265.png"></p><ol start="2"><li><p>登录远程服务器</p><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">#输入以下查看可升级的系统软件</span></span><br><span class="line">[root@dffdfsf ~]<span class="comment"># yum check-update</span></span><br></pre></td></tr></tbody></table></figure><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">#升级软件</span></span><br><span class="line">[root@dffdfsf ~]<span class="comment"># yum upgrade</span></span><br></pre></td></tr></tbody></table></figure><p>接着出现如下（有选择选择y即可）：</p><p><img src="https://i.loli.net/2020/05/18/gcdDuQnNCMIxh4R.png" alt="1589771460156.png"></p></li><li><p>等待升级完成进入阿里云控制台进行验证</p></li></ol><ul><li><p>点击ECS服务器实例</p><p><img src="https://i.loli.net/2020/05/18/ZxF9fsSGlXeoORV.png" alt="1589771865306.png"></p></li><li><p>然后点击实例id</p></li><li><p>查看安全状态</p><p><img src="https://i.loli.net/2020/05/18/q5hTZsY6J1IaMLD.png" alt="1589772038939.png"></p></li><li><p>点击后可以查看到漏洞，我们选择只查看高危漏洞，然后全选，在下方可以看到验证按钮，点击后等待几分钟</p><p><img src="https://i.loli.net/2020/05/18/rSLGY3QWdDcFEul.png" alt="1589772194782.png"></p></li></ul><ol start="4"><li>验证完成后重启云服务器，重启后再查看高危漏洞得以修复</li></ol><!-- rebuild by neat --></body></html>]]></content>
      <categories>
        <category>安全</category>
      </categories>
      <tags>
        <tag>linux</tag>
      </tags>
  </entry>
</search>
